(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const yn=!1,wn=(e,t)=>e===t,ge=Symbol("solid-proxy"),at=Symbol("solid-track"),qe={equals:wn};let Xt=Jt;const de=1,Fe=2,Kt={owned:null,cleanups:null,context:null,owner:null};var z=null;let et=null,$n=null,W=null,G=null,ae=null,Ye=0;function De(e,t){const n=W,r=z,o=e.length===0,s=t===void 0?r:t,l=o?Kt:{owned:null,cleanups:null,context:s?s.context:null,owner:s},i=o?e:()=>e(()=>re(()=>Ie(l)));z=l,W=null;try{return ke(i,!0)}finally{W=n,z=r}}function q(e,t){t=t?Object.assign({},qe,t):qe;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.value)),Gt(n,o));return[Zt.bind(n),r]}function Z(e,t,n){const r=pt(e,t,!1,de);Me(r)}function me(e,t,n){Xt=An;const r=pt(e,t,!1,de);r.user=!0,ae?ae.push(r):Me(r)}function D(e,t,n){n=n?Object.assign({},qe,n):qe;const r=pt(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Me(r),Zt.bind(r)}function Se(e){return ke(e,!1)}function re(e){if(W===null)return e();const t=W;W=null;try{return e()}finally{W=t}}function Ze(e){me(()=>re(e))}function Ge(e){return z===null||(z.cleanups===null?z.cleanups=[e]:z.cleanups.push(e)),e}function ct(){return W}function Je(e,t){const n=Symbol("context");return{id:n,Provider:En(n),defaultValue:e}}function N(e){let t;return z&&z.context&&(t=z.context[e.id])!==void 0?t:e.defaultValue}function Yt(e){const t=D(e),n=D(()=>ut(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function Zt(){if(this.sources&&this.state)if(this.state===de)Me(this);else{const e=G;G=null,ke(()=>je(this),!1),G=e}if(W){const e=this.observers?this.observers.length:0;W.sources?(W.sources.push(this),W.sourceSlots.push(e)):(W.sources=[this],W.sourceSlots=[e]),this.observers?(this.observers.push(W),this.observerSlots.push(W.sources.length-1)):(this.observers=[W],this.observerSlots=[W.sources.length-1])}return this.value}function Gt(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&ke(()=>{for(let o=0;o<e.observers.length;o+=1){const s=e.observers[o],l=et&&et.running;l&&et.disposed.has(s),(l?!s.tState:!s.state)&&(s.pure?G.push(s):ae.push(s),s.observers&&Qt(s)),l||(s.state=de)}if(G.length>1e6)throw G=[],new Error},!1)),t}function Me(e){if(!e.fn)return;Ie(e);const t=Ye;Sn(e,e.value,t)}function Sn(e,t,n){let r;const o=z,s=W;W=z=e;try{r=e.fn(t)}catch(l){return e.pure&&(e.state=de,e.owned&&e.owned.forEach(Ie),e.owned=null),e.updatedAt=n+1,Ct(l)}finally{W=s,z=o}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Gt(e,r):e.value=r,e.updatedAt=n)}function pt(e,t,n,r=de,o){const s={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:z,context:z?z.context:null,pure:n};return z===null||z!==Kt&&(z.owned?z.owned.push(s):z.owned=[s]),s}function He(e){if(e.state===0)return;if(e.state===Fe)return je(e);if(e.suspense&&re(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Ye);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===de)Me(e);else if(e.state===Fe){const r=G;G=null,ke(()=>je(e,t[0]),!1),G=r}}function ke(e,t){if(G)return e();let n=!1;t||(G=[]),ae?n=!0:ae=[],Ye++;try{const r=e();return kn(n),r}catch(r){n||(ae=null),G=null,Ct(r)}}function kn(e){if(G&&(Jt(G),G=null),e)return;const t=ae;ae=null,t.length&&ke(()=>Xt(t),!1)}function Jt(e){for(let t=0;t<e.length;t++)He(e[t])}function An(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:He(r)}for(t=0;t<n;t++)He(e[t])}function je(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const o=r.state;o===de?r!==t&&(!r.updatedAt||r.updatedAt<Ye)&&He(r):o===Fe&&je(r,t)}}}function Qt(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Fe,n.pure?G.push(n):ae.push(n),n.observers&&Qt(n))}}function Ie(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const s=o.pop(),l=n.observerSlots.pop();r<o.length&&(s.sourceSlots[l]=r,o[r]=s,n.observerSlots[r]=l)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)Ie(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Ie(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function xn(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Ct(e,t=z){throw xn(e)}function ut(e){if(typeof e=="function"&&!e.length)return ut(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=ut(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function En(e,t){return function(r){let o;return Z(()=>o=re(()=>(z.context={...z.context,[e]:r.value},Yt(()=>r.children))),void 0),o}}const Ln=Symbol("fallback");function $t(e){for(let t=0;t<e.length;t++)e[t]()}function In(e,t,n={}){let r=[],o=[],s=[],l=0,i=t.length>1?[]:null;return Ge(()=>$t(s)),()=>{let h=e()||[],c=h.length,f,a;return h[at],re(()=>{let v,b,d,u,g,p,E,A,x;if(c===0)l!==0&&($t(s),s=[],r=[],o=[],l=0,i&&(i=[])),n.fallback&&(r=[Ln],o[0]=De(O=>(s[0]=O,n.fallback())),l=1);else if(l===0){for(o=new Array(c),a=0;a<c;a++)r[a]=h[a],o[a]=De(m);l=c}else{for(d=new Array(c),u=new Array(c),i&&(g=new Array(c)),p=0,E=Math.min(l,c);p<E&&r[p]===h[p];p++);for(E=l-1,A=c-1;E>=p&&A>=p&&r[E]===h[A];E--,A--)d[A]=o[E],u[A]=s[E],i&&(g[A]=i[E]);for(v=new Map,b=new Array(A+1),a=A;a>=p;a--)x=h[a],f=v.get(x),b[a]=f===void 0?-1:f,v.set(x,a);for(f=p;f<=E;f++)x=r[f],a=v.get(x),a!==void 0&&a!==-1?(d[a]=o[f],u[a]=s[f],i&&(g[a]=i[f]),a=b[a],v.set(x,a)):s[f]();for(a=p;a<c;a++)a in d?(o[a]=d[a],s[a]=u[a],i&&(i[a]=g[a],i[a](a))):o[a]=De(m);o=o.slice(0,l=c),r=h.slice(0)}return o});function m(v){if(s[a]=v,i){const[b,d]=q(a);return i[a]=d,t(h[a],b)}return t(h[a])}}}function y(e,t){return re(()=>e(t||{}))}const en=e=>`Stale read from <${e}>.`;function te(e){const t="fallback"in e&&{fallback:()=>e.fallback};return D(In(()=>e.each,e.children,t||void 0))}function H(e){const t=e.keyed,n=D(()=>e.when,void 0,void 0),r=t?n:D(n,void 0,{equals:(o,s)=>!o==!s});return D(()=>{const o=r();if(o){const s=e.children;return typeof s=="function"&&s.length>0?re(()=>s(t?o:()=>{if(!re(r))throw en("Show");return n()})):s}return e.fallback},void 0,void 0)}function Pe(e){const t=Yt(()=>e.children),n=D(()=>{const r=t(),o=Array.isArray(r)?r:[r];let s=()=>{};for(let l=0;l<o.length;l++){const i=l,h=o[l],c=s,f=D(()=>c()?void 0:h.when,void 0,void 0),a=h.keyed?f:D(f,void 0,{equals:(m,v)=>!m==!v});s=()=>c()||(a()?[i,f,h]:void 0)}return s});return D(()=>{const r=n()();if(!r)return e.fallback;const[o,s,l]=r,i=l.children;return typeof i=="function"&&i.length>0?re(()=>i(l.keyed?s():()=>{var c;if(((c=re(n)())==null?void 0:c[0])!==o)throw en("Match");return s()})):i},void 0,void 0)}function K(e){return e}const Tn=void 0,ie=e=>D(()=>e());function Rn(e,t,n){let r=n.length,o=t.length,s=r,l=0,i=0,h=t[o-1].nextSibling,c=null;for(;l<o||i<s;){if(t[l]===n[i]){l++,i++;continue}for(;t[o-1]===n[s-1];)o--,s--;if(o===l){const f=s<r?i?n[i-1].nextSibling:n[s-i]:h;for(;i<s;)e.insertBefore(n[i++],f)}else if(s===i)for(;l<o;)(!c||!c.has(t[l]))&&t[l].remove(),l++;else if(t[l]===n[s-1]&&n[i]===t[o-1]){const f=t[--o].nextSibling;e.insertBefore(n[i++],t[l++].nextSibling),e.insertBefore(n[--s],f),t[o]=n[s]}else{if(!c){c=new Map;let a=i;for(;a<s;)c.set(n[a],a++)}const f=c.get(t[l]);if(f!=null)if(i<f&&f<s){let a=l,m=1,v;for(;++a<o&&a<s&&!((v=c.get(t[a]))==null||v!==f+m);)m++;if(m>f-i){const b=t[l];for(;i<f;)e.insertBefore(n[i++],b)}else e.replaceChild(n[i++],t[l++])}else l++;else t[l++].remove()}}}const St="_$DX_DELEGATE";function Mn(e,t,n,r={}){let o;return De(s=>{o=s,t===document?e():w(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{o(),t.textContent=""}}function L(e,t,n,r){let o;const s=()=>{const i=document.createElement("template");return i.innerHTML=e,i.content.firstChild},l=()=>(o||(o=s())).cloneNode(!0);return l.cloneNode=l,l}function ce(e,t=window.document){const n=t[St]||(t[St]=new Set);for(let r=0,o=e.length;r<o;r++){const s=e[r];n.has(s)||(n.add(s),t.addEventListener(s,Dn))}}function Pn(e,t){t==null?e.removeAttribute("class"):e.className=t}function Qe(e,t,n,r){Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n}function tn(e,t,n={}){const r=Object.keys(t||{}),o=Object.keys(n);let s,l;for(s=0,l=o.length;s<l;s++){const i=o[s];!i||i==="undefined"||t[i]||(kt(e,i,!1),delete n[i])}for(s=0,l=r.length;s<l;s++){const i=r[s],h=!!t[i];!i||i==="undefined"||n[i]===h||!h||(kt(e,i,!0),n[i]=h)}return n}function On(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function Bn(e,t,n){return re(()=>e(t,n))}function w(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return ze(e,t,r,n);Z(o=>ze(e,t(),o,n),r)}function kt(e,t,n){const r=t.trim().split(/\s+/);for(let o=0,s=r.length;o<s;o++)e.classList.toggle(r[o],n)}function Dn(e){let t=e.target;const n=`$$${e.type}`,r=e.target,o=e.currentTarget,s=h=>Object.defineProperty(e,"target",{configurable:!0,value:h}),l=()=>{const h=t[n];if(h&&!t.disabled){const c=t[`${n}Data`];if(c!==void 0?h.call(t,c,e):h.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&s(t.host),!0},i=()=>{for(;l()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const h=e.composedPath();s(h[0]);for(let c=0;c<h.length-2&&(t=h[c],!!l());c++){if(t._$host){t=t._$host,i();break}if(t.parentNode===o)break}}else i();s(r)}function ze(e,t,n,r,o){for(;typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,l=r!==void 0;if(e=l&&n[0]&&n[0].parentNode||e,s==="string"||s==="number"){if(s==="number"&&(t=t.toString(),t===n))return n;if(l){let i=n[0];i&&i.nodeType===3?i.data!==t&&(i.data=t):i=document.createTextNode(t),n=pe(e,n,r,i)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||s==="boolean")n=pe(e,n,r);else{if(s==="function")return Z(()=>{let i=t();for(;typeof i=="function";)i=i();n=ze(e,i,n,r)}),()=>n;if(Array.isArray(t)){const i=[],h=n&&Array.isArray(n);if(ft(i,t,n,o))return Z(()=>n=ze(e,i,n,r,!0)),()=>n;if(i.length===0){if(n=pe(e,n,r),l)return n}else h?n.length===0?At(e,i,r):Rn(e,n,i):(n&&pe(e),At(e,i));n=i}else if(t.nodeType){if(Array.isArray(n)){if(l)return n=pe(e,n,r,t);pe(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function ft(e,t,n,r){let o=!1;for(let s=0,l=t.length;s<l;s++){let i=t[s],h=n&&n[e.length],c;if(!(i==null||i===!0||i===!1))if((c=typeof i)=="object"&&i.nodeType)e.push(i);else if(Array.isArray(i))o=ft(e,i,h)||o;else if(c==="function")if(r){for(;typeof i=="function";)i=i();o=ft(e,Array.isArray(i)?i:[i],Array.isArray(h)?h:[h])||o}else e.push(i),o=!0;else{const f=String(i);h&&h.nodeType===3&&h.data===f?e.push(h):e.push(document.createTextNode(f))}}return o}function At(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function pe(e,t,n,r){if(n===void 0)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let s=!1;for(let l=t.length-1;l>=0;l--){const i=t[l];if(o!==i){const h=i.parentNode===e;!s&&!l?h?e.replaceChild(o,i):e.insertBefore(o,n):h&&i.remove()}else s=!0}}else e.insertBefore(o,n);return[o]}const dt=Symbol("store-raw"),$e=Symbol("store-node"),le=Symbol("store-has"),nn=Symbol("store-self");function rn(e){let t=e[ge];if(!t&&(Object.defineProperty(e,ge,{value:t=new Proxy(e,qn)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let o=0,s=n.length;o<s;o++){const l=n[o];r[l].get&&Object.defineProperty(e,l,{enumerable:r[l].enumerable,get:r[l].get.bind(t)})}}return t}function Ve(e){let t;return e!=null&&typeof e=="object"&&(e[ge]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ve(e,t=new Set){let n,r,o,s;if(n=e!=null&&e[dt])return n;if(!Ve(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let l=0,i=e.length;l<i;l++)o=e[l],(r=ve(o,t))!==o&&(e[l]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const l=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let h=0,c=l.length;h<c;h++)s=l[h],!i[s].get&&(o=e[s],(r=ve(o,t))!==o&&(e[s]=r))}return e}function We(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function Te(e,t,n){if(e[t])return e[t];const[r,o]=q(n,{equals:!1,internal:!0});return r.$=o,e[t]=r}function Un(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===ge||t===$e||(delete n.value,delete n.writable,n.get=()=>e[ge][t]),n}function on(e){ct()&&Te(We(e,$e),nn)()}function Nn(e){return on(e),Reflect.ownKeys(e)}const qn={get(e,t,n){if(t===dt)return e;if(t===ge)return n;if(t===at)return on(e),n;const r=We(e,$e),o=r[t];let s=o?o():e[t];if(t===$e||t===le||t==="__proto__")return s;if(!o){const l=Object.getOwnPropertyDescriptor(e,t);ct()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(l&&l.get)&&(s=Te(r,t,s)())}return Ve(s)?rn(s):s},has(e,t){return t===dt||t===ge||t===at||t===$e||t===le||t==="__proto__"?!0:(ct()&&Te(We(e,le),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Nn,getOwnPropertyDescriptor:Un};function Xe(e,t,n,r=!1){if(!r&&e[t]===n)return;const o=e[t],s=e.length;n===void 0?(delete e[t],e[le]&&e[le][t]&&o!==void 0&&e[le][t].$()):(e[t]=n,e[le]&&e[le][t]&&o===void 0&&e[le][t].$());let l=We(e,$e),i;if((i=Te(l,t,o))&&i.$(()=>n),Array.isArray(e)&&e.length!==s){for(let h=e.length;h<s;h++)(i=l[h])&&i.$();(i=Te(l,"length",s))&&i.$(e.length)}(i=l[nn])&&i.$()}function sn(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];Xe(e,o,t[o])}}function Fn(e,t){if(typeof t=="function"&&(t=t(e)),t=ve(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const o=t[n];e[n]!==o&&Xe(e,n,o)}Xe(e,"length",r)}else sn(e,t)}function Le(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const l=typeof r,i=Array.isArray(e);if(Array.isArray(r)){for(let h=0;h<r.length;h++)Le(e,[r[h]].concat(t),n);return}else if(i&&l==="function"){for(let h=0;h<e.length;h++)r(e[h],h)&&Le(e,[h].concat(t),n);return}else if(i&&l==="object"){const{from:h=0,to:c=e.length-1,by:f=1}=r;for(let a=h;a<=c;a+=f)Le(e,[a].concat(t),n);return}else if(t.length>1){Le(e[r],t,[r].concat(n));return}o=e[r],n=[r].concat(n)}let s=t[0];typeof s=="function"&&(s=s(o,n),s===o)||r===void 0&&s==null||(s=ve(s),r===void 0||Ve(o)&&Ve(s)&&!Array.isArray(s)?sn(o,s):Xe(e,r,s))}function ht(...[e,t]){const n=ve(e||{}),r=Array.isArray(n),o=rn(n);function s(...l){Se(()=>{r&&l.length===1?Fn(n,l[0]):Le(n,l)})}return[o,s]}const Hn=80,jn=30,ln=1.7,an=20,ye=50,Ue=100,cn=500,xt=720*60*1e3,Et=3600*24*10/85,ne="story_town_1",un=new Array(495).fill(1).map((e,t)=>Math.floor(Hn*Math.pow(t+1,ln))),be=new Array(500).fill(1).map((e,t)=>Math.floor(jn*Math.pow(t+1,ln))),bt=(e,t=un)=>{if(!e)return 0;const n=t.findIndex(s=>s>e);if(n<0&&e>0)return 1;const r=e-(t[n-1]??0),o=t[n]-(t[n-1]??0);return r/o},fe=(e,t=un)=>{const n=t.findIndex(r=>r>e);return n<0&&e>0?t.length:n},zn=[{name:"hay_hand_1",label:"Hay hand wraps",equipSlot:"hand",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[{name:"hay_1",count:25}],stats:{attMin:1,attMax:3}},{name:"hay_head_1",label:"Hay bandana",equipSlot:"head",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[{name:"hay_1",count:25}],stats:{maxHealth:5}},{name:"hay_chest_1",label:"Hay vest",equipSlot:"chest",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[{name:"hay_1",count:50}],stats:{physRes:1}},{name:"utility_axe_1",label:"Rusty axe",equipSlot:"weapon",utilityType:"axe",stats:{}}],Vn=[{name:"recipe_hay_hand_1",label:"Recipe: Hay hand wraps",craftableItem:"hay_hand_1"},{name:"recipe_bench_basic_1",label:"Recipe: Basic crafting table",craftableFurniture:"furniture_bench_basic_1"},{name:"recipe_hay_head_1",label:"Recipe: Hay bandana",craftableItem:"hay_head_1"},{name:"recipe_hay_chest_1",label:"Recipe: Hay vest",craftableItem:"hay_chest_1"},{name:"recipe_worm_kabab_1",label:"Recipe: Worm kabab",craftableItem:"food_worm_kabab_1"},{name:"recipe_camp_fire_1",label:"Recipe: Camp fire",craftableFurniture:"furniture_cook_basic_1"}].map(e=>({...e,useVerb:"Read",category:"book",exclusive:!0,use:(t,n,r,o)=>(o==null||o.onTask({noRepeat:!0,label:"Learning",description:e.label,duration:100,onComplete:()=>{var s;return(s=r==null?void 0:r.recipes())!=null&&s.find(l=>l.craftableItem===e.craftableItem)||(r==null||r.onAddRecipe(e.name),t==null||t.setState("prohibitedItems",[...(t==null?void 0:t.state.prohibitedItems)??[],e.name])),n==null||n.removeInventory(e.name,1),t==null||t.onNavigate("_back"),!0}}),!1)})),Wn=[{name:"hay_1",label:"Hay",category:"resource",maxStack:100},{name:"wood_log_1",label:"Wooden log",category:"resource",maxStack:100}],Xn=[{name:"wood_club_1",label:"Wooden Club",equipSlot:"weapon",craftType:"weapon",craftComplexity:1,craftLevel:1,ingredients:[{name:"wood_log_1",count:15}],masteryType:"mace",stats:{attMin:2,attMax:5,attSpeed:-.1}},{name:"wood_shield_1",label:"Wooden Shield",equipSlot:"offhand",craftType:"armour",craftComplexity:1,craftLevel:1,ingredients:[{name:"wood_log_1",count:20}],stats:{physRes:2,maxHealth:10}},{name:"wood_chest_1",label:"Wooden Plank Vest",equipSlot:"chest",craftType:"armour",craftComplexity:2,craftLevel:1,ingredients:[{name:"wood_log_1",count:40}],stats:{physRes:3,agility:-1}},{name:"stone_axe_1",label:"Stone Axe",equipSlot:"weapon",craftType:"weapon",craftComplexity:2,craftLevel:2,ingredients:[{name:"wood_log_1",count:10},{name:"stone_1",count:10}],masteryType:"axe",stats:{attMin:3,attMax:8,attSpeed:-.05,strength:1}},{name:"stone_helm_1",label:"Stone Helm",equipSlot:"head",craftType:"armour",craftComplexity:2,craftLevel:2,ingredients:[{name:"stone_1",count:20},{name:"hay_1",count:10}],stats:{physRes:4,maxHealth:10,intelligence:-1}},{name:"copper_sword_1",label:"Copper Shortsword",equipSlot:"weapon",craftType:"weapon",craftComplexity:3,craftLevel:2,ingredients:[{name:"copper_ingot_1",count:8},{name:"wood_log_1",count:5}],masteryType:"sword",stats:{attMin:4,attMax:10,attSpeed:.1,dexterity:1}},{name:"copper_chest_1",label:"Copper Breastplate",equipSlot:"chest",craftType:"armour",craftComplexity:3,craftLevel:2,ingredients:[{name:"copper_ingot_1",count:15}],stats:{physRes:5,magRes:1,strength:1}},{name:"iron_spear_1",label:"Iron Spear",equipSlot:"weapon",craftType:"weapon",craftComplexity:4,craftLevel:3,ingredients:[{name:"iron_ingot_1",count:12},{name:"wood_log_1",count:8}],masteryType:"spear",stats:{attMin:6,attMax:14,attSpeed:0,dexterity:2}},{name:"iron_helm_1",label:"Iron Helmet",equipSlot:"head",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[{name:"iron_ingot_1",count:8}],stats:{physRes:6,maxHealth:15,charisma:-1}},{name:"iron_boots_1",label:"Iron Greaves",equipSlot:"foot",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[{name:"iron_ingot_1",count:6}],stats:{physRes:3,agility:-1}}],Kn=[{name:"food_acorn_1",label:"Raw acorn (+2hp)",useVerb:"Eat",maxStack:10,hp:2},{name:"food_worm_1",label:"Raw worm (+1hp)",useVerb:"Eat",maxStack:10,hp:1},{name:"food_worm_kabab_1",label:"Worm... kabab (+4hp)",useVerb:"Eat",maxStack:10,craftType:"food",hp:4,craftComplexity:1,ingredients:[{name:"food_worm_1",count:10}]}].map(e=>({...e,category:"food",use:(t,n,r)=>{const o=r.player.stats.health,s=r.player.stats.maxHealth??10,l=Math.min(e.hp,s-o);return o<s?(r.onAddStat("health",l),n.removeInventory(e.name,1),!0):!1}})),Yn=[{name:"demonic_essense_1",label:"Demonic Essense",category:"unique"}],X=[zn,Vn,Wn,Xn,Kn,Yn].flat().reduce((e,t)=>(e[t.name]=t,e),{}),Zn=[{name:"unarmed",label:"Unarmed",bonus:new Array(cn+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{attMin:t%10===0?1:0,attMax:1,attSpeed:t%50===0?.1:0}}}).filter(Boolean)}],Gn=[{name:"woodcutting",label:"Woodcutting",bonus:new Array(cn+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{durationModifier:t%10===0?10:0},dropModifiers:[{name:"wood_log_1",chance:t%50===0?1:0}]}}).filter(Boolean)}],we=[Zn,Gn].flat().reduce((e,t)=>(e[t.name]=t,e),{}),fn=(e,t)=>{const n=we[e];if(!n)return{};const r=fe(t,be),o=n.bonus.filter(s=>s.level<=r);return(o==null?void 0:o.reduce((s,l)=>(Object.entries(l.stats).forEach(([i,h])=>{s[i]=(s[i]??0)+h}),s),{}))??{}},Jn=(e,t,n)=>{const r=we[t];if(!r)return 0;const o=fe(n,be),s=r.bonus.filter(l=>l.level<=o);return s==null?void 0:s.reduce((l,i)=>{var h,c;return l+(((c=(h=i.dropModifiers)==null?void 0:h.find(f=>f.name===e))==null?void 0:c.chance)??0)},0)};var Qn=L('<div class="font-bold m-2">'),Cn=L("<div>");const Ke=e=>(()=>{var t=Qn();return w(t,y(te,{get each(){return e.lines},children:(n,r)=>(()=>{var o=Cn();return w(o,y(H,{get when(){return r()===0},children:'" .. '}),null),w(o,n,null),w(o,y(H,{get when(){return r()===e.lines.length-1},children:' .. "'}),null),o})()})),t})();var er=L("<span class=text-red-500>Fight scarecrows"),tr=L('<span class="font-bold ml-1">'),nr=L('<span class="font-bold text-blue-500 mr-1">Hay'),rr=L("<span class=font-bold>"),or=L('<span class="font-bold m-1">, ');const sr=[{name:"story_town_1",label:"Town",description:"You are in town",type:"dialogue",options:[{label:"Visit Farm",goto:"story_farmer_1"},{label:"Leave the town",goto:"story_forest_1"},{label:"Merchants",goto:"story_town_merchants_1"},{label:"Home",goto:"story_home_1"}]},{name:"story_farmer_1",label:"Farm",description:"A vacant expressionless farmer. Hasn't washed in days.",type:"dialogue",options:[{label:"Approach the farmer",goto:"story_farmer_2"},{label:er(),goto:"story_scarecrows_1"},{label:"Sell Hay",action:(e,t,n)=>{if(!t)return;const o=t.inventory().filter(s=>(s==null?void 0:s.name)==="hay_1").reduce((s,l)=>s+((l==null?void 0:l.count)??0),0);o&&(t.removeInventory("hay_1",o),n==null||n.onAddStat("gold",o),e==null||e.onLog(["You sell",(()=>{var s=tr();return w(s,o),s})()," ",nr(),"For ",(()=>{var s=rr();return w(s,o),s})()," gold"],"meta"))}}]},{name:"story_farmer_2",label:"Farmer",description:["You approach, he holds your wrist loosely like an exhausted child.",y(Ke,{lines:["Loathsome shadowed cloaks","Golden light shimmering, blind eyes","Fear, is Death knocking?"]}),"He sits and cries."],type:"dialogue",options:[{label:"Console",goto:"story_farmer_3"},{label:"Leave",goto:"_back"}]},{name:"story_farmer_3",label:"Farmer",description:y(Ke,{lines:["Am *I* the keeper of the wheat?","... or is it the keeper of me?"]}),type:"dialogue",options:(e,t)=>{const r=!e.state.markers.includes("story_farmer_gift_1"),o=t.inventory().reduce((l,i)=>(i==null?void 0:i.name)==="hay_1"?l+(i==null?void 0:i.count):l,0)<200;return[...r?[{label:"A gift... (200 Hay)",action:()=>{const[l,i]=["recipe_worm_kabab_1","recipe_camp_fire_1"].map(h=>X[h]);t.removeInventory("hay_1",200)===200&&(t.addInventory("recipe_worm_kabab_1",1),t.addInventory("recipe_camp_fire_1"),e.setState("markers",[...e.state.markers,"story_farmer_gift_1"]),e.onLog(["The farmer reciprocates:",(()=>{var h=or(),c=h.firstChild;return w(h,l==null?void 0:l.label,c),w(h,i==null?void 0:i.label,null),h})()],"drop"))},isDisabled:o}]:[],{label:"Silently leave",goto:"_back.2"}]}},{name:"story_scarecrows_1",label:"Scarecrows",description:"Fighting scarecrows",type:"encounter",cooldown:20,encounters:[{name:"enc_scarecrow_1",label:"Scarecrow",health:10,chance:1,experience:10,drops:[{name:"hay_1",chance:.5},{name:"food_worm_1",chance:1},{name:"recipe_hay_hand_1",chance:.05},{name:"recipe_hay_head_1",chance:.05},{name:"recipe_hay_chest_1",chance:.05}]}]}],lr=[{name:"furniture_bench_basic_1",label:"Basic bench",type:"craft",craftingComplexity:1,cratingType:"basic",ingredients:[{name:"wood_log_1",count:50}]},{name:"furniture_stash_1",label:"Basic stash",type:"stash",storageSize:5,ingredients:[{name:"wood_log_1",count:20},{name:"hay_1",count:50}]},{name:"furniture_cook_basic_1",label:"Camp fire",type:"craft",cratingType:"food",craftingComplexity:1,ingredients:[{name:"wood_log_1",count:50},{name:"hay_1",count:50}]}],gt=[lr].flat().reduce((e,t)=>(e[t.name]=t,e),{});var ir=L("<div class=font-bold>Stash"),ar=L("<div>Retrieve items from stash here, place in stash from your invent");const cr=[{name:"story_home_1",label:"Home",description:"Home sweet home",type:"dialogue",options:[{label:"Build",goto:"story_home_2"},{label:"Stash",goto:"story_stash_1"},{label:"Craft",goto:"story_home_4"}]},{name:"story_stash_1",label:"Stash",type:"dialogue",description:[ir(),ar()]},{name:"story_home_2",label:"Building",description:"Build new appliances",type:"dialogue",options:(e,t,n,r)=>{var s;return!n||!t?[]:((s=n==null?void 0:n.recipes())==null?void 0:s.filter(l=>!!l.craftableFurniture).map(l=>gt[l.craftableFurniture])).map(l=>{var i;return{label:l.label,action:()=>{r==null||r.onTask({noRepeat:!0,label:"Building",description:l.label,duration:100,onComplete:()=>ur(e,t,l)})},isDisabled:!tt(t,l),subtext:(i=l.ingredients)==null?void 0:i.map(h=>`${X[h.name].label} (${h.count})`).join(" - ")}})??[]}},{name:"story_home_4",label:"Crafting",description:"A workshop",type:"dialogue",options:e=>{var t;return((t=e==null?void 0:e.state.furniture)==null?void 0:t.map(n=>gt[n]).filter(n=>n.type==="craft").map(n=>({label:n.label,goto:`story_craft_${n.cratingType}_1`})))??[]}},{name:"story_craft_basic_1",label:"Basic crafting",description:"A very simple crafting table",type:"dialogue",options:(e,t,n,r)=>{var s;return!n||!t?[]:((s=n==null?void 0:n.recipes())==null?void 0:s.filter(l=>!!l.craftableItem).map(l=>X[l.craftableItem]).filter(l=>l.craftType==="basic"&&l.craftComplexity===1)).map(l=>{var i;return{label:l.label,action:()=>{r==null||r.onTask({noRepeat:!0,label:"Crafting",description:l.label,duration:100,onComplete:()=>Lt(t,l)})},isDisabled:!tt(t,l),subtext:(i=l.ingredients)==null?void 0:i.map(h=>`${X[h==null?void 0:h.name].label} (${h==null?void 0:h.count})`).join(" - ")}})??[]}},{name:"story_craft_food_1",label:"Baic cooking",description:"A very simple cooking station",type:"dialogue",options:(e,t,n,r)=>{var s;return!n||!t?[]:((s=n==null?void 0:n.recipes())==null?void 0:s.filter(l=>!!l.craftableItem).map(l=>X[l.craftableItem]).filter(l=>l.craftType==="food"&&l.craftComplexity===1)).map(l=>{var i;return{label:l.label,action:()=>{r==null||r.onTask({noRepeat:!0,label:"Cooking",description:l.label,duration:100,onComplete:()=>Lt(t,l)})},isDisabled:!tt(t,l),subtext:(i=l.ingredients)==null?void 0:i.map(h=>`${X[h==null?void 0:h.name].label} (${h==null?void 0:h.count})`).join(" - ")}})??[]}}],Lt=(e,t)=>{var n;e.addInventory(t.name,1),(n=t.ingredients)==null||n.forEach(r=>e.removeInventory(r.name,r.count))},ur=(e,t,n)=>{var r;e.setState("furniture",[...e.state.furniture,n.name]),(r=n.ingredients)==null||r.forEach(o=>t.removeInventory(o.name,o.count))},tt=(e,t)=>{var n;return(n=t.ingredients)!=null&&n.length?t.ingredients.every(r=>((e==null?void 0:e.inventory().reduce((s,l)=>((l==null?void 0:l.name)===r.name&&(s=s+(l.count??1)),s),0))??0)>=r.count):!0};var fr=L("<span class=text-red-500>Venture deeper");const It=[{name:"enc_rabbit_1",label:"Little rabbit",chance:.4,experience:20,drops:[],health:5,stats:{attMin:0,attMax:1,attSpeed:10}},{name:"enc_deer_1",label:"Frightened deer",chance:.2,experience:40,drops:[],health:10,stats:{attMin:0,attMax:4,attSpeed:45}},{name:"enc_dead_tree_1",label:"Dead tree",chance:1,experience:10,health:10,drops:[{name:"food_acorn_1",chance:.5}]},{name:"enc_demonic_tree_1",label:"Demonic tree",chance:.001,experience:2e3,health:400,drops:[{name:"demonic_essense_1",chance:1}]}],dr=[{type:"dialogue",name:"story_forest_1",label:"Forest border",description:"The canopy casts a shadow. Sounds, eyes ... movement",options:(e,t,n)=>[{label:"Chop wood",goto:"task_chop_wood_1",isDisabled:!!!(n!=null&&n.equipment().find(o=>o.equipSlot==="weapon"&&o.utilityType==="axe"))},{label:fr(),goto:"story_forest_2"}]},{type:"task",name:"task_chop_wood_1",label:"Surrounded by trees",description:"Chopping wood",duration:100,masteryType:"woodcutting",cooldown:10,experience:1,utilityType:"axe",items:[{name:"wood_log_1",chance:1},{name:"food_acorn_1",chance:3}]},{name:"story_forest_2",label:"Deep forest",description:"Creatures block your path...",type:"encounter",limit:5,onComplete:e=>{e==null||e.onNavigate("story_forest_3")},cooldown:20,encounters:It},{name:"story_forest_4",label:"Deep forest hunt",description:"You aren't scared of a few forest creatures",type:"encounter",onComplete:e=>{e==null||e.onNavigate("story_forest_3")},cooldown:20,encounters:It},{name:"story_forest_3",label:"welcome to the deep forest",type:"dialogue",description:"You made it!"}],Tt=e=>(t,n,r)=>{const o=r==null?void 0:r.player.stats.gold;return e.map(s=>{const l=X[s.name];return{label:`${(l==null?void 0:l.label)??"UNKNOWN"} - ${s.cost}g`,action:()=>{n==null||n.addInventory(l.name,1),r==null||r.onAddStat("gold",0-s.cost),t==null||t.onLog(`You purchase the ${l.label} for ${s.cost}g`,"meta")},isDisabled:s.cost>(o??0)}})},hr=[{type:"dialogue",name:"story_town_merchants_1",label:"Town Bazaar",description:"Souks, stalls, spices, hands... hands... hands...",options:[{label:"Tool merchant",goto:"story_town_merchant_tool_1"},{label:"Building merchant",goto:"story_town_merchant_building_1"}]},{type:"dialogue",name:"story_town_merchant_tool_1",label:"Tool Merchant",description:["A burly man, skin of leather ",y(Ke,{lines:["The very finest tools"]})],options:Tt([{name:"utility_axe_1",cost:50}])},{type:"dialogue",name:"story_town_merchant_building_1",label:"Building Merchant",description:["Beard down to his bare nipples ",y(Ke,{lines:["DIY... home improvements","Sweat...","Muscles..."]})],options:Tt([{name:"recipe_bench_basic_1",cost:100}])}],mt=[sr,cr,dr,hr].flat().reduce((e,t)=>(e[t.name]=t,e),{}),Rt=(e,t)=>(typeof t=="object"&&(t=JSON.stringify(t)),window.localStorage.setItem(e,`${t}`)),nt=e=>{const t=window.localStorage.getItem(e);if(!t)return t??void 0;try{return JSON.parse(t)}catch{return t}},he=Je(),br=e=>{const t=(f,a=1)=>{const[m,v]=i(e.state.inventory,f,a);return v>0&&e.setState("inventory",m),v},n=D(()=>e.state.inventory),r=D(()=>e.state.stash);me(f=>{const a=e.state.furniture.map(v=>gt[v]).filter(v=>v.type==="stash").reduce((v,b)=>v+(b.storageSize??0),0);if(a===f)return a;const m=e.state.stash.filter(Boolean);if(a<m.length)throw new Error("Invalid stash, size too small for contents");return e.setState("stash",[...m,...new Array(a-m.length).fill(null)]),a},0);const o=(f,a=1)=>{const[m,v]=h(e.state.inventory,f,a);return v>0&&e.setState("inventory",m),v},s=(f,a=1)=>{const[m,v]=i(e.state.stash,f,a),[b,d]=h(e.state.inventory,f,a);return d!==v?(console.error(`Unable to move ${f} from invent to stash`),0):(v>0&&Se(()=>{e.setState("inventory",b),e.setState("stash",m)}),v)},l=(f,a=1)=>{const[m,v]=h(e.state.stash,f,a),[b,d]=i(e.state.inventory,f,a);return v!==d?(console.error(`Unable to move ${f} from stash to invent`),0):(v>0&&Se(()=>{e.setState("inventory",b),e.setState("stash",m)}),v)},i=(f,a,m)=>{if(!X[a])return console.warn("Invalid or not found item",a),[f,0];const v=X[a];if(!m)return[f,0];if(m===1/0)return console.error("Cannot add infinite items to invent"),[f,0];let b=[...f];if(v.exclusive&&b.find(u=>(u==null?void 0:u.name)===v.name))return[b,0];let d=m;return v.maxStack&&(b=b.map(u=>{if(!(u!=null&&u.name)||!d)return u;if(u.name===v.name&&u.count<v.maxStack){let g=Math.min(u.count+d,v.maxStack);return d-=g-u.count,{...u,count:g}}return u})),d&&(b=b.map(u=>{if(!d)return u;if(u===null){const g=Math.min(d,v.maxStack??1);return d-=g,{name:v.name,count:g}}return u})),[b,m-d]},h=(f,a,m=1)=>{if(m===1/0&&(m=f.reduce((g,p)=>(p==null?void 0:p.name)===a?g+p.count:g,0)),!m)return[f,0];if(!X[a])return console.warn("Invalid or not found name",a),[f,0];const v=X[a];if(f.findLastIndex(g=>(g==null?void 0:g.name)===v.name)<0)return[f,0];let d=m;const u=[...f.toReversed().map(g=>{if(!d||(g==null?void 0:g.name)!==v.name)return g;if(g.count<=d)return d-=g.count,null;const p=g.count-d;return d=0,{...g,count:p}}).reverse()].filter(Boolean);return u.push(...new Array(an-u.length).fill(null)),[u,m-d]},c={inventory:n,stash:r,addInventory:t,removeInventory:o,addStash:s,removeStash:l};return y(he.Provider,{value:c,get children(){return e.children}})},Mt={stats:{health:10,maxHealth:10,gold:0,experience:0},equipment:[],mastery:{},recipes:[]},Pt={prohibitedItems:[],stash:new Array(2).fill(null),furniture:[],inventory:new Array(an).fill(null),blockedEncounters:[],markers:[]},Q=Je(),Be="freeze_time",Ot="state",gr=e=>{const[t,n]=q([]),[r,o]=q(ne),[s,l]=ht(Mt),[i,h]=ht(Pt),[c,f]=q([ne]),[a,m]=q(0),[v,b]=q(!0),[d,u]=q(Et),[g,p]=q(15),[E,A]=q([]);Ze(()=>{setInterval(()=>{v()||x()},Ue)});const x=()=>{E().length&&(m(a()+1),a()>d()&&(u(d()+Et),p(g()+1)),E().forEach(([R,B])=>B()))};setInterval(()=>{S()},1e4);const O=(R,B)=>{E().find(([F])=>F===R)||A([...E(),[R,B]])},M=R=>{A([...E().filter(([B])=>B!==R)])};document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="hidden")S(),Rt(Be,Date.now());else{const R=nt(Be);if(R){const B=Math.min(Date.now()-R,xt);let F=Math.floor(B/Ue);I(F)}else b(!1)}});const _=()=>{const R=nt(Ot);R&&(R.state.blockedEncounters=R.state.blockedEncounters??[],R.state.markers=R.state.markers??[],Se(()=>{o(R.story),l(R.player),h(R.state),f(R.nav),m(R.ticks)}));const B=nt(Be);if(B){const F=Math.min(Date.now()-B,xt);let j=Math.floor(F/Ue);I(j)}else b(!1)},$=()=>{Se(()=>{l(Mt),h(Pt),m(0),T(ne)}),S()};window.cs=$;const S=()=>{console.log("Saving...");const R={player:ve(s),state:ve(i),ticks:a(),story:r(),nav:c()};Rt(Ot,R)},I=R=>{R>0?requestIdleCallback(()=>{let B=1e3;for(;R>0&&B>0;)x(),R--,B--;I(R)}):b(!1)};window.addEventListener("load",_),window.addEventListener("beforeunload",()=>{S(),window.localStorage.setItem(Be,`${Date.now()}`)});const T=R=>{if(R==="_start"&&(R=ne),R===ne){f([ne]),o(ne);return}const B=/^_back/.test(R);if(!B&&!mt[R]){console.error(`Unknown story ${R}`);return}if(B){const[F,j]=R.split("."),J=Math.min(parseInt(j??"1"),c().length+1);R=c().at(-1-J)??ne,c().length>1&&f(c().slice(0,-J))}else c().at(-1)!==R&&f([...c(),R]);o(R)},V={state:i,setState:h,year:g,startActivity:O,endActivity:M,onNavigate:T,nav:c,onLog:(R,B="basic")=>{var J;const F=new Date,j={msg:R,time:[F.getHours(),F.getMinutes(),F.getSeconds()].join(":"),type:B};n([...t().slice(Math.min(((J=t())==null?void 0:J.length)-999,0)),j])},log:t,pause:v,setNav:f,onClearState:$};return y(Q.Provider,{value:V,get children(){return y(br,{state:i,setState:h,get children(){return y(mr,{player:s,setPlayer:l,get children(){return y(vr,{story:r,setStory:o,get children(){return e.children}})}})}})}})},ue=Je(),mr=e=>{const t=N(Q),n=D(()=>{var b;return((b=e.player.recipes)==null?void 0:b.map(d=>X[d]))??[]}),r=b=>{e.setPlayer("recipes",[...e.player.recipes??[],b].filter((d,u,g)=>g.indexOf(d)===u))},o=D(()=>{var b;return((b=e.player.equipment)==null?void 0:b.map(d=>X[d]))??[]}),s=D(()=>{var b;return((b=o().find(d=>d.equipSlot==="weapon"))==null?void 0:b.masteryType)??"unarmed"}),l=b=>{var d;return fn(b,((d=e.player.mastery)==null?void 0:d[b])??0)},i=D(()=>{var O;const b=o();let d=b.reduce((M,_)=>{var $;return M+((($=_.stats)==null?void 0:$.attMin)??0)},1),u=b.reduce((M,_)=>{var $;return M+((($=_.stats)==null?void 0:$.attMax)??0)},1);const g=s(),p=l(g);d+=(p==null?void 0:p.attMin)??0,u+=(p==null?void 0:p.attMax)??0;const E=1+Math.pow((((O=e.player.stats)==null?void 0:O.strength)??0)/100,.7),A=Math.round(d*E),x=Math.round(u*E);return[A,x]}),h=D(()=>{var R;const b=o(),d=100,u=Math.min(d,Math.max(1,((R=e.player.stats)==null?void 0:R.dexterity)??0)),g=1,p=ye/5,E=Math.sqrt(u/d),A=p*E,x=ye/5,O=Math.min(b.reduce((B,F)=>{var j;return B+(((j=F.stats)==null?void 0:j.attSpeed)??0)},0),1),M=O*x,_=ye/5,$=s(),S=l($),I=(S.attSpeed??0)*_,U=(ye/2.5-1)*((E+O+(S.attSpeed??0))/3);return Math.max(ye-A-M-U-I,g)}),c=(b,d=1)=>{const u=e.player.stats[b]??0,g=u+d;b==="experience"&&fe(g)>fe(u)&&(t==null||t.setState("points",(t.state.points??0)+1),t==null||t.onLog("You have levels up! +1 attr. points","meta")),e.setPlayer("stats",b,g)},f=(b,d=1)=>{const u=(e.player.mastery[b]??0)+d;e.setPlayer("mastery",b,u)},a=b=>o().find(d=>d.equipSlot===b.equipSlot)?!1:(e.setPlayer("equipment",[...e.player.equipment,b.name]),Object.entries(b.stats??{}).forEach(([d,u])=>c(d,u)),!0),m=b=>!e.player.equipment.includes(b.name)?!1:(e.setPlayer("equipment",[...e.player.equipment.filter(u=>u!==b.name)]),Object.entries(b.stats??{}).forEach(([u,g])=>c(u,0-g)),!0),v={attackRate:h,attackDamage:i,player:e.player,equipment:o,onAddStat:c,onAddMastery:f,onEquip:a,onUnequip:m,recipes:n,getMasteryPerk:l,weaponMastery:s,onAddRecipe:r};return y(ue.Provider,{value:v,get children(){return e.children}})},_e=Je(),vr=e=>{const t=N(Q),n=N(ue),[r,o]=q();me(()=>{const a=e.story()??ne;a!=="task"&&o(mt[a]??mt[ne])});const s=()=>{var v;const a=r();if(!a)return;if(a.type==="task")return{name:"task",label:a.label,health:a.duration??0,chance:1,drops:a.items};const m=Math.random();if(!(a.type!=="encounter"||!((v=a.encounters)!=null&&v.length)))return a.encounters.filter(b=>!(t!=null&&t.state.blockedEncounters.includes(b.name))).sort((b,d)=>b.chance-d.chance).find(b=>m<=b.chance)},l=a=>{const{attMin:m,attMax:v}=a.stats??{};if(!(!m||!v))return m+Math.round(Math.random()*(m-v))},i=a=>h(a==null?void 0:a.drops),h=a=>{const m=r();if(!m)return;a=a??m.items??[];let v=[];const b=m.masteryType?(n==null?void 0:n.player.mastery[m.masteryType])??0:0;for(let d of a){let u=d.chance;for(b&&(u=u+Jn(d.name,m.masteryType,b));u>0;)Math.random()<=u&&v.push(d),u--}return v==null?void 0:v.map(d=>{const u=X[d.name];if(!u){console.error(`Unable to find drop ${d.name}`);return}return u.name}).filter(Boolean)},f={story:r,getEncounter:s,getDamage:l,getDrops:i,getItems:h,onTask:a=>{t==null||t.setNav([...(t==null?void 0:t.nav())??[],"task"]),e.setStory("task"),o({name:"task",type:"task",...a,onComplete:a.noRepeat?a.onComplete??(()=>t==null?void 0:t.onNavigate("_back")):void 0})}};return y(_e.Provider,{value:f,get children(){return e.children}})};var _r=L('<div class="flex flex-row mt-auto gap-2"><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Go back</div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Town'),pr=L('<div class="flex flex-col gap-5 p-2 h-full overflow-y-auto">'),yr=L("<div class=text-gray-500>Nothing here..."),wr=L('<span class="text-xs text-gray-400">'),$r=L('<div class="w-full border content-center h-12 text-lg font-bold flex flex-col justify-center">');const Sr=()=>{const e=N(Q),t=N(he),n=N(ue),r=N(_e),o=l=>{if(l.goto)return e==null?void 0:e.onNavigate(l.goto);if(l.action&&e&&t&&n&&r)return l.action(e,t,n,r)},s=D(()=>{var i;const l=(i=r==null?void 0:r.story())==null?void 0:i.options;return Array.isArray(l)?l:e&&t&&n&&r?(l==null?void 0:l(e,t,n,r))??[]:[]});return(()=>{var l=pr();return w(l,y(H,{get when(){var i;return((i=r==null?void 0:r.story())==null?void 0:i.type)!=="encounter"},get children(){return y(H,{get when(){return s().length},get fallback(){return yr()},get children(){return y(te,{get each(){return s()},children:i=>(()=>{var h=$r();return h.$$click=()=>!i.isDisabled&&o(i),w(h,()=>i.label,null),w(h,y(H,{get when(){return i.subtext},get children(){var c=wr();return w(c,()=>i.subtext),c}}),null),Z(c=>{var f=!!i.isDisabled,a=!i.isDisabled;return f!==c.e&&h.classList.toggle("text-gray-500",c.e=f),a!==c.t&&h.classList.toggle("cursor-pointer",c.t=a),c},{e:void 0,t:void 0}),h})()})}})}}),null),w(l,y(H,{get when(){var i;return((i=r==null?void 0:r.story())==null?void 0:i.name)!==ne},get children(){var i=_r(),h=i.firstChild,c=h.nextSibling;return h.$$click=()=>o({label:"Go back",goto:"_back"}),c.$$click=()=>o({label:"Back to town",goto:"_start"}),i}}),null),l})()};ce(["click"]);var kr=L("<div>");const ee=e=>(()=>{var t=kr();return Qe(t,"click",e.onClick),w(t,()=>e.children),Z(()=>Pn(t,`${e.class??""} bg-black rounded py-1 px-2 cursor-pointer hover:outline hover:outline-blue-500 font-bold text-xs h-full`)),t})();ce(["click"]);var Ar=L("<div class=text-sm>"),xr=L("<button class=m-auto> "),Er=L("<button class=m-auto>equip"),Lr=L('<div class="px-2 py-1 bg-blue-900 border border-blue-500 rounded w-full flex flex-row justify-between items-center mb-2"><span class="font-bold text-xl text-black">Stash</span><div class="flex flex-row gap-4">'),Ir=L('<div class="px-2 py-1 bg-red-900 border border-red-500 w-full flex flex-row justify-between items-center rounded"><span class="font-bold text-xl text-black">Drop</span><div class="flex flex-row gap-4">'),Tr=L('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="w-full flex flex-row justify-between gp-2 mb-2">'),Rr=L('<div class="h-full relative"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2">'),Mr=L('<div class="border p-1 cursor-pointer flex flex-col"><div class="flex flex-row justify-between"><div></div><div class="flex flex-row gap-2 items-center"><div class=text-sm>[<!>]</div>(<!>)'),Pr=L('<div class="border p-1 flex flex-row justify-between border-gray-700 text-gray-700">Empty');const Or=()=>{const e=N(Q),t=N(he),n=N(ue),r=N(_e),[o,s]=q(),l=b=>{b<0||!(t!=null&&t.inventory().at(b))||s(b)},i=D(()=>{const b=o()??-1;if(b<0)return;const d=t==null?void 0:t.inventory().at(b);return d?{item:X[d.name],count:d.count}:null}),h=()=>{var u,g;const b=i();if(!b||!e||!t||!n||!r)return;const d=b.count;(g=(u=b.item).use)!=null&&g.call(u,e,t,n,r)&&d<=1&&s(void 0)},c=()=>{const b=i(),d=b?b.item:null;d!=null&&d.equipSlot&&n!=null&&n.onEquip(d)&&(t==null||t.removeInventory(d.name,1),s(void 0))},f=b=>{const d=i();d&&(t==null||t.removeInventory(d.item.name,b),b>=(d.count??1)&&s(void 0))},a=D(()=>{var b;return!(!i()||((b=i())==null?void 0:b.item.category)==="unique")}),m=b=>{const d=i();d&&(b=b===1/0?(t==null?void 0:t.inventory().reduce((u,g)=>(g==null?void 0:g.name)===d.item.name?u+(g.count??0):u,0))??0:b,d&&(t==null||t.addStash(d.item.name,b)))},v=D(()=>e==null?void 0:e.nav().includes("story_home_1"));return(()=>{var b=Rr(),d=b.firstChild;return d.$$click=()=>s(void 0),w(d,y(te,{get each(){return(t==null?void 0:t.inventory())??[]},children:(u,g)=>y(dn,{item:u,onSelect:()=>l(g())})})),w(b,y(H,{get when(){return i()},get children(){var u=Tr(),g=u.firstChild,p=g.firstChild,E=p.firstChild,A=E.nextSibling,x=A.firstChild,O=x.nextSibling;O.nextSibling;var M=p.nextSibling,_=M.firstChild;return E.$$click=()=>s(void 0),w(A,()=>{var $;return($=i())==null?void 0:$.item.label},x),w(A,()=>{var $;return($=i())==null?void 0:$.count},O),w(g,y(H,{get when(){return i().item.stats},get children(){var $=Ar();return w($,()=>Object.entries(i().item.stats??{}).filter(([S,I])=>!!I).map(([S,I])=>`[${S}: ${I}]`).join("")),$}}),M),w(_,y(H,{get when(){var $;return($=i())==null?void 0:$.item.use},get children(){var $=xr(),S=$.firstChild;return $.$$click=h,w($,()=>{var I;return((I=i())==null?void 0:I.item.useVerb)??"Use"},S),$}}),null),w(_,y(H,{get when(){var $;return(($=i())==null?void 0:$.item).equipSlot},get children(){var $=Er();return $.$$click=c,$}}),null),w(M,y(H,{get when(){return v()},get children(){var $=Lr(),S=$.firstChild,I=S.nextSibling;return w(I,y(ee,{onClick:()=>m(1),children:"One"}),null),w(I,y(ee,{onClick:()=>{var T;return m(((T=i())==null?void 0:T.count)??1)},children:"Stack"}),null),w(I,y(ee,{onClick:()=>m(1/0),children:"All"}),null),$}}),null),w(M,y(H,{get when(){return a()},get children(){var $=Ir(),S=$.firstChild,I=S.nextSibling;return w(I,y(ee,{onClick:()=>f(1),children:"One"}),null),w(I,y(ee,{onClick:()=>{var T;return f(((T=i())==null?void 0:T.count)??1)},children:"Stack"}),null),w(I,y(ee,{onClick:()=>f(1/0),children:"All"}),null),$}}),null),u}}),null),b})()},dn=e=>{const t=s=>{s.stopPropagation(),e.onSelect()},n=D(()=>e.item?X[e.item.name]:null),r=D(()=>{const s=n();return s?s.category??s.equipSlot??"unknown":null}),o=D(()=>{const s=n();return s?s.category??(s.equipSlot?"equip":"unknown"):null});return y(H,{get when(){return n()},get fallback(){return Pr()},get children(){var s=Mr(),l=s.firstChild,i=l.firstChild,h=i.nextSibling,c=h.firstChild,f=c.firstChild,a=f.nextSibling;a.nextSibling;var m=c.nextSibling,v=m.nextSibling;return v.nextSibling,s.$$click=t,w(i,()=>n().label),w(c,r,a),w(h,()=>{var b;return(b=e.item)==null?void 0:b.count},v),Z(b=>{var d=o()==="book",u=o()==="resource",g=o()==="food",p=o()==="equip";return d!==b.e&&c.classList.toggle("text-yellow-500",b.e=d),u!==b.t&&c.classList.toggle("text-green-500",b.t=u),g!==b.a&&c.classList.toggle("text-red-500",b.a=g),p!==b.o&&c.classList.toggle("text-blue-500",b.o=p),b},{e:void 0,t:void 0,a:void 0,o:void 0}),s}})};ce(["click"]);var Br=L('<div class="w-full border rounded relative text-black bg-gray-500"><div class="ease-linear w-0 h-full rounded"></div><div class="absolute left-1/2 top-1/2 -translate-1/2 whitespace-nowrap">');const vt=e=>{const t=N(Q),[n,r]=q(e.ticks),o=()=>{let s=n();s<=0&&(e.onFinish(),s=e.ticks+1),r(s-1)};return Ze(()=>t==null?void 0:t.startActivity(e.name,o)),Ge(()=>t==null?void 0:t.endActivity(e.name)),y(Re,{get max(){return e.ticks},get value(){return e.ticks-n()},get type(){return e.type},get showPc(){return e.showPc},get showNumber(){return e.showNumber},get label(){return e.label}})},Re=e=>{const t=D(()=>Math.min(e.value/e.max*100,100));return(()=>{var n=Br(),r=n.firstChild,o=r.nextSibling;return w(o,y(Pe,{get children(){return[y(K,{get when(){return e.showPc},get children(){return[ie(()=>e.label)," (",ie(()=>t().toFixed(0)),"%)"]}}),y(K,{get when(){return e.showNumber},get children(){return[ie(()=>e.label)," ",ie(()=>e.value)]}})]}})),Z(s=>{var l=!e.isSmall,i=t()+"%",h=!e.type,c=e.type==="green",f=e.type==="yellow",a=e.type==="blue",m=e.type==="red";return l!==s.e&&n.classList.toggle("h-full",s.e=l),i!==s.t&&On(r,"width",s.t=i),h!==s.a&&r.classList.toggle("bg-white",s.a=h),c!==s.o&&r.classList.toggle("bg-green-500",s.o=c),f!==s.i&&r.classList.toggle("bg-yellow-500",s.i=f),a!==s.n&&r.classList.toggle("bg-blue-500",s.n=a),m!==s.s&&r.classList.toggle("bg-red-500",s.s=m),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),n})()};var Dr=L('<div class="flex flex-col justify-between items-center cursor-pointer"><div class="text-xl font-bold"></div><div class="h-4 w-32">'),Ur=L('<div class="flex flex-row justify-between items-center font-bold mb-2"><div>Level</div><div>Stats'),Nr=L('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Skills</button><button>Mastery</button><button>Recipes'),qr=L('<div class="flex flex-row justify-between items-center cursor-pointer"><div></div><div class="h-4 w-32">'),Fr=L('<div class="flex flex-row justify-between items-center border-b border-gray-700"><div></div><div class=text-xs>'),Hr=L('<div class="flex flex-row justify-between items-center"><div>');const jr=()=>{const[e,t]=q("mastery"),n=N(ue),[r,o]=q(),s=D(()=>Object.entries((n==null?void 0:n.player.mastery)??{}).map(([c,f])=>{const a=we[c];return{label:(a==null?void 0:a.label)??"",progress:bt(f,be)*100,level:fe(f,be),name:c}})??[]),l=D(()=>{const c=r();if(!c)return;const f=(n==null?void 0:n.player.mastery[c])??0,a=we[c];return{label:(a==null?void 0:a.label)??"",progress:bt(f,be)*100,level:fe(f,be),name:c}}),i=c=>{o(void 0),t(c)},h=D(()=>{var m,v;const c=r();if(c===void 0)return;const f=fe((n==null?void 0:n.player.mastery[c])??0,be),a=(m=we[c])==null?void 0:m.bonus.findLastIndex(b=>b.level<=f);return(v=we[c])==null?void 0:v.bonus.slice(0,(a??0)+2).map((b,d,u)=>({level:b.level,stats:(b.dropModifiers??[]).map(g=>{var p;return`[${(p=X[g.name])==null?void 0:p.label}: +${g.chance}]`})+Object.entries(b.stats??{}).filter(([g,p])=>!!p).map(([g,p])=>`[${g}: ${p}]`).join(""),isLast:d===u.length-1}))});return(()=>{var c=Nr(),f=c.firstChild,a=f.nextSibling,m=a.firstChild,v=m.nextSibling,b=v.nextSibling;return w(f,y(Pe,{get children(){return[y(K,{get when(){return e()==="skills"},children:"TODO"}),y(K,{get when(){return ie(()=>e()==="mastery")()&&!r()},get children(){return y(te,{get each(){return s()},children:d=>(()=>{var u=qr(),g=u.firstChild,p=g.nextSibling;return u.$$click=()=>o(d.name),w(g,()=>d.label),w(p,y(Re,{get label(){return`${d.level}`},type:"yellow",max:100,get value(){return d.progress},showPc:!0})),u})()})}}),y(K,{get when(){return ie(()=>e()==="mastery")()&&r()},get children(){return[(()=>{var d=Dr(),u=d.firstChild,g=u.nextSibling;return w(u,()=>{var p;return(p=l())==null?void 0:p.label}),w(g,y(Re,{get label(){return`${l().level}`},type:"yellow",max:100,get value(){return l().progress},showPc:!0})),d})(),Ur(),y(te,{get each(){return h()},children:d=>(()=>{var u=Fr(),g=u.firstChild,p=g.nextSibling;return w(g,()=>d.level),w(p,(()=>{var E=ie(()=>!!d.isLast);return()=>E()?"???":d.stats})()),u})()})]}}),y(K,{get when(){return e()==="recipes"},get children(){return y(te,{get each(){return n==null?void 0:n.recipes()},children:d=>(()=>{var u=Hr(),g=u.firstChild;return w(g,()=>d.label),u})()})}})]}})),m.$$click=()=>i("skills"),v.$$click=()=>i("mastery"),b.$$click=()=>i("recipes"),Z(d=>{var u=e()==="skills",g=e()==="mastery",p=e()==="recipes";return u!==d.e&&m.classList.toggle("selected",d.e=u),g!==d.t&&v.classList.toggle("selected",d.t=g),p!==d.a&&b.classList.toggle("selected",d.a=p),d},{e:void 0,t:void 0,a:void 0}),c})()};ce(["click"]);var zr=L('<span class="text-red-800 font-bold">'),Vr=L('<span class="text-green-800 font-bold">'),Bt=L('<span class="text-red-800 font-bold m-1">'),Wr=L('<span class="font-bold m-1">'),Xr=L("<span class=font-bold>"),Kr=L("<div class=text-red-800>"),Yr=L("<div class=h-8><div class=h-2>"),Zr=L("<div class=h-2>"),Gr=L('<div class="h-8 mt-5">'),Jr=L('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>Attacking (<!>)');const Qr=()=>{const e=N(Q),t=N(_e),n=N(ue),r=N(he),[o,s]=q(),[l,i]=q(25),[h,c]=q(0),[f,a]=q(0),[m,v]=q(),[b,d]=q();me(A=>{var x,O;return(x=t==null?void 0:t.story())!=null&&x.name&&(e!=null&&e.pause())&&!A?(s((O=t==null?void 0:t.story())==null?void 0:O.name),e==null||e.startActivity(`${o()}_catchup`,u),!A):!(e!=null&&e.pause())&&A?(e==null||e.endActivity(`${o()}_catchup`),!A):A},!1);const u=()=>{l()<=0&&b()?g():i(l()-1)};Ze(()=>{var A,x;s((A=t==null?void 0:t.story())==null?void 0:A.name),i((n==null?void 0:n.attackRate())??25),d(t==null?void 0:t.getEncounter()),v((x=b())==null?void 0:x.health)});const g=()=>{var U,V,R;const A=!(e!=null&&e.pause()),[x,O]=[n,t==null?void 0:t.story()],M=b(),_=m();if(!x||!O)return;if(i((n==null?void 0:n.attackRate())??25),!M&&O.limit&&f()>=O.limit){(U=O.onComplete)==null||U.call(O,e,r,n,t);return}if(!M){d(t==null?void 0:t.getEncounter()),v((V=b())==null?void 0:V.health);return}if(!_)return;const[$,S]=(n==null?void 0:n.attackDamage())??[0,1],I=$+Math.round(Math.random()*(S-$)),T=_-Math.min(I,_);if(A&&(e==null||e.onLog(["You hit the ",(()=>{var B=zr();return w(B,M.label),B})()," for ",(()=>{var B=Vr();return w(B,I),B})()," damage"],"basic")),n==null||n.onAddMastery(n==null?void 0:n.weaponMastery(),I),T<=0){A&&(e==null||e.onLog(["You killed the",(()=>{var j=Bt();return w(j,M.label),j})()],"good")),M.isUnique&&(e==null||e.setState("blockedEncounters",[...e.state.blockedEncounters,M.name])),a(f()+1),d(void 0),M.experience&&(n==null||n.onAddStat("experience",M.experience));const B=(R=t==null?void 0:t.getDrops(M))==null?void 0:R.filter(j=>{var J;return!((J=e==null?void 0:e.state.prohibitedItems)!=null&&J.includes(j))}),F=B==null?void 0:B.filter(j=>!!(r!=null&&r.addInventory(j)));if(F!=null&&F.length&&A&&(e==null||e.onLog(["It dropped:",(()=>{var j=Wr();return w(j,F==null?void 0:F.map(J=>{var Ae;return(Ae=X[J])==null?void 0:Ae.label}).join(", ")),j})()],"drop")),!(F!=null&&F.length)&&(B!=null&&B.length)){e==null||e.onLog("You retreat with a full bag","meta"),e==null||e.onNavigate("_back");return}if(O.noRepeat)return;c(O.cooldown??0),e==null||e.startActivity(`${o()}_wait`,E)}v(Math.max(T,0))},p=()=>{var S;const A=!(e!=null&&e.pause()),[x,O]=[n==null?void 0:n.player,t==null?void 0:t.story()];if(!x||!O)return;const{attMin:M,attMax:_}=((S=b())==null?void 0:S.stats)??{};if(M===void 0||_===void 0)return;const $=M+Math.round(Math.random()*(_-M));if(A&&(e==null||e.onLog([(()=>{var I=Bt();return w(I,b().label),I})()," hits you for ",(()=>{var I=Xr();return w(I,$),I})()," damage!"],"bad")),x.stats.health<=$){e==null||e.onNavigate("_start");return}n==null||n.onAddStat("health",-$)},E=()=>{if(h()<=0)return e==null||e.endActivity(`${o()}_wait`),g();c(h()-1)};return Ge(()=>{e==null||e.endActivity(`${o()}_wait`)}),y(H,{get when(){return!(e!=null&&e.pause())},get children(){var A=Jr(),x=A.firstChild,O=x.firstChild,M=O.nextSibling;return M.nextSibling,w(x,f,M),w(x,y(H,{get when(){var _;return(_=t==null?void 0:t.story())==null?void 0:_.limit},get children(){return[" / ",ie(()=>{var _;return(_=t==null?void 0:t.story())==null?void 0:_.limit})]}}),M),w(A,y(H,{get when(){var _;return ie(()=>{var $;return!!(!b()&&(($=t==null?void 0:t.story())!=null&&$.limit))})()&&f()>=(((_=t==null?void 0:t.story())==null?void 0:_.limit)??0)},children:"There is nothing left here to destroy"}),null),w(A,y(H,{get when(){return b()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var _=Kr();return w(_,()=>{var $;return($=b())==null?void 0:$.label}),_})(),(()=>{var _=Yr(),$=_.firstChild;return w(_,y(Re,{type:"red",get max(){return(n==null?void 0:n.player.stats.maxHealth)??10},get value(){return(n==null?void 0:n.player.stats.health)??0},label:"You",showNumber:!0}),$),w($,y(vt,{get name(){return`${o()}_att`},get ticks(){return l()},onFinish:g,type:"yellow",isSmall:!0})),_})(),(()=>{var _=Gr();return w(_,y(Re,{type:"red",get max(){return b().health},get value(){return m()},get label(){var $;return($=b())==null?void 0:$.label},showNumber:!0}),null),w(_,y(H,{get when(){var $,S;return(S=($=b())==null?void 0:$.stats)==null?void 0:S.attSpeed},get children(){var $=Zr();return w($,y(vt,{get name(){return`${o()}_enc`},get ticks(){return b().stats.attSpeed},onFinish:p,type:"yellow",isSmall:!0})),$}}),null),_})()]}}),null),A}})};var Cr=L('<span class="text-red-800 font-bold m-1">'),eo=L('<span class="font-bold m-1">'),to=L("<div class=text-red-800>"),no=L("<div class=h-8>"),ro=L('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>');const oo=()=>{const e=N(Q),t=N(he),n=N(ue),r=N(_e),[o,s]=q(),[l,i]=q(!1),[h,c]=q(0),[f,a]=q(0),m=D(()=>{var g,p,E;const u=(g=r==null?void 0:r.story())==null?void 0:g.masteryType;if(u){const A=fn(u,(n==null?void 0:n.player.mastery[u])??0);return Math.max(1,(((p=r==null?void 0:r.story())==null?void 0:p.duration)??100)-(A.durationModifier??0))}return((E=r==null?void 0:r.story())==null?void 0:E.duration)??100});me(()=>{var u;(u=r==null?void 0:r.story())!=null&&u.utilityType&&(n!=null&&n.equipment().find(g=>{var p;return g.utilityType===((p=r==null?void 0:r.story())==null?void 0:p.utilityType)})||e==null||e.onNavigate("_back"))}),me(u=>{var g,p;return m()?(g=r==null?void 0:r.story())!=null&&g.name&&(e!=null&&e.pause())&&!u?(s((p=r==null?void 0:r.story())==null?void 0:p.name),a(f()??m()),e==null||e.startActivity(`${o()}_catchup`,v),!u):!(e!=null&&e.pause())&&u?(e==null||e.endActivity(`${o()}_catchup`),!u):u:u},!1);const v=()=>{f()<=0&&l()?b():a(f()-1)};Ze(()=>{var u;s((u=r==null?void 0:r.story())==null?void 0:u.name),i(!0)});const b=()=>{var E,A;const u=r==null?void 0:r.story();if(!n||!r||!u)return;if(!l()){a(m()),i(!0);return}i(!1),e==null||e.onLog(["You finished",(()=>{var x=Cr();return w(x,u.description),x})()],"good"),u.masteryType&&(n==null||n.onAddMastery(u.masteryType,u.experience??0));const g=(E=r.getItems())==null?void 0:E.filter(x=>{var O;return!((O=e==null?void 0:e.state.prohibitedItems)!=null&&O.includes(x))}),p=g==null?void 0:g.filter(x=>!!(t!=null&&t.addInventory(x)));if(p!=null&&p.length){const x=p.map(O=>{var M;return((M=X[O])==null?void 0:M.label)??"Unknown"});e==null||e.onLog(["You gained:",(()=>{var O=eo();return w(O,x==null?void 0:x.join(", ")),O})()],"drop")}if(u.noRepeat)return((A=u.onComplete)==null?void 0:A.call(u,e,t,n,r))??(e==null?void 0:e.onNavigate("_back"));if(!(p!=null&&p.length)&&(g!=null&&g.length)){e==null||e.onLog("You retreat with a full bag","meta"),e==null||e.onNavigate("_back");return}c(u.cooldown??0),e==null||e.startActivity(`${o()}_wait`,d)},d=()=>{if(h()<=0)return e==null||e.endActivity(`${o()}_wait`),b();c(h()-1)};return Ge(()=>{e==null||e.endActivity(`${o()}_wait`),e==null||e.endActivity(`${o()}_catchup`)}),y(H,{get when(){return!(e!=null&&e.pause())},get children(){var u=ro(),g=u.firstChild;return w(g,()=>{var p;return(p=r==null?void 0:r.story())==null?void 0:p.label}),w(u,y(H,{get when(){return l()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var p=to();return w(p,()=>{var E;return(E=r==null?void 0:r.story())==null?void 0:E.description}),p})(),(()=>{var p=no();return w(p,y(vt,{get name(){return`${o()}_task`},get ticks(){return m()},onFinish:b,label:"Task",showPc:!0})),p})()]}}),null),u}})};var so=L('<div class="text-lg font-bold mt-5">Weapon'),lo=L('<div class="text-lg font-bold mt-5">Armour'),io=L('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Equip</button><button>Attr.</button><button>Stats'),ao=L('<div class="flex flex-row justify-between border-gray-700"><div></div><div>'),co=L("<button class=h-8>+"),uo=L('<div class="flex flex-row justify-between border-gray-700 p-2 items-center"><div></div><div class="flex flex-row gap-2 items-center">'),fo=L('<div class="flex flex-row justify-between items-center border-gray-700"><div></div><div class="text-xs text-gray-500">');const ho=()=>{const[e,t]=q("stats"),n=N(ue),r=N(he),o=N(Q),s=D(()=>{const f=n==null?void 0:n.attackDamage(),a=1e3/Ue,m=1/(((n==null?void 0:n.attackRate())??ye)/a);return[{label:"Health",value:(n==null?void 0:n.player.stats.health)??0},{label:"Max health",value:(n==null?void 0:n.player.stats.maxHealth)??0},{label:"",value:""},{label:"Att. min",value:(f==null?void 0:f.at(0))??0},{label:"Att. max",value:(f==null?void 0:f.at(1))??0},{label:"Att. rate",value:`${(m==null?void 0:m.toFixed(2))??0} p/s`},{label:"",value:""},{label:"Phys. res",value:(n==null?void 0:n.player.stats.physRes)??0},{label:"Mag. res",value:(n==null?void 0:n.player.stats.magRes)??0}]}),l=D(()=>[{label:"Strength",value:(n==null?void 0:n.player.stats.strength)??0,name:"strength"},{label:"Agility",value:(n==null?void 0:n.player.stats.agility)??0,name:"agility"},{label:"Dexterity",value:(n==null?void 0:n.player.stats.dexterity)??0,name:"dexterity"},{label:"Intelligence",value:(n==null?void 0:n.player.stats.intelligence)??0,name:"intelligence"},{label:"Charisma",value:(n==null?void 0:n.player.stats.charisma)??0,name:"charisma"},{label:"Constitution",value:(n==null?void 0:n.player.stats.constitution)??0,name:"constitution"}]),i=f=>{r!=null&&r.addInventory(f.name,1)&&(n==null||n.onUnequip(f))},h=D(()=>{const f=["weapon","offhand"],a=["head","shoulder","chest","hand","leg","foot"];return[{label:so(),isDisabled:!1,isEmpty:!0},...f.map(m=>{const v=m&&(n==null?void 0:n.equipment().find(b=>b.equipSlot===m));return{label:(v==null?void 0:v.label)??m,isDisabled:!v,subtext:Object.entries((v==null?void 0:v.stats)??{}).map(([b,d])=>`[${b}: ${d}]`).join(""),onClick:v?()=>i(v):void 0}}),{label:lo(),isDisabled:!1,isEmpty:!0},...a.map(m=>{const v=m&&(n==null?void 0:n.equipment().find(b=>b.equipSlot===m));return{label:(v==null?void 0:v.label)??m,isDisabled:!v,subtext:Object.entries((v==null?void 0:v.stats)??{}).map(([b,d])=>`[${b}: ${d}]`).join(""),onClick:v?()=>i(v):void 0}})]}),c=f=>{const a=(o==null?void 0:o.state.points)??0;a>0&&Se(()=>{o==null||o.setState("points",a-1),n==null||n.onAddStat(f,1)})};return(()=>{var f=io(),a=f.firstChild,m=a.nextSibling,v=m.firstChild,b=v.nextSibling,d=b.nextSibling;return w(a,y(Pe,{get children(){return[y(K,{get when(){return e()==="stats"},get children(){return y(te,{get each(){return s()},children:u=>(()=>{var g=ao(),p=g.firstChild,E=p.nextSibling;return w(p,()=>u.label),w(E,()=>u.value),Z(()=>g.classList.toggle("border-b",!!u.label)),g})()})}}),y(K,{get when(){return e()==="attributes"},get children(){return y(te,{get each(){return l()},children:u=>(()=>{var g=uo(),p=g.firstChild,E=p.nextSibling;return w(p,()=>u.label),w(E,()=>u.value,null),w(E,y(H,{get when(){return!!(o!=null&&o.state.points)},get children(){var A=co();return A.$$click=()=>c(u.name),A}}),null),Z(()=>g.classList.toggle("border-b",!!u.label)),g})()})}}),y(K,{get when(){return e()==="equip"},get children(){return y(te,{get each(){return h()},children:u=>(()=>{var g=fo(),p=g.firstChild,E=p.nextSibling;return Qe(g,"click",u.onClick),w(p,()=>u.label),w(E,()=>u.subtext),Z(A=>{var x=!u.isEmpty,O=!!u.isDisabled;return x!==A.e&&g.classList.toggle("border-b",A.e=x),O!==A.t&&p.classList.toggle("text-gray-700",A.t=O),A},{e:void 0,t:void 0}),g})()})}})]}})),v.$$click=()=>t("equip"),b.$$click=()=>t("attributes"),d.$$click=()=>t("stats"),Z(u=>{var g=e()==="equip",p=e()==="attributes",E=e()==="stats";return g!==u.e&&v.classList.toggle("selected",u.e=g),p!==u.t&&b.classList.toggle("selected",u.t=p),E!==u.a&&d.classList.toggle("selected",u.a=E),u},{e:void 0,t:void 0,a:void 0}),f})()};ce(["click"]);var bo=L('<div class="px-2 py-1 bg-red-900 border border-red-500 rounded w-full flex flex-row justify-between items-center mb-2"><span class="font-bold text-xl text-black">Drop</span><div class="flex flex-row gap-4">'),go=L('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative mb-3"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="px-2 py-1 bg-blue-900 border border-blue-500 rounded w-full flex flex-row justify-between items-center mb-2"><span class="font-bold text-xl text-black">Transfer</span><div class="flex flex-row gap-4">'),mo=L('<div class="h-full relative pb-2"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2"></div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Leave stash');const vo=()=>{const e=N(he),t=N(Q),[n,r]=q(),o=c=>{c<0||!(e!=null&&e.stash()[c])||r(c)},s=D(()=>{const c=n()??-1;if(c<0)return;const f=e==null?void 0:e.stash().at(c);return f?{item:X[f.name],count:f.count}:null}),l=c=>{const f=s();f&&(e==null||e.removeInventory(f.item.name,c),c>=(f.count??1)&&r(void 0))},i=c=>{const f=s();f&&(c=c===1/0?(e==null?void 0:e.stash().reduce((a,m)=>(m==null?void 0:m.name)===f.item.name?a+m.count:a,0))??0:c,e==null||e.removeStash(f.item.name,c))},h=D(()=>{var c;return!(!s()||((c=s())==null?void 0:c.item.category)==="unique")});return(()=>{var c=mo(),f=c.firstChild,a=f.nextSibling;return f.$$click=()=>r(void 0),w(f,y(te,{get each(){return e==null?void 0:e.stash()},children:(m,v)=>y(dn,{item:m,onSelect:()=>o(v())})})),w(c,y(H,{get when(){return s()},get children(){var m=go(),v=m.firstChild,b=v.firstChild,d=b.firstChild,u=d.nextSibling,g=u.firstChild,p=g.nextSibling;p.nextSibling;var E=b.nextSibling,A=E.firstChild,x=A.firstChild,O=x.nextSibling;return d.$$click=()=>r(void 0),w(u,()=>{var M;return(M=s())==null?void 0:M.item.label},g),w(u,()=>{var M;return(M=s())==null?void 0:M.count},p),w(O,y(ee,{onClick:()=>i(1),children:"One"}),null),w(O,y(ee,{onClick:()=>{var M;return i(((M=s())==null?void 0:M.count)??1)},children:"Stack"}),null),w(O,y(ee,{onClick:()=>i(1/0),children:"All"}),null),w(E,y(H,{get when(){return h()},get children(){var M=bo(),_=M.firstChild,$=_.nextSibling;return w($,y(ee,{onClick:()=>l(1),children:"One"}),null),w($,y(ee,{onClick:()=>{var S;return l(((S=s())==null?void 0:S.count)??1)},children:"Stack"}),null),w($,y(ee,{onClick:()=>l(1/0),children:"All"}),null),M}}),null),m}}),a),a.$$click=()=>t==null?void 0:t.onNavigate("_back"),c})()};ce(["click"]);var _o=L('<div class="flex flex-col p-2 gap-2 w-full"><div class="border p-2 font-bold cursor-pointer">RESET');const po=()=>{const e=N(Q);return(()=>{var t=_o(),n=t.firstChild;return Qe(n,"click",e==null?void 0:e.onClearState),t})()};ce(["click"]);var Dt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rt,Ut;function wo(){return Ut||(Ut=1,rt={Other:0,CR:1,LF:2,Control:4,Extend:8,ZWJ:16,Regional_Indicator:32,Prepend:64,SpacingMark:128,L:256,V:512,T:1024,LV:2048,LVT:4096,Extended_Pictographic:8192,InCB_Linker:16384,InCB_Consonant:32768,InCB_Extend:65536}),rt}const $o="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",So={data:$o},ko="AAACAAAAAACAOAAAAbYBSf7t2S1IBEEYBuDVDZ7FYrQMNsFiu3hgEYOI0SCXRIUrB8JhEZtgs5gEg1GMFk02m82oGI02m+9xezCOczv/uwv3fvAwc/PzfXOzcdqzWdaBDdiGPdiHdjE+DS3RNDuCfsn8idQ/g3OH3BdwKf0e96/gumTfYcncLdzBPTzAo+RZ+f0Cr/AG7/AJX4738x1wtz9FO5PX/50n6UXMNdfg/0lERERERERERERERETpdedHBvDRql4nq0cXtW9af98qdRby0Vvp8K4W0V+C5Xw0t4J2bfjeBp3cnEu1brnnCTYNa7eKdz91XP7WO9Lb4GqRb7cY6xbtAdqeVOsY/QGcevw/tb6OT85YhvfKYEx9CMuxKsKnrs+eJtVInVvHJ0eVYVvTZk2siFVLOCjb61PTZX3MdVWEyP7fjzpmMxdzTyq2Ebue6x61nXRGnzndWpf1an7dXmGYE4Y1ptqqKsK1nu26Ju0ty+maV2Rpvk+qnDZjKUIobUiesdAQE/jmCTmHmsskpFZsVYbtmXRcaoSGUPomunW2derQhDPFjtT1Q/eb8vnm990fq35oHVt11bU9m89c7DNI8Qs=",Ao={data:ko},xo="AAgOAAAAAABQfgAAAWMGnPntmm2IVUUYx+dyb2ezXXtBiSCLsKDIiKIIoYINciGwQHrRL2Ufii0qMsv7QVBuQkXhkmW5gksQRhRFSBslbkllHyy3L2XllkXrB3uhF0tQ0Kj+xzN3d3buzJx5PeesOw/8mDNvz/PMnOc8s/fs6asTcgu4A9wF+mjdV9kEa8FqsE5j/DPgeUX/JvASeBW8Bd4GO8CHYDcz7nPwFRgD4+An8Cf4AxwBx0G9QcjrYBt4p5HN/YDqGEF9F7gW3AC6wU1gCVgK5oDlYA8YBXvBGOgHD4FzwSo6fg24EDwBxsEB8Cu1N4ByI1gA/gbfo+0wyuO0vgW8DK5i+tN5tVOyMmUWrs9k6nNxPY/WL0B5Mb2+HOU14HrwY2Ny/CLUbwa3gzsZPT7ZGECnDvdiPQ+ARyhpWxPlWnr9JLfeAdS/43S8qNiTIdq3FeUb9HolOEj7h9H2LtgJPgHr0TZKx31Jy30C/T+g7aDCbpPiuj/fStrTNfQGioWIHr9z+z8iiAEfdg4zdo7Gex6JRCKRSCQSiUQikYrzL367HmLq8zV+yyYJIbOTzva5aJtH2y9CuYBebwdX4PoYyv107ELUe5PsPWBavzHJ3tMtFuhluTWnPxKJRCKRSCQy/TjQCKt/XX3y/+o6HPJs35XNszPO0WQf+FnQfsnpU+vLUN8MdgNyRtZ2Ncp7wBDYDn4D47MIOes0QpaADeDUWsYe5pql3k3IZd3iPp4H6bjnUI6Cf8B1PYQ0wWCPno5IJBKJnJx83eN2fi7NeYd0jKsvr+A7p3749KzkXd2Ap+9R7qfrflhz/ava45m2I7Rcw+lI3/WtAO+Bx5PsG6+nk+xbv7Q/fWe4gc7ZRPu3oNzK6Hktmfy2r036vc82On44yb4ZHKFzPkL5aZJ9f9hH7Y8y+nbheq9irWOpf0z/L8nUWPmL6TuK6/8Uuhpd6r3sRv8cbszZXZm981HOB5fS/itzdIlYyMzpTa85HYtRv422LTPQ/yjd+/SZudvCr1DcV5Iv6W+HFRXaB988Rte2ugJrHKTPW4vx5akK+MWzvoI++Sb9zvKFriy/m8wbwpxXQL/gDNs5Tb+zTPfiza6sHEa5A3w8jWLgM/j6BePvoOBcM33+v6Hj9zvuQ978lR5ihl/bedM0DvN4vwI+NOvy7/SbCkze51WVRfXaCaJEmdlSm+H4lKLsVE3Kvoe2950tZdcnu5T1rISQKuaHovZNZw26/aKxvn0tS6oUG1WWmbAPvtbGjzPU2WvgV4uoEc7PkQ77MhHoYu1K7YvOVhv7uuJ7/QpdLcKtX2ZPthc1A/tEcK/zbAW+/0rbnqRVAlPuk0gC5b5cv1Q+BbIp8kGnX2VjQmT7bLm/Hfp1RfZ3kAdpGZI3h2iMnZCC47ftj+351WJ06PTLxk6I7OxxWH8rd4RCRHHuKC1DbOaIdJyQAn4vuPpqS8d5HVJUfy+p2lXjihIbuya/L2wowkae3TJEZFfmjywnBshRSl9s9Je1v7z9kL7bPE9Fi+xMlf09Z3Ne2KxNFu8qf2x02ojMD9McrpOLivTX9j6F9l/HfmgbotKnfp9nJCHqffFho0hcxWRNhHTarUI8h94PGx28Pp2xrrZ8SehcFToPhvabvbZ5JkXx4etZd4lZfn0+pIz8oMoRunpsbPgUUZ4NaYu1qcr9vC+2MWsa8yHOPlOxfU7L9Fnkg0t+0dGdZ9O38PGr6nPxwzRWXUX0/JmSN09kU+WPyD8f4jM+ioo7lW1femzuv0iXqi5r8yGq/fBts+gca/M8+orLvOc0RJ7P88c0J/m2L/OFbzfVa5LrXc4WH2NsbJrulcsafa+T99lFVwgpwr7JMy47U3T0FiFF56uQuss4j3gfbOb68sUlB6vOjaLPtrbdkLp9nZmqffcpqnurk4NU+oq8rzIx2Xddv8tel+peydar+htBpIufH0J4O2XFCCu2z0GZayjyDMzLS6Z+yGK1Sjmk7RNbtq91zrXQfumeOb58MdGTtxdlngmyc09nTlmxqfMcmvij67OJXV3R3dOQsZznh6qfkOL80M3BuvtW1B7yY2R+FLG/MsnzVXd+aF9VuUk1xzWudPwy1edzz1x8t9UfyndbHTY2yxTdHOCa92zj3CR+Te6fjzX5Ftf9M/E1VC4yzVehROa77/h09cmXb6Zxm2c3pPjSH9bn/wE=",Eo={data:xo};var ot,Nt;function Lo(){if(Nt)return ot;Nt=1;var e=0,t=-3;function n(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function r(_,$){this.source=_,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=$,this.destLen=0,this.ltree=new n,this.dtree=new n}var o=new n,s=new n,l=new Uint8Array(30),i=new Uint16Array(30),h=new Uint8Array(30),c=new Uint16Array(30),f=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=new n,m=new Uint8Array(320);function v(_,$,S,I){var T,U;for(T=0;T<S;++T)_[T]=0;for(T=0;T<30-S;++T)_[T+S]=T/S|0;for(U=I,T=0;T<30;++T)$[T]=U,U+=1<<_[T]}function b(_,$){var S;for(S=0;S<7;++S)_.table[S]=0;for(_.table[7]=24,_.table[8]=152,_.table[9]=112,S=0;S<24;++S)_.trans[S]=256+S;for(S=0;S<144;++S)_.trans[24+S]=S;for(S=0;S<8;++S)_.trans[168+S]=280+S;for(S=0;S<112;++S)_.trans[176+S]=144+S;for(S=0;S<5;++S)$.table[S]=0;for($.table[5]=32,S=0;S<32;++S)$.trans[S]=S}var d=new Uint16Array(16);function u(_,$,S,I){var T,U;for(T=0;T<16;++T)_.table[T]=0;for(T=0;T<I;++T)_.table[$[S+T]]++;for(_.table[0]=0,U=0,T=0;T<16;++T)d[T]=U,U+=_.table[T];for(T=0;T<I;++T)$[S+T]&&(_.trans[d[$[S+T]]++]=T)}function g(_){_.bitcount--||(_.tag=_.source[_.sourceIndex++],_.bitcount=7);var $=_.tag&1;return _.tag>>>=1,$}function p(_,$,S){if(!$)return S;for(;_.bitcount<24;)_.tag|=_.source[_.sourceIndex++]<<_.bitcount,_.bitcount+=8;var I=_.tag&65535>>>16-$;return _.tag>>>=$,_.bitcount-=$,I+S}function E(_,$){for(;_.bitcount<24;)_.tag|=_.source[_.sourceIndex++]<<_.bitcount,_.bitcount+=8;var S=0,I=0,T=0,U=_.tag;do I=2*I+(U&1),U>>>=1,++T,S+=$.table[T],I-=$.table[T];while(I>=0);return _.tag=U,_.bitcount-=T,$.trans[S+I]}function A(_,$,S){var I,T,U,V,R,B;for(I=p(_,5,257),T=p(_,5,1),U=p(_,4,4),V=0;V<19;++V)m[V]=0;for(V=0;V<U;++V){var F=p(_,3,0);m[f[V]]=F}for(u(a,m,0,19),R=0;R<I+T;){var j=E(_,a);switch(j){case 16:var J=m[R-1];for(B=p(_,2,3);B;--B)m[R++]=J;break;case 17:for(B=p(_,3,3);B;--B)m[R++]=0;break;case 18:for(B=p(_,7,11);B;--B)m[R++]=0;break;default:m[R++]=j;break}}u($,m,0,I),u(S,m,I,T)}function x(_,$,S){for(;;){var I=E(_,$);if(I===256)return e;if(I<256)_.dest[_.destLen++]=I;else{var T,U,V,R;for(I-=257,T=p(_,l[I],i[I]),U=E(_,S),V=_.destLen-p(_,h[U],c[U]),R=V;R<V+T;++R)_.dest[_.destLen++]=_.dest[R]}}}function O(_){for(var $,S,I;_.bitcount>8;)_.sourceIndex--,_.bitcount-=8;if($=_.source[_.sourceIndex+1],$=256*$+_.source[_.sourceIndex],S=_.source[_.sourceIndex+3],S=256*S+_.source[_.sourceIndex+2],$!==(~S&65535))return t;for(_.sourceIndex+=4,I=$;I;--I)_.dest[_.destLen++]=_.source[_.sourceIndex++];return _.bitcount=0,e}function M(_,$){var S=new r(_,$),I,T,U;do{switch(I=g(S),T=p(S,2,0),T){case 0:U=O(S);break;case 1:U=x(S,o,s);break;case 2:A(S,S.ltree,S.dtree),U=x(S,S.ltree,S.dtree);break;default:U=t}if(U!==e)throw new Error("Data error")}while(!I);return S.destLen<S.dest.length?typeof S.dest.slice=="function"?S.dest.slice(0,S.destLen):S.dest.subarray(0,S.destLen):S.dest}return b(o,s),v(l,i,4,3),v(h,c,2,1),l[28]=0,i[28]=258,ot=M,ot}var st,qt;function Io(){if(qt)return st;qt=1;const e=new Uint8Array(new Uint32Array([305419896]).buffer)[0]===18,t=(o,s,l)=>{let i=o[s];o[s]=o[l],o[l]=i},n=o=>{const s=o.length;for(let l=0;l<s;l+=4)t(o,l,l+3),t(o,l+1,l+2)};return st={swap32LE:o=>{e&&n(o)}},st}var lt,Ft;function To(){if(Ft)return lt;Ft=1;const e=Lo(),{swap32LE:t}=Io(),n=11,r=5,o=n-r,s=65536>>n,i=(1<<o)-1,h=2,f=(1<<r)-1,a=65536>>r,m=1024>>r,u=a+m+32,g=1<<h;class p{constructor(A){const x=typeof A.readUInt32BE=="function"&&typeof A.slice=="function";if(x||A instanceof Uint8Array){let O;if(x)this.highStart=A.readUInt32LE(0),this.errorValue=A.readUInt32LE(4),O=A.readUInt32LE(8),A=A.slice(12);else{const M=new DataView(A.buffer);this.highStart=M.getUint32(0,!0),this.errorValue=M.getUint32(4,!0),O=M.getUint32(8,!0),A=A.subarray(12)}A=e(A,new Uint8Array(O)),A=e(A,new Uint8Array(O)),t(A),this.data=new Uint32Array(A.buffer)}else({data:this.data,highStart:this.highStart,errorValue:this.errorValue}=A)}get(A){let x;return A<0||A>1114111?this.errorValue:A<55296||A>56319&&A<=65535?(x=(this.data[A>>r]<<h)+(A&f),this.data[x]):A<=65535?(x=(this.data[a+(A-55296>>r)]<<h)+(A&f),this.data[x]):A<this.highStart?(x=this.data[u-s+(A>>n)],x=this.data[x+(A>>r&i)],x=(x<<h)+(A&f),this.data[x]):this.data[this.data.length-g]}}return lt=p,lt}var Ne={exports:{}},Ro=Ne.exports,Ht;function Mo(){return Ht||(Ht=1,(function(e,t){(function(n,r){e.exports=r()})(typeof self<"u"?self:typeof window<"u"?window:typeof Dt<"u"?Dt:Ro,function(){var n="3.7.8",r=n,o=typeof Buffer=="function",s=typeof TextDecoder=="function"?new TextDecoder:void 0,l=typeof TextEncoder=="function"?new TextEncoder:void 0,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=Array.prototype.slice.call(i),c=(function(k){var P={};return k.forEach(function(Y,C){return P[Y]=C}),P})(h),f=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,a=String.fromCharCode.bind(String),m=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(k){return new Uint8Array(Array.prototype.slice.call(k,0))},v=function(k){return k.replace(/=/g,"").replace(/[+\/]/g,function(P){return P=="+"?"-":"_"})},b=function(k){return k.replace(/[^A-Za-z0-9\+\/]/g,"")},d=function(k){for(var P,Y,C,oe,se="",Ce=k.length%3,Oe=0;Oe<k.length;){if((Y=k.charCodeAt(Oe++))>255||(C=k.charCodeAt(Oe++))>255||(oe=k.charCodeAt(Oe++))>255)throw new TypeError("invalid character found");P=Y<<16|C<<8|oe,se+=h[P>>18&63]+h[P>>12&63]+h[P>>6&63]+h[P&63]}return Ce?se.slice(0,Ce-3)+"===".substring(Ce):se},u=typeof btoa=="function"?function(k){return btoa(k)}:o?function(k){return Buffer.from(k,"binary").toString("base64")}:d,g=o?function(k){return Buffer.from(k).toString("base64")}:function(k){for(var P=4096,Y=[],C=0,oe=k.length;C<oe;C+=P)Y.push(a.apply(null,k.subarray(C,C+P)));return u(Y.join(""))},p=function(k,P){return P===void 0&&(P=!1),P?v(g(k)):g(k)},E=function(k){if(k.length<2){var P=k.charCodeAt(0);return P<128?k:P<2048?a(192|P>>>6)+a(128|P&63):a(224|P>>>12&15)+a(128|P>>>6&63)+a(128|P&63)}else{var P=65536+(k.charCodeAt(0)-55296)*1024+(k.charCodeAt(1)-56320);return a(240|P>>>18&7)+a(128|P>>>12&63)+a(128|P>>>6&63)+a(128|P&63)}},A=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,x=function(k){return k.replace(A,E)},O=o?function(k){return Buffer.from(k,"utf8").toString("base64")}:l?function(k){return g(l.encode(k))}:function(k){return u(x(k))},M=function(k,P){return P===void 0&&(P=!1),P?v(O(k)):O(k)},_=function(k){return M(k,!0)},$=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,S=function(k){switch(k.length){case 4:var P=(7&k.charCodeAt(0))<<18|(63&k.charCodeAt(1))<<12|(63&k.charCodeAt(2))<<6|63&k.charCodeAt(3),Y=P-65536;return a((Y>>>10)+55296)+a((Y&1023)+56320);case 3:return a((15&k.charCodeAt(0))<<12|(63&k.charCodeAt(1))<<6|63&k.charCodeAt(2));default:return a((31&k.charCodeAt(0))<<6|63&k.charCodeAt(1))}},I=function(k){return k.replace($,S)},T=function(k){if(k=k.replace(/\s+/g,""),!f.test(k))throw new TypeError("malformed base64.");k+="==".slice(2-(k.length&3));for(var P,Y,C,oe=[],se=0;se<k.length;)P=c[k.charAt(se++)]<<18|c[k.charAt(se++)]<<12|(Y=c[k.charAt(se++)])<<6|(C=c[k.charAt(se++)]),Y===64?oe.push(a(P>>16&255)):C===64?oe.push(a(P>>16&255,P>>8&255)):oe.push(a(P>>16&255,P>>8&255,P&255));return oe.join("")},U=typeof atob=="function"?function(k){return atob(b(k))}:o?function(k){return Buffer.from(k,"base64").toString("binary")}:T,V=o?function(k){return m(Buffer.from(k,"base64"))}:function(k){return m(U(k).split("").map(function(P){return P.charCodeAt(0)}))},R=function(k){return V(F(k))},B=o?function(k){return Buffer.from(k,"base64").toString("utf8")}:s?function(k){return s.decode(V(k))}:function(k){return I(U(k))},F=function(k){return b(k.replace(/[-_]/g,function(P){return P=="-"?"+":"/"}))},j=function(k){return B(F(k))},J=function(k){if(typeof k!="string")return!1;var P=k.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(P)||!/[^\s0-9a-zA-Z\-_]/.test(P)},Ae=function(k){return{value:k,enumerable:!1,writable:!0,configurable:!0}},yt=function(){var k=function(P,Y){return Object.defineProperty(String.prototype,P,Ae(Y))};k("fromBase64",function(){return j(this)}),k("toBase64",function(P){return M(this,P)}),k("toBase64URI",function(){return M(this,!0)}),k("toBase64URL",function(){return M(this,!0)}),k("toUint8Array",function(){return R(this)})},wt=function(){var k=function(P,Y){return Object.defineProperty(Uint8Array.prototype,P,Ae(Y))};k("toBase64",function(P){return p(this,P)}),k("toBase64URI",function(){return p(this,!0)}),k("toBase64URL",function(){return p(this,!0)})},pn=function(){yt(),wt()},xe={version:n,VERSION:r,atob:U,atobPolyfill:T,btoa:u,btoaPolyfill:d,fromBase64:j,toBase64:M,encode:M,encodeURI:_,encodeURL:_,utob:x,btou:I,decode:j,isValid:J,fromUint8Array:p,toUint8Array:R,extendString:yt,extendUint8Array:wt,extendBuiltins:pn};return xe.Base64={},Object.keys(xe).forEach(function(k){return xe.Base64[k]=xe[k]}),xe})})(Ne)),Ne.exports}var it,jt;function Po(){if(jt)return it;jt=1;const e=wo(),t=So.data,n=Ao.data,r=Eo.data,o=To(),s=Mo().Base64,l=new o(s.toUint8Array(t)),i=new o(s.toUint8Array(n)),h=new o(s.toUint8Array(r));function c(a,m){return(a&m)!==0}function f(a,m,v){const b=m.length;for(let d=v;d+1<b;d++){const u=m[d+0],g=m[d+1];switch(a.gb9c){case 0:c(u,e.InCB_Consonant)&&(a.gb9c=1);break;case 1:c(u,e.InCB_Extend)?a.gb9c=1:c(u,e.InCB_Linker)?a.gb9c=2:a.gb9c=c(u,e.InCB_Consonant)?1:0;break;case 2:c(u,e.InCB_Extend|e.InCB_Linker)?a.gb9c=2:a.gb9c=c(u,e.InCB_Consonant)?1:0;break}switch(a.gb11){case 0:c(u,e.Extended_Pictographic)&&(a.gb11=1);break;case 1:c(u,e.Extend)?a.gb11=1:c(u,e.ZWJ)?a.gb11=2:a.gb11=c(u,e.Extended_Pictographic)?1:0;break;case 2:a.gb11=c(u,e.Extended_Pictographic)?1:0;break}switch(a.gb12){case 0:c(u,e.Regional_Indicator)?a.gb12=1:a.gb12=-1;break;case 1:c(u,e.Regional_Indicator)?a.gb12=0:a.gb12=-1;break}switch(a.gb13){case 0:c(u,e.Regional_Indicator)||(a.gb13=1);break;case 1:c(u,e.Regional_Indicator)?a.gb13=2:a.gb13=1;break;case 2:a.gb13=1;break}if(!(c(u,e.CR)&&c(g,e.LF))){if(c(u,e.Control|e.CR|e.LF)||c(g,e.Control|e.CR|e.LF))return d+1-v;if(!(c(u,e.L)&&c(g,e.L|e.V|e.LV|e.LVT))&&!(c(u,e.LV|e.V)&&c(g,e.V|e.T))&&!(c(u,e.LVT|e.T)&&c(g,e.T))&&!c(g,e.Extend|e.ZWJ)&&!c(g,e.SpacingMark)&&!c(u,e.Prepend)&&!(c(g,e.InCB_Consonant)&&a.gb9c===2)&&!(c(g,e.Extended_Pictographic)&&a.gb11===2)&&!(c(g,e.Regional_Indicator)&&a.gb12===1)&&!(c(g,e.Regional_Indicator)&&a.gb13===2))return d+1-v}}return b-v}return it=function(m){const v=[],b=[0],d=[];for(let g=0;g<m.length;){const p=m.codePointAt(g);d.push(l.get(p)|i.get(p)|h.get(p)),g+=p>65535?2:1,b.push(g)}const u={gb9c:0,gb11:0,gb12:0,gb13:0};for(let g=0;g<d.length;){const p=f(u,d,g),E=b[g],A=b[g+p];v.push(m.slice(E,A)),g+=p}return v},it}var Oo=Po();const Bo=yo(Oo),Do=e=>e.normalize("NFKD").split(""),zt=/^\s+$/,Vt=/^[`~!@#$%^&*()\-=_+{}[\]\|\\;':",./<>?]+$/,_t={insertOrder:"insertOrder",bestMatch:"bestMatch"},Uo={keySelector:e=>e,threshold:.6,ignoreCase:!0,ignoreSymbols:!0,normalizeWhitespace:!0,returnMatchData:!1,useDamerau:!0,useSellers:!0,useSeparatedUnicode:!1,sortBy:_t.bestMatch},No=()=>{},qo=e=>e instanceof Array?e:[e];function hn(e,t){const n=t.ignoreCase?e.toLocaleLowerCase():e,r=[],o=[];let s=!0,l=0;const i=t.useSeparatedUnicode?Do(n):Bo(n);for(const h of i)zt.lastIndex=0,Vt.lastIndex=0,t.normalizeWhitespace&&zt.test(h)?s||(r.push(" "),o.push(l),s=!0):t.ignoreSymbols&&Vt.test(h)||(t.useSeparatedUnicode?r.push(h):r.push(h.normalize()),o.push(l),s=!1),l+=h.length;for(o.push(e.length);r[r.length-1]===" ";)r.pop(),o.pop();return{original:e,normal:r,map:o}}function Fo(e,t){return{index:t[e.start],length:t[e.end+1]-t[e.start]}}function bn(e,t){if(t===0)return{index:0,length:0};let n=t;for(let r=e.length-2;r>0&&n>1;r--){const o=e[r];n=o[n]<o[n-1]?n:n-1}return{start:n-1,end:t-1}}function Ho(){return{start:0,end:0}}const jo=()=>!0,zo=(e,t)=>e<t;function Vo(e,t){const n=new Array(e);for(let r=0;r<e;r++)n[r]=new Array(t),n[r][0]=r;for(let r=0;r<t;r++)n[0][r]=r;return n}function Wo(e,t){const n=new Array(e);n[0]=new Array(t).fill(0);for(let r=1;r<e;r++)n[r]=new Array(t),n[r][0]=r;return n}function gn(e,t,n,r,o){const s=n[r],l=n[r+1],i=e[r]===t[o]?0:1;let h,c=l[o]+1;(h=s[o+1]+1)<c&&(c=h),(h=s[o]+i)<c&&(c=h),l[o+1]=c}function mn(e,t,n,r){for(let o=0;o<e.length;o++)gn(e,t,n,o,r)}function Xo(e,t,n,r){if(r===0){mn(e,t,n,r);return}e.length>0&&gn(e,t,n,0,r);for(let o=1;o<e.length;o++){const s=n[o-1],l=n[o],i=n[o+1],h=e[o]===t[r]?0:1;let c,f=i[r]+1;(c=l[r+1]+1)<f&&(f=c),(c=l[r]+h)<f&&(f=c),e[o]===t[r-1]&&e[o-1]===t[r]&&(c=s[r-1]+h)<f&&(f=c),i[r+1]=f}}function Ko(e,t,n){let r=e;for(let o=0;o<t.length;o++){const s=t[o];r.children[s]==null&&(r.children[s]={children:{},candidates:[],depth:0}),r.depth=Math.max(r.depth,t.length-o),r=r.children[s]}r.candidates.push(n)}function Wt(e,t,n,r){for(const o of n){const s=qo(r.keySelector(o)).map((l,i)=>({index:t,keyIndex:i,item:o,normalized:hn(l,r)}));t++;for(const l of s)Ko(e,l.normalized.normal,l)}}function Yo(e,t){const n=t.score-e.score;if(n!==0)return n;const r=e.match.start-t.match.start;if(r!==0)return r;const o=e.keyIndex-t.keyIndex;if(o!==0)return o;const s=e.lengthDiff-t.lengthDiff;return s!==0?s:vn(e,t)}function vn(e,t){return e.index-t.index}function Zo(e){switch(e){case _t.bestMatch:return Yo;case _t.insertOrder:return vn;default:throw new Error(`unknown sortBy method ${e}`)}}function _n(e,t,n,r,o,s,l){const i={item:n.item,normalized:n.normalized,score:r,match:o,index:n.index,keyIndex:n.keyIndex,lengthDiff:s};t[n.index]==null?(t[n.index]=e.length,e.push(i)):l(i,e[t[n.index]])<0&&(e[t[n.index]]=i)}const Go=Math.max,Jo=e=>e;function Qo(e,t,n,r,o){const s=t+o,l=Math.min(n.length,t+e.depth+1),i=Math.ceil((s+l)/2);return 1-(i-l)/i>=r}function Co(e,t,n,r,o,s){return 1-Math.min(o,s-(e.depth+1))/n.length>=r}function es(e,t,n,r,o,s,l){const i=[];for(const c in e.children){const f=e.children[c];i.push([f,1,c,0,t.length])}const h=new Array(e.depth);for(;i.length!==0;){const[c,f,a,m,v]=i.pop();h[f-1]=a,n.score(t,h,r,f-1);const b=f,d=r[r.length-1][b];let u=m,g=v;if(n.shouldUpdateScore(d,v)&&(u=b,g=d),c.candidates.length>0){const p=n.getLength(t.length,f),E=1-g/p;if(E>=l.threshold){const A=bn(r,u),x=Math.abs(f-t.length);for(const O of c.candidates)_n(o,s,O,E,A,x,n.compareItems)}}for(const p in c.children){const E=c.children[p];n.shouldContinue(E,f,t,l.threshold,g,d)&&i.push([E,f+1,p,u,g])}}}function ts(e,t,n){const r=n.useSellers?Wo:Vo,o={score:n.useDamerau?Xo:mn,getLength:n.useSellers?Jo:Go,shouldUpdateScore:n.useSellers?zo:jo,shouldContinue:n.useSellers?Co:Qo,walkBack:n.useSellers?bn:Ho,compareItems:Zo(n.sortBy)},s={},l=[],i=r(e.length+1,t.depth+1);if(n.threshold<=0||e.length===0)for(const c of t.candidates)_n(l,s,c,0,{index:0,length:0},e.length,o.compareItems);es(t,e,o,i,l,s,n);const h=l.sort(o.compareItems);if(n.returnMatchData){const c=n.useSellers?Fo:No;return h.map(f=>({item:f.item,original:f.normalized.original,key:f.normalized.normal.join(""),score:f.score,match:c(f.match,f.normalized.map)}))}return h.map(c=>c.item)}class ns{constructor(t,n){this.options=Object.assign({},Uo,n),this.trie={children:{},candidates:[],depth:0},Wt(this.trie,0,t,this.options),this.count=t.length}add(...t){Wt(this.trie,this.count,t,this.options),this.count+=t.length}search(t,n){return n=Object.assign({},this.options,n),ts(hn(t,this.options).normal,this.trie,n)}}var rs=L('<div class="flex flex-col gap-2 p-2"><div class="flex flex-row gap-2"><div class="border rounded cursor-pointer px-2">CLEAR INV</div><div class="border rounded cursor-pointer px-2">CLEAR MARKERS</div></div><input type=text placeholder="item search"class="border border-black">'),os=L("<div class=cursor-pointer>BACK"),ss=L('<div class="flex flex-row gap-2 mt-5"><div class=font-bold></div> - <div class="border rounded cursor-pointer px-2">1</div><div class="border rounded cursor-pointer px-2">10</div><div class="border rounded cursor-pointer px-2">100'),ls=L('<div class="w-128 h-128 absolute bg-white top-0 left-0 p-2 text-black">'),is=L('<div class="hover:bg-blue-200 cursor-pointer">');const as=new ns(Object.keys(X)),cs=()=>{const e=N(he),t=N(Q),[n,r]=q(),[o,s]=q(),l=(f=1)=>{const a=o();a&&(e==null||e.addInventory(a,f))},i=f=>{const a=as.search(f);r(a)},h=()=>{e==null||e.inventory().filter(Boolean).forEach(f=>e.removeInventory(f.name,f.count))},c=()=>{t==null||t.setState("markers",[])};return(()=>{var f=ls();return w(f,y(H,{get when(){return!o()},get children(){var a=rs(),m=a.firstChild,v=m.firstChild,b=v.nextSibling,d=m.nextSibling;return v.$$click=()=>h(),b.$$click=()=>c(),d.addEventListener("keypress",u=>i(u.target.value)),w(a,y(te,{get each(){return n()??[]},children:u=>(()=>{var g=is();return g.$$click=()=>s(u),w(g,u),g})()}),null),a}}),null),w(f,y(H,{get when(){return o()},get children(){return[(()=>{var a=os();return a.$$click=()=>s(void 0),a})(),(()=>{var a=ss(),m=a.firstChild,v=m.nextSibling,b=v.nextSibling,d=b.nextSibling,u=d.nextSibling;return w(m,o),b.$$click=()=>l(1),d.$$click=()=>l(10),u.$$click=()=>l(100),a})()]}}),null),f})()};ce(["click"]);var us=L('<div class="w-dvw h-dvh lg:w-[360px] lg:h-[800px] flex flex-col justify-between relative"><div class="h-3/10 bg-gray-400"><div class=h-1/10></div><div class=h-9/10></div></div><div></div><div class=bg-gray-800>'),fs=L("<div>Unknown view"),ds=L('<div class="h-1/10 w-full flex flex-row justify-between font-bold">'),hs=L('<div class="flex flex-col gap-2 p-1 h-full"><div class="bg-black text-left pl-1"></div><div class="text-black whitespace-pre-wrap text-left overflow-y-auto text-sm">'),bs=L('<div class="h-full bg-white flex flex-row"><div class="text-black bottom-0 left-0 border border-gray-100 p-1 flex flex-col gap-1 bg-white"><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide bad"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide good"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide meta"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide drop"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide basic"></div></div><div class="text-black h-full overflow-y-auto flex flex-col w-full">'),gs=L('<div class="flex flex-row items-center px-1 transition-colors duration-500 border-t border-gray-200"><div class="text-xs text-blue-400 mr-1">[<!>]</div><div class="text-wrap text-xs text-left">'),ms=L('<div class="flex flex-row bg-black px-1 justify-between"><div class=text-red-500>HP <!>/</div><div class=text-yellow-500>Gold </div><div class=text-white>Age </div><div class=text-green-500>Lvl <!> (<!>%)'),vs=L('<div class="content-center w-1/4 border border-l-0 cursor-pointer last:border-r-0">');const _s=()=>y(gr,{get children(){return[y(ps,{}),y(H,{when:Tn,get children(){return y(cs,{})}})]}}),ps=()=>{const[e,t]=q("story"),n=N(_e),r=D(()=>{var s;return e()==="story"&&((s=n==null?void 0:n.story())==null?void 0:s.name)==="story_stash_1"?"stash":e()}),o=D(()=>{var s;return r()==="story"&&((s=n==null?void 0:n.story())==null?void 0:s.type)==="encounter"});return(()=>{var s=us(),l=s.firstChild,i=l.firstChild,h=i.nextSibling,c=l.nextSibling,f=c.nextSibling;return w(i,y(Ss,{})),w(h,y(ws,{})),w(c,y($s,{get view(){return r()}})),w(f,y(Pe,{get fallback(){return fs()},get children(){return[y(K,{get when(){return r()==="story"},get children(){return y(Sr,{})}}),y(K,{get when(){return r()==="stash"},get children(){return y(vo,{})}}),y(K,{get when(){return r()==="invent"},get children(){return y(Or,{})}}),y(K,{get when(){return r()==="skills"},get children(){return y(jr,{})}}),y(K,{get when(){return r()==="stats"},get children(){return y(ho,{})}}),y(K,{get when(){return r()==="menu"},get children(){return y(po,{})}})]}})),w(s,y(ys,{onChange:t,get view(){return e()}}),null),Z(a=>{var m=!o(),v=!!o(),b=!!o(),d=!o();return m!==a.e&&c.classList.toggle("h-1/10",a.e=m),v!==a.t&&c.classList.toggle("h-4/10",a.t=v),b!==a.a&&f.classList.toggle("h-2/10",a.a=b),d!==a.o&&f.classList.toggle("h-5/10",a.o=d),a},{e:void 0,t:void 0,a:void 0,o:void 0}),s})()},ys=e=>(()=>{var t=ds();return w(t,y(Ee,{label:"Story",onClick:()=>e.onChange("story"),get view(){return e.view},type:"story"}),null),w(t,y(Ee,{label:"Invent",onClick:()=>e.onChange("invent"),get view(){return e.view},type:"invent"}),null),w(t,y(Ee,{label:"Skills",onClick:()=>e.onChange("skills"),get view(){return e.view},type:"skills"}),null),w(t,y(Ee,{label:"Stats",onClick:()=>e.onChange("stats"),get view(){return e.view},type:"stats"}),null),w(t,y(Ee,{label:"Menu",onClick:()=>e.onChange("menu"),get view(){return e.view},type:"menu"}),null),t})(),ws=()=>{const e=N(_e);return y(Pe,{get children(){return[y(K,{get when(){var t;return((t=e==null?void 0:e.story())==null?void 0:t.type)==="dialogue"},get children(){var t=hs(),n=t.firstChild,r=n.nextSibling;return w(n,()=>{var o;return((o=e==null?void 0:e.story())==null?void 0:o.label)??"Story"}),w(r,()=>{var o;return(o=e==null?void 0:e.story())==null?void 0:o.description}),t}}),y(K,{get when(){var t;return((t=e==null?void 0:e.story())==null?void 0:t.type)==="encounter"},get children(){return y(Qr,{})}}),y(K,{get when(){var t;return((t=e==null?void 0:e.story())==null?void 0:t.type)==="task"},get children(){return y(oo,{})}})]}})},$s=e=>{const[t,n]=q(),r=N(Q);me(i=>{const h=t();return h&&i!==e.view&&e.view!=="story"&&setTimeout(()=>h.scrollTo(0,h.scrollHeight??0)),i},e.view);const[o,s]=ht({good:!0,bad:!0,meta:!0,drop:!0,basic:!0}),l=D(()=>{const i=t();if(!i)return;const h=i.scrollTop+i.clientHeight>i.scrollHeight-10;return setTimeout(()=>h&&i.scrollTo(0,i.scrollHeight??0)),r==null?void 0:r.log().filter(c=>o[c.type])});return(()=>{var i=bs(),h=i.firstChild,c=h.firstChild,f=c.nextSibling,a=f.nextSibling,m=a.nextSibling,v=m.nextSibling,b=h.nextSibling;return c.$$click=()=>s("bad",!o.bad),f.$$click=()=>s("good",!o.good),a.$$click=()=>s("meta",!o.meta),m.$$click=()=>s("drop",!o.drop),v.$$click=()=>s("basic",!o.basic),Bn(n,b),w(b,y(te,{get each(){return l()},children:d=>(()=>{var u=gs(),g=u.firstChild,p=g.firstChild,E=p.nextSibling;E.nextSibling;var A=g.nextSibling;return w(g,()=>d.time,E),w(A,()=>d.msg),Z(x=>tn(u,{"last:bg-red-500 last:text-white bg-red-200":d.type==="bad","last:bg-green-500 last:text-white bg-green-200":d.type==="good","last:bg-yellow-500 bg-yellow-200":d.type==="meta","last:bg-blue-500 last:text-white bg-blue-200":d.type==="drop"},x)),u})()})),Z(d=>{var u=!o.bad,g=!!o.bad,p=!o.good,E=!!o.good,A=!o.meta,x=!!o.meta,O=!o.drop,M=!!o.drop,_=!o.basic,$=!!o.basic;return u!==d.e&&c.classList.toggle("bg-red-100",d.e=u),g!==d.t&&c.classList.toggle("bg-red-500",d.t=g),p!==d.a&&f.classList.toggle("bg-green-100",d.a=p),E!==d.o&&f.classList.toggle("bg-green-500",d.o=E),A!==d.i&&a.classList.toggle("bg-yellow-100",d.i=A),x!==d.n&&a.classList.toggle("bg-yellow-500",d.n=x),O!==d.s&&m.classList.toggle("bg-blue-100",d.s=O),M!==d.h&&m.classList.toggle("bg-blue-500",d.h=M),_!==d.r&&v.classList.toggle("bg-gray-100",d.r=_),$!==d.d&&v.classList.toggle("bg-gray-500",d.d=$),d},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},Ss=()=>{const e=N(ue),t=N(Q);return(()=>{var n=ms(),r=n.firstChild,o=r.firstChild,s=o.nextSibling;s.nextSibling;var l=r.nextSibling;l.firstChild;var i=l.nextSibling;i.firstChild;var h=i.nextSibling,c=h.firstChild,f=c.nextSibling,a=f.nextSibling,m=a.nextSibling;return m.nextSibling,w(r,()=>e==null?void 0:e.player.stats.health,s),w(r,()=>e==null?void 0:e.player.stats.maxHealth,null),w(l,()=>e==null?void 0:e.player.stats.gold,null),w(i,()=>t==null?void 0:t.year(),null),w(h,()=>fe((e==null?void 0:e.player.stats.experience)??0),f),w(h,()=>(bt((e==null?void 0:e.player.stats.experience)??0)*100).toFixed(0),m),n})()},Ee=e=>(()=>{var t=vs();return Qe(t,"click",e.onClick),w(t,()=>e.label),Z(n=>tn(t,{"border-t-0 bg-gray-800":e.view===e.type},n)),t})();ce(["click"]);const ks=document.getElementById("root");Mn(()=>y(_s,{}),ks);
