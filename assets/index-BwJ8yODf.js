var xt=Object.defineProperty;var Ct=(e,t,n)=>t in e?xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var I=(e,t,n)=>Ct(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const At=!1,Lt=(e,t)=>e===t,re=Symbol("solid-proxy"),De=Symbol("solid-track"),Se={equals:Lt};let tt=ot;const ne=1,ke=2,nt={owned:null,cleanups:null,context:null,owner:null};var j=null;let Pe=null,Et=null,q=null,F=null,te=null,Ie=0;function $e(e,t){const n=q,l=j,r=e.length===0,s=t===void 0?l:t,i=r?nt:{owned:null,cleanups:null,context:s?s.context:null,owner:s},a=r?e:()=>e(()=>J(()=>ye(i)));j=i,q=null;try{return ce(a,!0)}finally{q=n,j=l}}function O(e,t){t=t?Object.assign({},Se,t):Se;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},l=r=>(typeof r=="function"&&(r=r(n.value)),it(n,r));return[at.bind(n),l]}function Y(e,t,n){const l=Ke(e,t,!1,ne);_e(l)}function xe(e,t,n){tt=It;const l=Ke(e,t,!1,ne);l.user=!0,te?te.push(l):_e(l)}function T(e,t,n){n=n?Object.assign({},Se,n):Se;const l=Ke(e,t,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=n.equals||void 0,_e(l),at.bind(l)}function lt(e){return ce(e,!1)}function J(e){if(q===null)return e();const t=q;q=null;try{return e()}finally{q=t}}function ve(e){xe(()=>J(e))}function je(e){return j===null||(j.cleanups===null?j.cleanups=[e]:j.cleanups.push(e)),e}function Re(){return q}function rt(e,t){const n=Symbol("context");return{id:n,Provider:Ot(n),defaultValue:e}}function W(e){let t;return j&&j.context&&(t=j.context[e.id])!==void 0?t:e.defaultValue}function st(e){const t=T(e),n=T(()=>Ne(t()));return n.toArray=()=>{const l=n();return Array.isArray(l)?l:l!=null?[l]:[]},n}function at(){if(this.sources&&this.state)if(this.state===ne)_e(this);else{const e=F;F=null,ce(()=>Ae(this),!1),F=e}if(q){const e=this.observers?this.observers.length:0;q.sources?(q.sources.push(this),q.sourceSlots.push(e)):(q.sources=[this],q.sourceSlots=[e]),this.observers?(this.observers.push(q),this.observerSlots.push(q.sources.length-1)):(this.observers=[q],this.observerSlots=[q.sources.length-1])}return this.value}function it(e,t,n){let l=e.value;return(!e.comparator||!e.comparator(l,t))&&(e.value=t,e.observers&&e.observers.length&&ce(()=>{for(let r=0;r<e.observers.length;r+=1){const s=e.observers[r],i=Pe&&Pe.running;i&&Pe.disposed.has(s),(i?!s.tState:!s.state)&&(s.pure?F.push(s):te.push(s),s.observers&&ct(s)),i||(s.state=ne)}if(F.length>1e6)throw F=[],new Error},!1)),t}function _e(e){if(!e.fn)return;ye(e);const t=Ie;Mt(e,e.value,t)}function Mt(e,t,n){let l;const r=j,s=q;q=j=e;try{l=e.fn(t)}catch(i){return e.pure&&(e.state=ne,e.owned&&e.owned.forEach(ye),e.owned=null),e.updatedAt=n+1,ut(i)}finally{q=s,j=r}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?it(e,l):e.value=l,e.updatedAt=n)}function Ke(e,t,n,l=ne,r){const s={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:j,context:j?j.context:null,pure:n};return j===null||j!==nt&&(j.owned?j.owned.push(s):j.owned=[s]),s}function Ce(e){if(e.state===0)return;if(e.state===ke)return Ae(e);if(e.suspense&&J(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Ie);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===ne)_e(e);else if(e.state===ke){const l=F;F=null,ce(()=>Ae(e,t[0]),!1),F=l}}function ce(e,t){if(F)return e();let n=!1;t||(F=[]),te?n=!0:te=[],Ie++;try{const l=e();return Tt(n),l}catch(l){n||(te=null),F=null,ut(l)}}function Tt(e){if(F&&(ot(F),F=null),e)return;const t=te;te=null,t.length&&ce(()=>tt(t),!1)}function ot(e){for(let t=0;t<e.length;t++)Ce(e[t])}function It(e){let t,n=0;for(t=0;t<e.length;t++){const l=e[t];l.user?e[n++]=l:Ce(l)}for(t=0;t<n;t++)Ce(e[t])}function Ae(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const l=e.sources[n];if(l.sources){const r=l.state;r===ne?l!==t&&(!l.updatedAt||l.updatedAt<Ie)&&Ce(l):r===ke&&Ae(l,t)}}}function ct(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=ke,n.pure?F.push(n):te.push(n),n.observers&&ct(n))}}function ye(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),l=e.sourceSlots.pop(),r=n.observers;if(r&&r.length){const s=r.pop(),i=n.observerSlots.pop();l<r.length&&(s.sourceSlots[i]=l,r[l]=s,n.observerSlots[l]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)ye(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)ye(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function jt(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ut(e,t=j){throw jt(e)}function Ne(e){if(typeof e=="function"&&!e.length)return Ne(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const l=Ne(e[n]);Array.isArray(l)?t.push.apply(t,l):t.push(l)}return t}return e}function Ot(e,t){return function(l){let r;return Y(()=>r=J(()=>(j.context={...j.context,[e]:l.value},st(()=>l.children))),void 0),r}}const qt=Symbol("fallback");function Xe(e){for(let t=0;t<e.length;t++)e[t]()}function Pt(e,t,n={}){let l=[],r=[],s=[],i=0,a=t.length>1?[]:null;return je(()=>Xe(s)),()=>{let o=e()||[],f=o.length,c,u;return o[De],J(()=>{let b,m,_,$,k,S,x,A,L;if(f===0)i!==0&&(Xe(s),s=[],l=[],r=[],i=0,a&&(a=[])),n.fallback&&(l=[qt],r[0]=$e(N=>(s[0]=N,n.fallback())),i=1);else if(i===0){for(r=new Array(f),u=0;u<f;u++)l[u]=o[u],r[u]=$e(p);i=f}else{for(_=new Array(f),$=new Array(f),a&&(k=new Array(f)),S=0,x=Math.min(i,f);S<x&&l[S]===o[S];S++);for(x=i-1,A=f-1;x>=S&&A>=S&&l[x]===o[A];x--,A--)_[A]=r[x],$[A]=s[x],a&&(k[A]=a[x]);for(b=new Map,m=new Array(A+1),u=A;u>=S;u--)L=o[u],c=b.get(L),m[u]=c===void 0?-1:c,b.set(L,u);for(c=S;c<=x;c++)L=l[c],u=b.get(L),u!==void 0&&u!==-1?(_[u]=r[c],$[u]=s[c],a&&(k[u]=a[c]),u=m[u],b.set(L,u)):s[c]();for(u=S;u<f;u++)u in _?(r[u]=_[u],s[u]=$[u],a&&(a[u]=k[u],a[u](u))):r[u]=$e(p);r=r.slice(0,i=f),l=o.slice(0)}return r});function p(b){if(s[u]=b,a){const[m,_]=O(u);return a[u]=_,t(o[u],m)}return t(o[u])}}}function d(e,t){return J(()=>e(t||{}))}const ft=e=>`Stale read from <${e}>.`;function Z(e){const t="fallback"in e&&{fallback:()=>e.fallback};return T(Pt(()=>e.each,e.children,t||void 0))}function P(e){const t=e.keyed,n=T(()=>e.when,void 0,void 0),l=t?n:T(n,void 0,{equals:(r,s)=>!r==!s});return T(()=>{const r=l();if(r){const s=e.children;return typeof s=="function"&&s.length>0?J(()=>s(t?r:()=>{if(!J(l))throw ft("Show");return n()})):s}return e.fallback},void 0,void 0)}function we(e){const t=st(()=>e.children),n=T(()=>{const l=t(),r=Array.isArray(l)?l:[l];let s=()=>{};for(let i=0;i<r.length;i++){const a=i,o=r[i],f=s,c=T(()=>f()?void 0:o.when,void 0,void 0),u=o.keyed?c:T(c,void 0,{equals:(p,b)=>!p==!b});s=()=>f()||(u()?[a,c,o]:void 0)}return s});return T(()=>{const l=n()();if(!l)return e.fallback;const[r,s,i]=l,a=i.children;return typeof a=="function"&&a.length>0?J(()=>a(i.keyed?s():()=>{var f;if(((f=J(n)())==null?void 0:f[0])!==r)throw ft("Match");return s()})):a},void 0,void 0)}function H(e){return e}const Q=e=>T(()=>e());function Dt(e,t,n){let l=n.length,r=t.length,s=l,i=0,a=0,o=t[r-1].nextSibling,f=null;for(;i<r||a<s;){if(t[i]===n[a]){i++,a++;continue}for(;t[r-1]===n[s-1];)r--,s--;if(r===i){const c=s<l?a?n[a-1].nextSibling:n[s-a]:o;for(;a<s;)e.insertBefore(n[a++],c)}else if(s===a)for(;i<r;)(!f||!f.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[s-1]&&n[a]===t[r-1]){const c=t[--r].nextSibling;e.insertBefore(n[a++],t[i++].nextSibling),e.insertBefore(n[--s],c),t[r]=n[s]}else{if(!f){f=new Map;let u=a;for(;u<s;)f.set(n[u],u++)}const c=f.get(t[i]);if(c!=null)if(a<c&&c<s){let u=i,p=1,b;for(;++u<r&&u<s&&!((b=f.get(t[u]))==null||b!==c+p);)p++;if(p>c-a){const m=t[i];for(;a<c;)e.insertBefore(n[a++],m)}else e.replaceChild(n[a++],t[i++])}else i++;else t[i++].remove()}}}const Ge="_$DX_DELEGATE";function Rt(e,t,n,l={}){let r;return $e(s=>{r=s,t===document?e():h(t,e(),t.firstChild?null:void 0,n)},l.owner),()=>{r(),t.textContent=""}}function v(e,t,n,l){let r;const s=()=>{const a=document.createElement("template");return a.innerHTML=e,a.content.firstChild},i=()=>(r||(r=s())).cloneNode(!0);return i.cloneNode=i,i}function le(e,t=window.document){const n=t[Ge]||(t[Ge]=new Set);for(let l=0,r=e.length;l<r;l++){const s=e[l];n.has(s)||(n.add(s),t.addEventListener(s,Ft))}}function Nt(e,t){t==null?e.removeAttribute("class"):e.className=t}function Oe(e,t,n,l){Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n}function dt(e,t,n={}){const l=Object.keys(t||{}),r=Object.keys(n);let s,i;for(s=0,i=r.length;s<i;s++){const a=r[s];!a||a==="undefined"||t[a]||(ze(e,a,!1),delete n[a])}for(s=0,i=l.length;s<i;s++){const a=l[s],o=!!t[a];!a||a==="undefined"||n[a]===o||!o||(ze(e,a,!0),n[a]=o)}return n}function Ht(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function Bt(e,t,n){return J(()=>e(t,n))}function h(e,t,n,l){if(n!==void 0&&!l&&(l=[]),typeof t!="function")return Le(e,t,l,n);Y(r=>Le(e,t(),r,n),l)}function ze(e,t,n){const l=t.trim().split(/\s+/);for(let r=0,s=l.length;r<s;r++)e.classList.toggle(l[r],n)}function Ft(e){let t=e.target;const n=`$$${e.type}`,l=e.target,r=e.currentTarget,s=o=>Object.defineProperty(e,"target",{configurable:!0,value:o}),i=()=>{const o=t[n];if(o&&!t.disabled){const f=t[`${n}Data`];if(f!==void 0?o.call(t,f,e):o.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&s(t.host),!0},a=()=>{for(;i()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const o=e.composedPath();s(o[0]);for(let f=0;f<o.length-2&&(t=o[f],!!i());f++){if(t._$host){t=t._$host,a();break}if(t.parentNode===r)break}}else a();s(l)}function Le(e,t,n,l,r){for(;typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,i=l!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,s==="string"||s==="number"){if(s==="number"&&(t=t.toString(),t===n))return n;if(i){let a=n[0];a&&a.nodeType===3?a.data!==t&&(a.data=t):a=document.createTextNode(t),n=ae(e,n,l,a)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||s==="boolean")n=ae(e,n,l);else{if(s==="function")return Y(()=>{let a=t();for(;typeof a=="function";)a=a();n=Le(e,a,n,l)}),()=>n;if(Array.isArray(t)){const a=[],o=n&&Array.isArray(n);if(He(a,t,n,r))return Y(()=>n=Le(e,a,n,l,!0)),()=>n;if(a.length===0){if(n=ae(e,n,l),i)return n}else o?n.length===0?Je(e,a,l):Dt(e,n,a):(n&&ae(e),Je(e,a));n=a}else if(t.nodeType){if(Array.isArray(n)){if(i)return n=ae(e,n,l,t);ae(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function He(e,t,n,l){let r=!1;for(let s=0,i=t.length;s<i;s++){let a=t[s],o=n&&n[e.length],f;if(!(a==null||a===!0||a===!1))if((f=typeof a)=="object"&&a.nodeType)e.push(a);else if(Array.isArray(a))r=He(e,a,o)||r;else if(f==="function")if(l){for(;typeof a=="function";)a=a();r=He(e,Array.isArray(a)?a:[a],Array.isArray(o)?o:[o])||r}else e.push(a),r=!0;else{const c=String(a);o&&o.nodeType===3&&o.data===c?e.push(o):e.push(document.createTextNode(c))}}return r}function Je(e,t,n=null){for(let l=0,r=t.length;l<r;l++)e.insertBefore(t[l],n)}function ae(e,t,n,l){if(n===void 0)return e.textContent="";const r=l||document.createTextNode("");if(t.length){let s=!1;for(let i=t.length-1;i>=0;i--){const a=t[i];if(r!==a){const o=a.parentNode===e;!s&&!i?o?e.replaceChild(r,a):e.insertBefore(r,n):o&&a.remove()}else s=!0}}else e.insertBefore(r,n);return[r]}const Be=Symbol("store-raw"),oe=Symbol("store-node"),ee=Symbol("store-has"),ht=Symbol("store-self");function gt(e){let t=e[re];if(!t&&(Object.defineProperty(e,re,{value:t=new Proxy(e,Wt)}),!Array.isArray(e))){const n=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let r=0,s=n.length;r<s;r++){const i=n[r];l[i].get&&Object.defineProperty(e,i,{enumerable:l[i].enumerable,get:l[i].get.bind(t)})}}return t}function Ee(e){let t;return e!=null&&typeof e=="object"&&(e[re]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function se(e,t=new Set){let n,l,r,s;if(n=e!=null&&e[Be])return n;if(!Ee(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,a=e.length;i<a;i++)r=e[i],(l=se(r,t))!==r&&(e[i]=l)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),a=Object.getOwnPropertyDescriptors(e);for(let o=0,f=i.length;o<f;o++)s=i[o],!a[s].get&&(r=e[s],(l=se(r,t))!==r&&(e[s]=l))}return e}function Me(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function pe(e,t,n){if(e[t])return e[t];const[l,r]=O(n,{equals:!1,internal:!0});return l.$=r,e[t]=l}function Vt(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===re||t===oe||(delete n.value,delete n.writable,n.get=()=>e[re][t]),n}function yt(e){Re()&&pe(Me(e,oe),ht)()}function Ut(e){return yt(e),Reflect.ownKeys(e)}const Wt={get(e,t,n){if(t===Be)return e;if(t===re)return n;if(t===De)return yt(e),n;const l=Me(e,oe),r=l[t];let s=r?r():e[t];if(t===oe||t===ee||t==="__proto__")return s;if(!r){const i=Object.getOwnPropertyDescriptor(e,t);Re()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(i&&i.get)&&(s=pe(l,t,s)())}return Ee(s)?gt(s):s},has(e,t){return t===Be||t===re||t===De||t===oe||t===ee||t==="__proto__"?!0:(Re()&&pe(Me(e,ee),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Ut,getOwnPropertyDescriptor:Vt};function Te(e,t,n,l=!1){if(!l&&e[t]===n)return;const r=e[t],s=e.length;n===void 0?(delete e[t],e[ee]&&e[ee][t]&&r!==void 0&&e[ee][t].$()):(e[t]=n,e[ee]&&e[ee][t]&&r===void 0&&e[ee][t].$());let i=Me(e,oe),a;if((a=pe(i,t,r))&&a.$(()=>n),Array.isArray(e)&&e.length!==s){for(let o=e.length;o<s;o++)(a=i[o])&&a.$();(a=pe(i,"length",s))&&a.$(e.length)}(a=i[ht])&&a.$()}function pt(e,t){const n=Object.keys(t);for(let l=0;l<n.length;l+=1){const r=n[l];Te(e,r,t[r])}}function Yt(e,t){if(typeof t=="function"&&(t=t(e)),t=se(t),Array.isArray(t)){if(e===t)return;let n=0,l=t.length;for(;n<l;n++){const r=t[n];e[n]!==r&&Te(e,n,r)}Te(e,"length",l)}else pt(e,t)}function de(e,t,n=[]){let l,r=e;if(t.length>1){l=t.shift();const i=typeof l,a=Array.isArray(e);if(Array.isArray(l)){for(let o=0;o<l.length;o++)de(e,[l[o]].concat(t),n);return}else if(a&&i==="function"){for(let o=0;o<e.length;o++)l(e[o],o)&&de(e,[o].concat(t),n);return}else if(a&&i==="object"){const{from:o=0,to:f=e.length-1,by:c=1}=l;for(let u=o;u<=f;u+=c)de(e,[u].concat(t),n);return}else if(t.length>1){de(e[l],t,[l].concat(n));return}r=e[l],n=[l].concat(n)}let s=t[0];typeof s=="function"&&(s=s(r,n),s===r)||l===void 0&&s==null||(s=se(s),l===void 0||Ee(r)&&Ee(s)&&!Array.isArray(s)?pt(r,s):Te(e,l,s))}function Fe(...[e,t]){const n=se(e||{}),l=Array.isArray(n),r=gt(n);function s(...i){lt(()=>{l&&i.length===1?Yt(n,i[0]):de(n,i)})}return[r,s]}const Kt=80,Xt=20,bt=1.7,mt=20,ie=20,Ve=100,vt=500,Gt=720*60*1e3,zt=5,_t=new Array(495).fill(1).map((e,t)=>Math.floor(Kt*Math.pow(t+1,bt))),he=new Array(500).fill(1).map((e,t)=>Math.floor(Xt*Math.pow(t+1,bt))),wt=(e,t=_t)=>{if(!e)return 0;const n=t.findIndex(s=>s>e);if(n<0&&e>0)return 1;const l=e-(t[n-1]??0),r=t[n]-(t[n-1]??0);return l/r},be=(e,t=_t)=>{const n=t.findIndex(l=>l>e);return n<0&&e>0?t.length:n};var Jt=v('<div class="flex w-full absolute h-full items-center bg-main justify-center text-white text-xl top-0 left-0">Catching up... (<!>)');const qe=rt(),B=new Event("tick"),Qt=e=>{const[t,n]=O(0),[l,r]=O(!0),[s,i]=O(0),a=new EventTarget;ve(()=>{setInterval(()=>{l()||(n(t()+1),a==null||a.dispatchEvent(B))},Ve)}),document.addEventListener("visibilitychange",()=>{document.hidden?(r(!0),window.localStorage.setItem("freeze_time",`${Date.now()}`)):o()});const o=()=>{r(!0);const u=parseInt(window.localStorage.getItem("freeze_time")??`${Date.now()}`),p=Math.min(Date.now()-u,Gt);let b=Math.floor(p/Ve);i(b),f()},f=()=>{let u=s();u>0?requestIdleCallback(()=>{let p=1e3;for(;u>0&&p>0;)a==null||a.dispatchEvent(B),n(t()+1),u--,p--;i(u),u>0?f():r(!1)}):r(!1)};window.addEventListener("load",()=>setTimeout(o,200)),window.addEventListener("beforeunload",()=>{window.localStorage.setItem("freeze_time",`${Date.now()}`)});const c=()=>a==null?void 0:a.dispatchEvent(B);return d(qe.Provider,{value:{evt:a,fire:c,pause:l},get children(){return[Q(()=>e.children),d(P,{get when(){return l()},get children(){var u=Jt(),p=u.firstChild,b=p.nextSibling;return b.nextSibling,h(u,s,b),u}})]}})},Zt=[{name:"hay_hand_1",label:"Hay hand wraps",stackable:!1,equipSlot:"hand",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{attMin:1,attMax:3}},{name:"hay_head_1",label:"Hay bandana",stackable:!1,equipSlot:"head",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{maxHealth:5}},{name:"hay_chest_1",label:"Hay vest",stackable:!1,equipSlot:"chest",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",50]],stats:{physRes:1}},{name:"utility_axe_1",label:"Rusty axe",stackable:!1,equipSlot:"weapon",utilityType:"axe",stats:{}}],en=[{name:"recipe_hay_hand_1",label:"Recipe: Hay hand wraps",stackable:!1,exclusive:!0,craftableItem:"hay_hand_1"},{name:"recipe_hay_head_1",label:"Recipe: Hay bandana",stackable:!1,exclusive:!0,craftableItem:"hay_head_1"},{name:"recipe_hay_chest_1",label:"Recipe: Hay vest",stackable:!1,exclusive:!0,craftableItem:"hay_chest_1"}].map(e=>({...e,use:t=>(t.onTask({noRepeat:!0,label:"Learning",description:e.label,duration:100,onComplete:()=>(t.player.recipes.includes(e.craftableItem)||(t.setPlayer("recipes",[...t.player.recipes,e.craftableItem]),t.setState("prohibitedItems",[...t.state.prohibitedItems,e.name])),t.removeInventory(e.name),t.onNavigate("_back"),!0)}),!1)})),tn=[{name:"hay_1",label:"Hay",stackable:!0,maxStack:100},{name:"wood_log_1",label:"Wooden log",stackable:!0,maxStack:100}],nn=[{name:"wood_club_1",label:"Wooden Club",equipSlot:"weapon",craftType:"weapon",craftComplexity:1,craftLevel:1,ingredients:[["wood_log_1",15]],masteryType:"mace",stats:{attMin:2,attMax:5,attSpeed:-.1}},{name:"wood_shield_1",label:"Wooden Shield",equipSlot:"offhand",craftType:"armour",craftComplexity:1,craftLevel:1,ingredients:[["wood_log_1",20]],stats:{physRes:2,maxHealth:10}},{name:"wood_chest_1",label:"Wooden Plank Vest",equipSlot:"chest",craftType:"armour",craftComplexity:2,craftLevel:1,ingredients:[["wood_log_1",40]],stats:{physRes:3,agility:-1}},{name:"stone_axe_1",label:"Stone Axe",equipSlot:"weapon",craftType:"weapon",craftComplexity:2,craftLevel:2,ingredients:[["wood_log_1",10],["stone_1",10]],masteryType:"axe",stats:{attMin:3,attMax:8,attSpeed:-.05,strength:1}},{name:"stone_helm_1",label:"Stone Helm",equipSlot:"head",craftType:"armour",craftComplexity:2,craftLevel:2,ingredients:[["stone_1",20],["hay_1",10]],stats:{physRes:4,maxHealth:10,intelligence:-1}},{name:"copper_sword_1",label:"Copper Shortsword",equipSlot:"weapon",craftType:"weapon",craftComplexity:3,craftLevel:2,ingredients:[["copper_ingot_1",8],["wood_log_1",5]],masteryType:"sword",stats:{attMin:4,attMax:10,attSpeed:.1,dexterity:1}},{name:"copper_chest_1",label:"Copper Breastplate",equipSlot:"chest",craftType:"armour",craftComplexity:3,craftLevel:2,ingredients:[["copper_ingot_1",15]],stats:{physRes:5,magRes:1,strength:1}},{name:"iron_spear_1",label:"Iron Spear",equipSlot:"weapon",craftType:"weapon",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",12],["wood_log_1",8]],masteryType:"spear",stats:{attMin:6,attMax:14,attSpeed:0,dexterity:2}},{name:"iron_helm_1",label:"Iron Helmet",equipSlot:"head",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",8]],stats:{physRes:6,maxHealth:15,charisma:-1}},{name:"iron_boots_1",label:"Iron Greaves",equipSlot:"foot",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",6]],stats:{physRes:3,agility:-1}}],U=[Zt,en,tn,nn].flat().reduce((e,t)=>(e[t.name]=t,e),{});var ln=v('<div class="font-bold m-2">'),rn=v("<div>");const Ue=e=>(()=>{var t=ln();return h(t,d(Z,{get each(){return e.lines},children:(n,l)=>(()=>{var r=rn();return h(r,d(P,{get when(){return l()===0},children:'" .. '}),null),h(r,n,null),h(r,d(P,{get when(){return l()===e.lines.length-1},children:' .. "'}),null),r})()})),t})();var sn=v("<span class=text-red-500>Fight scarecrows"),an=v('<span class="font-bold ml-1">'),on=v('<span class="font-bold text-blue-500 mr-1">Hay'),cn=v("<span class=font-bold>");const un=[{name:"story_town_1",label:"Town",description:"You are in town",type:"dialogue",options:[{label:"Visit Farm",goto:"story_farmer_1"},{label:"Leave the town",goto:"story_forest_1"},{label:"Merchants",goto:"story_town_merchants_1"},{label:"Home",goto:"story_home_1"}]},{name:"story_farmer_1",label:"Farm",description:"A vacant expressionless farmer. Hasn't washed in days.",type:"dialogue",options:[{label:"Approach the farmer",goto:"story_farmer_2"},{label:sn(),goto:"story_scarecrows_1"},{label:"Sell Hay",action:e=>{const t=e.player.invent,{removeInventory:n,onAddStat:l}=e,r=t.filter(s=>(s==null?void 0:s.name)==="hay_1").reduce((s,i)=>s+((i==null?void 0:i.stack)??0),0);r&&(n("hay_1",r),l("gold",r),e.onLog(["You sell",(()=>{var s=an();return h(s,r),s})()," ",on(),"For ",(()=>{var s=cn();return h(s,r),s})()," gold"],"meta"))}}]},{name:"story_farmer_2",label:"Farmer",description:["You approach, he holds your wrist loosely like an exhausted child.",d(Ue,{lines:["Loathsome shadowed cloaks","Golden light shimmering, blind eyes","Fear, is Death knocking?"]}),"He sits and cries."],type:"dialogue",options:[{label:"Console",goto:"story_farmer_3"},{label:"Leave",goto:"_back"}]},{name:"story_farmer_3",label:"Farmer",description:d(Ue,{lines:["Am *I* the keeper of the wheat?","... or is it the keeper of me?"]}),type:"dialogue",options:[{label:"Silently leave",goto:"_back.2"}]},{name:"story_scarecrows_1",label:"Scarecrows",description:"Fighting scarecrows",type:"encounter",cooldown:20,encounters:[{name:"enc_scarecrow_1",label:"Scarecrow",health:10,chance:1,experience:50,drops:[{name:"hay_1",chance:1},{name:"recipe_hay_hand_1",chance:.05},{name:"recipe_hay_head_1",chance:.05},{name:"recipe_hay_chest_1",chance:.05}]}]}],fn=[{name:"furniture_bench_basic_1",label:"Basic bench",type:"craft",craftingComplexity:1,cratingType:"basic"},{name:"furniture_stash_1",label:"Basic stash",type:"stash",storageSize:5}],$t=[fn].flat().reduce((e,t)=>(e[t.name]=t,e),{});var dn=v("<div class=font-bold>Stash"),hn=v("<div>Retrieve items from stash here, place in stash from your invent");const gn=[{name:"story_home_1",label:"Home",description:"Home sweet home",type:"dialogue",options:[{label:"Build",goto:"story_home_2"},{label:"Stash",goto:"story_stash_1"},{label:"Craft",goto:"story_home_4"}]},{name:"story_stash_1",label:"Stash",type:"dialogue",description:[dn(),hn()]},{name:"story_home_4",label:"Crafting",description:"A workshop",type:"dialogue",options:e=>e.state.furniture.map(t=>$t[t]).filter(t=>t.type==="craft").map(t=>({label:t.label,goto:`story_craft_${t.cratingType}_1`}))},{name:"story_craft_basic_1",label:"Basic crafting",description:"A very simple crafting table",type:"dialogue",options:e=>e.player.recipes.map(t=>U[t]).filter(t=>t.craftType==="basic").map(t=>{var n;return{label:t.label,action:l=>{l.onTask({noRepeat:!0,label:"Crafting",description:t.label,duration:100,onComplete:()=>yn(l,t)})},isDisabled:!pn(e,t),subtext:(n=t.ingredients)==null?void 0:n.map(l=>`${U[l[0]].label} (${l[1]})`).join(" - ")}})}],yn=(e,t)=>{var n;e.addInventory(t),(n=t.ingredients)==null||n.forEach(l=>e.removeInventory(...l))},pn=(e,t)=>{var n;return(n=t.ingredients)!=null&&n.length?t.ingredients.every(l=>e.player.invent.reduce((s,i)=>((i==null?void 0:i.name)===l[0]&&(s=s+(i.stack??1)),s),0)>=l[1]):!0};var bn=v("<span class=text-red-500>Venture deeper");const mn=[{type:"dialogue",name:"story_forest_1",label:"Forest border",description:"The canopy casts a shadow. Sounds, eyes ... movement",options:e=>[{label:"Chop wood",goto:"task_chop_wood_1",isDisabled:!!!e.player.equipment.find(n=>n.equipSlot==="weapon"&&n.utilityType==="axe")},{label:bn(),goto:"story_forest_2"}]},{type:"task",name:"task_chop_wood_1",label:"Surrounded by trees",description:"Chopping wood",duration:100,masteryType:"woodcutting",cooldown:10,experience:1,utilityType:"axe",items:[{name:"wood_log_1",chance:1}]},{name:"story_forest_2",label:"Deep forest",description:"Creatures block your path...",type:"encounter",limit:5,onComplete:e=>e.onNavigate("story_forest_3"),cooldown:20,encounters:[{name:"enc_rabbit_1",label:"Little rabbit",chance:.4,experience:50,drops:[],health:5,stats:{attMin:0,attMax:1,attSpeed:10}},{name:"enc_deer_1",label:"Frightened deer",chance:.2,experience:50,drops:[],health:10,stats:{attMin:0,attMax:4,attSpeed:45}},{name:"enc_dead_tree_1",label:"Dead tree",chance:1,experience:10,health:10}]},{name:"story_forest_3",label:"welcome to the deep forest",type:"dialogue",description:"You made it!"}],vn=[{name:"utility_axe_1",cost:100}],_n=[{type:"dialogue",name:"story_town_merchants_1",label:"Town Bazaar",description:"Souks, stalls, spices, hands... hands... hands...",options:[{label:"Tool merchant",goto:"story_town_merchant_tool_1"}]},{type:"dialogue",name:"story_town_merchant_tool_1",label:"Tool Merchant",description:["A burly man, skin of leather ",d(Ue,{lines:["The very finest tools"]})],options:e=>{const t=e.player.stats.gold;return vn.map(n=>{const l=U[n.name];return{label:(l==null?void 0:l.label)??"UNKNOWN",action:r=>{r.addInventory(l),r.onAddStat("gold",0-n.cost),r.onNavigate("story_town_merchant_tool_1")},isDisabled:n.cost>t}})}}],We=[un,gn,mn,_n].flat().reduce((e,t)=>(e[t.name]=t,e),{}),wn=[{name:"unarmed",label:"Unarmed",bonus:new Array(vt+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{attMin:t%10===0?1:0,attMax:1,attSpeed:t%50===0?.1:0}}}).filter(Boolean)}],$n=[{name:"woodcutting",label:"Woodcutting",bonus:new Array(vt+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{durationModifier:t%10===0?10:0},dropModifiers:[{name:"wood_log_1",chance:t%50===0?1:0}]}}).filter(Boolean)}],ge=[wn,$n].flat().reduce((e,t)=>(e[t.name]=t,e),{}),St=(e,t)=>{const n=ge[e];if(!n)return{};const l=be(t,he),r=n.bonus.filter(s=>s.level<=l);return(r==null?void 0:r.reduce((s,i)=>(Object.entries(i.stats).forEach(([a,o])=>{s[a]=(s[a]??0)+o}),s),{}))??{}},Sn=(e,t,n)=>{const l=ge[t];if(!l)return 0;const r=be(n,he),s=l.bonus.filter(i=>i.level<=r);return s==null?void 0:s.reduce((i,a)=>{var o,f;return i+(((f=(o=a.dropModifiers)==null?void 0:o.find(c=>c.name===e))==null?void 0:f.chance)??0)},0)};let kt=class{constructor(t){I(this,"name");I(this,"label");I(this,"description");I(this,"type");I(this,"encounters");I(this,"duration");I(this,"noRepeat");I(this,"cooldown");I(this,"limit");I(this,"items");I(this,"skills");I(this,"options");I(this,"onComplete");I(this,"masteryType");I(this,"experience");I(this,"utilityType");this.label=t.label,this.type=t.type,this.name=t.name,this.description=t.description,Object.assign(this,t)}getEncounter(){var n;if(this.type==="task")return{name:"task",label:this.label,health:this.duration??0,chance:1,drops:this.items};const t=Math.random();if(!(this.type!=="encounter"||!((n=this.encounters)!=null&&n.length)))return this.encounters.sort((l,r)=>l.chance-r.chance).find(l=>t<=l.chance)}getDamage(t){const{attMin:n,attMax:l}=t.stats??{};if(!(!n||!l))return n+Math.round(Math.random()*(n-l))}getDrops(t){return this.getItems(t==null?void 0:t.drops)}getItems(t=this.items??[],n,l){let r=[];for(let s of t){let i=s.chance;for(n&&l&&(i=i+Sn(s.name,n,l));i>0;)Math.random()<=i&&r.push(s),i--}return r==null?void 0:r.map(s=>U[s.name]).filter(Boolean)}};class Qe{constructor(t={},n=new Array(mt).fill(null)){I(this,"equipment");I(this,"stats");I(this,"mastery");I(this,"invent");I(this,"recipes");this.equipment=t.equipment??[],this.mastery=t.mastery??{},this.recipes=t.recipes??[],this.stats=t.stats??{gold:120,experience:0,health:10,maxHealth:10,strength:1,agility:1,attSpeed:0},this.invent=n}weaponMastery(){var t;return((t=this.equipment.find(n=>n.equipSlot==="weapon"))==null?void 0:t.masteryType)??"unarmed"}getMasteryPerk(t){return St(t,this.mastery[t]??0)}attackDamage(){let t=this.equipment.reduce((o,f)=>{var c;return o+(((c=f.stats)==null?void 0:c.attMin)??0)},1),n=this.equipment.reduce((o,f)=>{var c;return o+(((c=f.stats)==null?void 0:c.attMax)??0)},1);const l=this.weaponMastery(),r=this.getMasteryPerk(l);t+=(r==null?void 0:r.attMin)??0,n+=(r==null?void 0:r.attMax)??0;const s=1+Math.pow((this.stats.strength??0)/100,.7),i=Math.round(t*s),a=Math.round(n*s);return[i,a]}attackRate(){const n=Math.min(100,Math.max(1,this.stats.agility??0)),l=1,r=ie/5,s=Math.sqrt(n/100),i=r*s,a=ie/5,o=Math.min(this.equipment.reduce((k,S)=>{var x;return k+(((x=S.stats)==null?void 0:x.attSpeed)??0)},0),1),f=o*a,c=ie/5,u=this.weaponMastery(),p=this.getMasteryPerk(u),b=(p.attSpeed??0)*c,_=(ie/2.5-1)*((s+o+(p.attSpeed??0))/3);return Math.max(ie-i-f-_-b,l)}}class Ze{constructor(t){I(this,"prohibitedItems");I(this,"furniture");I(this,"stash");this.prohibitedItems=[],this.furniture=[],this.stash=new Array(zt).fill(null),Object.assign(this,t)}}const z="story_town_1",K=rt(),ue=e=>new kt(We[e]??We[z]),kn=e=>{const[t,n]=O(ue(z)),[l,r]=Fe(new Qe({})),[s,i]=Fe(new Ze({furniture:["furniture_bench_basic_1","furniture_stash_1"]})),[a,o]=O([z]),[f,c]=O([]);ve(()=>u());const u=()=>{const g=JSON.parse(window.localStorage.getItem("save")??"null");g&&(r({...g.player,invent:g.player.invent.map(w=>w?{...U[w.name],stack:w.stack}:null)}),i(g.state),o(g.nav),n(ue(g.story)))},p=()=>{lt(()=>{r(new Qe({})),i(new Ze({furniture:["furniture_bench_basic_1"]})),n(ue(z)),o([z])}),b()},b=()=>{window.localStorage.setItem("save",JSON.stringify({player:se(l),story:t().name,state:se(s),nav:a()}))};window.addEventListener("beforeunload",b),setInterval(b,1e4);const m=(g,w=1)=>{if(!w)return w;if(w===1/0)return console.error("Cannot add infinite items to invent"),0;if(typeof g=="string"){if(!U[g])return console.warn("Invalid or not found item",g),w;g=U[g]}let C=[...l.invent];if(g.exclusive&&C.find(y=>(y==null?void 0:y.name)===g.name))return 0;let E=w;return g.stackable&&g.maxStack&&(C=C.map(y=>{if(!(y!=null&&y.name)||!(y!=null&&y.stack)||!y.maxStack||!E)return y;if(y.name===g.name&&y.stack<y.maxStack){let V=Math.min(y.stack+E,y.maxStack);return E-=V-y.stack,{...y,stack:V}}return y})),E&&(C=C.map(y=>{if(!E)return y;if(y===null){const V=Math.min(E,g.maxStack??1);return E-=V,{...g,stack:V}}return y})),E<w&&r("invent",C),w-E},_=(g,w=1)=>{if(!w)return!1;if(typeof g=="string"){if(!U[g])return console.warn("Invalid or not found item",g),!1;g=U[g]}if(l.invent.findLastIndex(y=>(y==null?void 0:y.name)===g.name)<0)return!1;const E=[...l.invent.toReversed().map(y=>{if(!w||(y==null?void 0:y.name)!==g.name||!(y!=null&&y.stack))return y;if(y.stack<=w)return w-=y.stack,null;const V=y.stack-w;return w=0,{...y,stack:V}}).reverse()].filter(Boolean);return E.push(...new Array(mt-E.length).fill(null)),r("invent",E),!0},$=(g,w=1)=>{if(!w)return w;if(w===1/0)return console.error("Cannot add infinite items to stash"),0;if(typeof g=="string"){if(!U[g])return console.warn("Invalid or not found item",g),w;g=U[g]}let C=[...s.stash];if(g.exclusive&&C.find(y=>(y==null?void 0:y.name)===g.name))return 0;let E=w;return g.stackable&&g.maxStack&&(C=C.map(y=>{if(!(y!=null&&y.name)||!(y!=null&&y.stack)||!E)return y;if(y.name===g.name&&y.stack<g.maxStack){let V=Math.min(y.stack+E,g.maxStack);return E-=V-y.stack,{...y,stack:V}}return y})),E&&(C=C.map(y=>{if(!E)return y;if(y===null){const V=Math.min(E,g.maxStack??1);return E-=V,{name:g.name,stack:V}}return y})),E<w&&i("stash",C),w-E},k=T(()=>{try{return s.furniture.map(g=>$t[g]).filter(g=>g.type==="stash").reduce((g,w)=>g+(w.storageSize??0),0)}catch(g){return console.error(g),0}}),S=(g,w=1)=>{if(!w)return!1;if(typeof g=="string"){if(!U[g])return console.warn("Invalid or not found item",g),!1;g=U[g]}if(s.stash.findLastIndex(y=>(y==null?void 0:y.name)===g.name)<0)return!1;const E=[...s.stash.toReversed().map(y=>{if(!w||(y==null?void 0:y.name)!==g.name||!(y!=null&&y.stack))return y;if(y.stack<=w)return w-=y.stack,null;const V=y.stack-w;return w=0,{...y,stack:V}}).reverse()].filter(Boolean);return E.push(...new Array(k()-E.length).fill(null)),i("stash",E),!0},x=g=>{if(g==="_start"&&(g=z),g===z){o([z]),n(ue(z));return}const w=/^_back/.test(g);if(!w&&!We[g]){console.error(`Unknown story ${g}`);return}if(w){const[C,E]=g.split("."),y=Math.min(parseInt(E??"1"),a().length+1);g=a().at(-1-y)??z,a().length>1&&o(a().slice(0,-y))}else a().at(-1)!==g&&o([...a(),g]);n(ue(g))},A=(g,w=1)=>{const C=(l.stats[g]??0)+w;r("stats",g,C)},X={story:t,onNavigate:x,onAddStat:A,player:l,state:s,setState:i,setPlayer:r,addInventory:m,removeInventory:_,log:f,onLog:(g,w="basic")=>{var y;const C=new Date,E={msg:g,time:[C.getHours(),C.getMinutes(),C.getSeconds()].join(":"),type:w};c([...f().slice(Math.min(((y=f())==null?void 0:y.length)-999,0)),E])},onAddMastery:(g,w=1)=>{const C=(l.mastery[g]??0)+w;r("mastery",g,C)},onEquip:g=>{if(_(g)){let w=!1;return r("equipment",[...l.equipment.map(C=>C.equipSlot===g.equipSlot?(w=!0,Object.entries(C.stats??{}).forEach(([E,y])=>A(E,0-y)),m(C),g):C),...w?[]:[g]]),Object.entries(g.stats??{}).forEach(([C,E])=>A(C,E)),!0}return!1},onUnequip:g=>!!l.equipment.find(C=>C.name===g.name)&&m(g)?(r("equipment",[...l.equipment.filter(C=>C.name!==g.name)]),Object.entries(g.stats??{}).forEach(([C,E])=>A(C,0-E)),!0):!1,onTask:g=>{o([...a(),"task"]),n(new kt({name:"task",type:"task",...g,onComplete:g.noRepeat?g.onComplete??(()=>x("_back")):void 0}))},navStack:a,addStash:$,removeStash:S,onClearState:p};return d(K.Provider,{value:X,get children(){return e.children}})};var xn=v('<div class="flex flex-row mt-auto gap-2"><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Go back</div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Town'),Cn=v('<div class="flex flex-col gap-5 p-2 h-full overflow-y-auto">'),An=v("<div class=text-gray-500>Nothing here..."),Ln=v('<span class="text-xs text-gray-400">'),En=v('<div class="w-full border content-center h-12 text-lg font-bold flex flex-col justify-center">');const Mn=()=>{const e=W(K),t=l=>{if(l.goto)return e==null?void 0:e.onNavigate(l.goto);if(l.action&&e)return l.action(e)},n=T(()=>{const l=e==null?void 0:e.story().options;return Array.isArray(l)?l:(l==null?void 0:l(e))??[]});return(()=>{var l=Cn();return h(l,d(P,{get when(){return n().length},get fallback(){return An()},get children(){return d(Z,{get each(){return n()},children:r=>(()=>{var s=En();return s.$$click=()=>!r.isDisabled&&t(r),h(s,()=>r.label,null),h(s,d(P,{get when(){return r.subtext},get children(){var i=Ln();return h(i,()=>r.subtext),i}}),null),Y(i=>{var a=!!r.isDisabled,o=!r.isDisabled;return a!==i.e&&s.classList.toggle("text-gray-500",i.e=a),o!==i.t&&s.classList.toggle("cursor-pointer",i.t=o),i},{e:void 0,t:void 0}),s})()})}}),null),h(l,d(P,{get when(){var r;return((r=e==null?void 0:e.story())==null?void 0:r.name)!==z},get children(){var r=xn(),s=r.firstChild,i=s.nextSibling;return s.$$click=()=>t({label:"Go back",goto:"_back"}),i.$$click=()=>t({label:"Back to town",goto:"_start"}),r}}),null),l})()};le(["click"]);var Tn=v("<div>");const G=e=>(()=>{var t=Tn();return Oe(t,"click",e.onClick),h(t,()=>e.children),Y(()=>Nt(t,`${e.class??""} bg-black rounded py-1 px-2 cursor-pointer hover:outline hover:outline-blue-500 font-bold text-xs h-full`)),t})();le(["click"]);var In=v("<div class=text-sm>"),jn=v("<button class=m-auto>use"),On=v("<button class=m-auto>equip"),qn=v('<div class="px-2 py-1 bg-blue-300 w-full flex flex-row justify-between items-center mb-2"><span class="font-bold text-xl text-black">Stash</span><div class="flex flex-row gap-4">'),Pn=v('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="w-full flex flex-row justify-between gp-2 mb-2"></div><div class="px-2 py-1 bg-red-300 w-full flex flex-row justify-between items-center"><span class="font-bold text-xl text-black">Drop</span><div class="flex flex-row gap-4">'),Dn=v('<div class="h-full relative"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2">'),Rn=v('<div class="border p-1 cursor-pointer flex flex-row justify-between"><div></div><div>(<!>)'),Nn=v('<div class="border p-1 flex flex-row justify-between border-gray-700 text-gray-700">Empty');const Hn=()=>{const e=W(K),[t,n]=O(),l=c=>{c<0||!(e!=null&&e.player.invent[c])||n(c)},r=T(()=>{const c=t()??-1;if(!(c<0))return e==null?void 0:e.player.invent.at(c)}),s=()=>{var u;const c=r();!c||!e||(u=c==null?void 0:c.use)!=null&&u.call(c,e)&&n(void 0)},i=()=>{const c=r();!(c!=null&&c.equipSlot)||!e||e.onEquip(c)&&n(void 0)},a=c=>{const u=r();u&&(e==null||e.removeInventory(u,c),c>=(u.stack??1)&&n(void 0))},o=c=>{const u=r();if(u&&(c=c===1/0?(e==null?void 0:e.player.invent.reduce((p,b)=>(b==null?void 0:b.name)===u.name?p+(b.stack??0):p,0))??0:c,console.log({item:u,count:c}),u)){const p=e==null?void 0:e.addStash(u,c);console.log(p),e==null||e.removeInventory(u,p)}},f=T(()=>e==null?void 0:e.navStack().includes("story_home_1"));return(()=>{var c=Dn(),u=c.firstChild;return u.$$click=()=>n(void 0),h(u,d(Z,{get each(){return(e==null?void 0:e.player.invent)??[]},children:(p,b)=>d(Bn,{item:p,onSelect:()=>l(b())})})),h(c,d(P,{get when(){return r()},get children(){var p=Pn(),b=p.firstChild,m=b.firstChild,_=m.firstChild,$=_.nextSibling,k=$.firstChild,S=k.nextSibling;S.nextSibling;var x=m.nextSibling,A=x.firstChild,L=A.nextSibling,N=L.firstChild,R=N.nextSibling;return _.$$click=()=>n(void 0),h($,()=>{var M;return(M=r())==null?void 0:M.label},k),h($,()=>{var M;return(M=r())==null?void 0:M.stack},S),h(b,d(P,{get when(){return r().stats},get children(){var M=In();return h(M,()=>Object.entries(r().stats??{}).filter(([D,X])=>!!X).map(([D,X])=>`[${D}: ${X}]`).join("")),M}}),x),h(A,d(P,{get when(){var M;return(M=r())==null?void 0:M.use},get children(){var M=jn();return M.$$click=s,M}}),null),h(A,d(P,{get when(){return r().equipSlot},get children(){var M=On();return M.$$click=i,M}}),null),h(x,d(P,{get when(){return f()},get children(){var M=qn(),D=M.firstChild,X=D.nextSibling;return h(X,d(G,{onClick:()=>o(1),children:"One"}),null),h(X,d(G,{onClick:()=>{var g;return o(((g=r())==null?void 0:g.stack)??1)},children:"Stack"}),null),h(X,d(G,{onClick:()=>o(1/0),children:"All"}),null),M}}),L),h(R,d(G,{onClick:()=>a(1),children:"One"}),null),h(R,d(G,{onClick:()=>{var M;return a(((M=r())==null?void 0:M.stack)??1)},children:"Stack"}),null),h(R,d(G,{onClick:()=>a(1/0),children:"All"}),null),p}}),null),c})()},Bn=e=>{const t=n=>{n.stopPropagation(),e.onSelect()};return d(P,{get when(){return e.item},get fallback(){return Nn()},get children(){var n=Rn(),l=n.firstChild,r=l.nextSibling,s=r.firstChild,i=s.nextSibling;return i.nextSibling,n.$$click=t,h(l,()=>{var a;return(a=e.item)==null?void 0:a.label}),h(r,()=>{var a;return(a=e.item)==null?void 0:a.stack},i),n}})};le(["click"]);var Fn=v('<div class="w-full border rounded relative text-black bg-gray-500"><div class="ease-linear w-0 h-full rounded"></div><div class="absolute left-1/2 top-1/2 -translate-1/2 whitespace-nowrap">');const Ye=e=>{const t=W(qe),[n,l]=O(e.ticks),r=()=>{let s=n();s<=0&&(e.onFinish(),s=e.ticks+1),l(s-1)};return ve(()=>t==null?void 0:t.evt.addEventListener(B.type,r)),je(()=>t==null?void 0:t.evt.removeEventListener(B.type,r)),d(me,{get max(){return e.ticks},get value(){return e.ticks-n()},get type(){return e.type},get showPc(){return e.showPc},get showNumber(){return e.showNumber},get label(){return e.label}})},me=e=>{const t=T(()=>Math.min(e.value/e.max*100,100));return(()=>{var n=Fn(),l=n.firstChild,r=l.nextSibling;return h(r,d(we,{get children(){return[d(H,{get when(){return e.showPc},get children(){return[Q(()=>e.label)," (",Q(()=>t().toFixed(0)),"%)"]}}),d(H,{get when(){return e.showNumber},get children(){return[Q(()=>e.label)," ",Q(()=>e.value)]}})]}})),Y(s=>{var i=!e.isSmall,a=t()+"%",o=!e.type,f=e.type==="green",c=e.type==="yellow",u=e.type==="blue",p=e.type==="red";return i!==s.e&&n.classList.toggle("h-full",s.e=i),a!==s.t&&Ht(l,"width",s.t=a),o!==s.a&&l.classList.toggle("bg-white",s.a=o),f!==s.o&&l.classList.toggle("bg-green-500",s.o=f),c!==s.i&&l.classList.toggle("bg-yellow-500",s.i=c),u!==s.n&&l.classList.toggle("bg-blue-500",s.n=u),p!==s.s&&l.classList.toggle("bg-red-500",s.s=p),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),n})()};var Vn=v('<div class="flex flex-col justify-between items-center cursor-pointer"><div class="text-xl font-bold"></div><div class="h-4 w-32">'),Un=v('<div class="flex flex-row justify-between items-center font-bold mb-2"><div>Level</div><div>Stats'),Wn=v('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Skills</button><button>Mastery</button><button>Recipes'),Yn=v('<div class="flex flex-row justify-between items-center cursor-pointer"><div></div><div class="h-4 w-32">'),Kn=v('<div class="flex flex-row justify-between items-center border-b border-gray-700"><div></div><div class=text-xs>'),Xn=v('<div class="flex flex-row justify-between items-center"><div>');const Gn=()=>{const[e,t]=O("mastery"),n=W(K),[l,r]=O(),s=T(()=>Object.entries((n==null?void 0:n.player.mastery)??{}).map(([f,c])=>{const u=ge[f];return{label:(u==null?void 0:u.label)??"",progress:wt(c,he)*100,level:be(c,he),name:f}})??[]),i=T(()=>(n==null?void 0:n.player.recipes.map(f=>U[f]))??[]),a=f=>{r(void 0),t(f)},o=T(()=>{var p,b,m;const f=(p=l())==null?void 0:p.name;if(f===void 0)return;const c=be((n==null?void 0:n.player.mastery[f])??0,he),u=(b=ge[f])==null?void 0:b.bonus.findLastIndex(_=>_.level<=c);return(m=ge[f])==null?void 0:m.bonus.slice(0,(u??0)+2).map((_,$,k)=>({level:_.level,stats:Object.entries(_.stats??{}).filter(([S,x])=>!!x).map(([S,x])=>`[${S}: ${x}]`).join(""),isLast:$===k.length-1}))});return(()=>{var f=Wn(),c=f.firstChild,u=c.nextSibling,p=u.firstChild,b=p.nextSibling,m=b.nextSibling;return h(c,d(we,{get children(){return[d(H,{get when(){return e()==="skills"},children:"TODO"}),d(H,{get when(){return Q(()=>e()==="mastery")()&&!l()},get children(){return d(Z,{get each(){return s()},children:_=>(()=>{var $=Yn(),k=$.firstChild,S=k.nextSibling;return $.$$click=()=>r(_),h(k,()=>_.label),h(S,d(me,{get label(){return`${_.level}`},type:"yellow",max:100,get value(){return _.progress},showPc:!0})),$})()})}}),d(H,{get when(){return Q(()=>e()==="mastery")()&&l()},get children(){return[(()=>{var _=Vn(),$=_.firstChild,k=$.nextSibling;return h($,()=>{var S;return(S=l())==null?void 0:S.label}),h(k,d(me,{get label(){return`${l().level}`},type:"yellow",max:100,get value(){return l().progress},showPc:!0})),_})(),Un(),d(Z,{get each(){return o()},children:_=>(()=>{var $=Kn(),k=$.firstChild,S=k.nextSibling;return h(k,()=>_.level),h(S,(()=>{var x=Q(()=>!!_.isLast);return()=>x()?"???":_.stats})()),$})()})]}}),d(H,{get when(){return e()==="recipes"},get children(){return d(Z,{get each(){return i()},children:_=>(()=>{var $=Xn(),k=$.firstChild;return h(k,()=>_.label),$})()})}})]}})),p.$$click=()=>a("skills"),b.$$click=()=>a("mastery"),m.$$click=()=>a("recipes"),Y(_=>{var $=e()==="skills",k=e()==="mastery",S=e()==="recipes";return $!==_.e&&p.classList.toggle("selected",_.e=$),k!==_.t&&b.classList.toggle("selected",_.t=k),S!==_.a&&m.classList.toggle("selected",_.a=S),_},{e:void 0,t:void 0,a:void 0}),f})()};le(["click"]);var zn=v('<span class="text-red-800 font-bold">'),Jn=v('<span class="text-green-800 font-bold">'),et=v('<span class="text-red-800 font-bold m-1">'),Qn=v('<span class="font-bold m-1">'),Zn=v("<span class=font-bold>"),el=v("<div class=text-red-800>"),tl=v("<div class=h-8><div class=h-2>"),nl=v("<div class=h-2>"),ll=v('<div class="h-8 mt-5">'),rl=v('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>Attacking (<!>)');const sl=()=>{const e=W(K),t=W(qe),[n,l]=O(25),[r,s]=O(0),[i,a]=O(0),[o,f]=O(),[c,u]=O();xe(()=>{t!=null&&t.pause()?t==null||t.evt.addEventListener(B.type,p):t==null||t.evt.removeEventListener(B.type,p)});const p=()=>{n()<=0&&c()?b():l(n()-1)};ve(()=>{var $;l((e==null?void 0:e.player.attackRate())??25),u(e==null?void 0:e.story().getEncounter()),f(($=c())==null?void 0:$.health)});const b=()=>{var D,X,g;const $=!(t!=null&&t.pause()),[k,S]=[e==null?void 0:e.player,e==null?void 0:e.story()],x=c(),A=o();if(!k||!S)return;if(l((e==null?void 0:e.player.attackRate())??25),!x&&S.limit&&i()>=S.limit){(D=S.onComplete)==null||D.call(S);return}if(!x){u(e==null?void 0:e.story().getEncounter()),f((X=c())==null?void 0:X.health);return}if(!A)return;const[L,N]=(e==null?void 0:e.player.attackDamage())??[0,1],R=L+Math.round(Math.random()*(N-L)),M=A-Math.min(R,A);if($&&(e==null||e.onLog(["You hit the ",(()=>{var w=zn();return h(w,x.label),w})()," for ",(()=>{var w=Jn();return h(w,R),w})()," damage"],"basic")),e==null||e.onAddMastery(e.player.weaponMastery(),R),M<=0){$&&(e==null||e.onLog(["You killed the",(()=>{var C=et();return h(C,x.label),C})()],"good")),a(i()+1),u(void 0),x.experience&&(e==null||e.onAddStat("experience",x.experience));const w=(g=S.getDrops(x))==null?void 0:g.filter(C=>!(e!=null&&e.state.prohibitedItems.includes(C.name))).filter(C=>!!(e!=null&&e.addInventory(C)));if(w!=null&&w.length&&$&&(e==null||e.onLog(["It dropped:",(()=>{var C=Qn();return h(C,w==null?void 0:w.map(E=>E.label).join(", ")),C})()],"drop")),S.noRepeat)return;s(S.cooldown??0),t==null||t.evt.addEventListener(B.type,_)}f(Math.max(M,0))},m=()=>{var N;const $=!(t!=null&&t.pause()),[k,S]=[e==null?void 0:e.player,e==null?void 0:e.story()];if(!k||!S)return;const{attMin:x,attMax:A}=((N=c())==null?void 0:N.stats)??{};if(x===void 0||A===void 0)return;const L=x+Math.round(Math.random()*(A-x));if($&&(e==null||e.onLog([(()=>{var R=et();return h(R,c().label),R})()," hits you for ",(()=>{var R=Zn();return h(R,L),R})()," damage!"],"bad")),k.stats.health<=L){e==null||e.onNavigate("_start");return}e==null||e.onAddStat("health",-L)},_=()=>{if(r()<=0)return t==null||t.evt.removeEventListener(B.type,_),b();s(r()-1)};return je(()=>{t==null||t.evt.removeEventListener(B.type,_)}),d(P,{get when(){return!(t!=null&&t.pause())},get children(){var $=rl(),k=$.firstChild,S=k.firstChild,x=S.nextSibling;return x.nextSibling,h(k,i,x),h(k,d(P,{get when(){return e==null?void 0:e.story().limit},get children(){return[" / ",Q(()=>e==null?void 0:e.story().limit)]}}),x),h($,d(P,{get when(){var A;return Q(()=>!!(!c()&&(e!=null&&e.story().limit)))()&&i()>=(((A=e.story())==null?void 0:A.limit)??0)},children:"There is nothing left here to destroy"}),null),h($,d(P,{get when(){return c()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var A=el();return h(A,()=>{var L;return(L=c())==null?void 0:L.label}),A})(),(()=>{var A=tl(),L=A.firstChild;return h(A,d(me,{type:"red",get max(){return(e==null?void 0:e.player.stats.maxHealth)??10},get value(){return(e==null?void 0:e.player.stats.health)??0},label:"You",showNumber:!0}),L),h(L,d(Ye,{get ticks(){return n()},onFinish:b,type:"yellow",isSmall:!0})),A})(),(()=>{var A=ll();return h(A,d(me,{type:"red",get max(){return c().health},get value(){return o()},get label(){var L;return(L=c())==null?void 0:L.label},showNumber:!0}),null),h(A,d(P,{get when(){var L,N;return(N=(L=c())==null?void 0:L.stats)==null?void 0:N.attSpeed},get children(){var L=nl();return h(L,d(Ye,{get ticks(){return c().stats.attSpeed},onFinish:m,type:"yellow",isSmall:!0})),L}}),null),A})()]}}),null),$}})};var al=v('<span class="text-red-800 font-bold m-1">'),il=v('<span class="font-bold m-1">'),ol=v("<div class=text-red-800>"),cl=v("<div class=h-8>"),ul=v('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>');const fl=()=>{const e=W(K),t=W(qe),[n,l]=O(!1),[r,s]=O(0),[i,a]=O(0),o=T(()=>{const p=e==null?void 0:e.story().masteryType;if(p){const b=St(p,e.player.mastery[p]??0);return Math.max(1,((e==null?void 0:e.story().duration)??100)-(b.durationModifier??0))}return(e==null?void 0:e.story().duration)??100});xe(()=>{const[p,b]=[e==null?void 0:e.player,e==null?void 0:e.story()];!p||!b||b.utilityType&&(p.equipment.find(m=>m.utilityType===b.utilityType)||e==null||e.onNavigate("_back"))}),xe(()=>{o()&&(t!=null&&t.pause()?(a(o()),t==null||t.evt.addEventListener(B.type,f)):t==null||t.evt.removeEventListener(B.type,f))});const f=()=>{i()<=0&&n()?c():a(i()-1)};ve(()=>{l(!0)});const c=()=>{var _,$;const[p,b]=[e==null?void 0:e.player,e==null?void 0:e.story()];if(!p||!b)return;if(!n()){a(o()),l(!0);return}l(!1),e==null||e.onLog(["You finished",(()=>{var k=al();return h(k,b.description),k})()],"good"),b.masteryType&&(e==null||e.onAddMastery(b.masteryType,b.experience??0));const m=(_=b.getItems(void 0,b.masteryType,b.masteryType?p.mastery[b.masteryType]:void 0))==null?void 0:_.filter(k=>!(e!=null&&e.state.prohibitedItems.includes(k.name))).filter(k=>!!(e!=null&&e.addInventory(k)));if(m!=null&&m.length&&(e==null||e.onLog(["You gained:",(()=>{var k=il();return h(k,m==null?void 0:m.map(S=>S.label).join(", ")),k})()],"drop")),b.noRepeat)return(($=b.onComplete)==null?void 0:$.call(b))??(e==null?void 0:e.onNavigate("_back"));s(b.cooldown??0),t==null||t.evt.addEventListener(B.type,u)},u=()=>{if(r()<=0)return t==null||t.evt.removeEventListener(B.type,u),c();s(r()-1)};return je(()=>{t==null||t.evt.removeEventListener(B.type,f),t==null||t.evt.removeEventListener(B.type,u)}),d(P,{get when(){return!(t!=null&&t.pause())},get children(){var p=ul(),b=p.firstChild;return h(b,()=>e==null?void 0:e.story().label),h(p,d(P,{get when(){return n()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var m=ol();return h(m,()=>e==null?void 0:e.story().description),m})(),(()=>{var m=cl();return h(m,d(Ye,{get ticks(){return o()},onFinish:c,label:"Task",showPc:!0})),m})()]}}),null),p}})};var dl=v('<div class="text-lg font-bold mt-5">Weapon'),hl=v('<div class="text-lg font-bold mt-5">Armour'),gl=v('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Equip</button><button>Stats'),yl=v('<div class="flex flex-row justify-between border-gray-700"><div></div><div>'),pl=v('<div class="flex flex-row justify-between items-center border-gray-700"><div></div><div class="text-xs text-gray-500">');const bl=()=>{const[e,t]=O("stats"),n=W(K),l=T(()=>{const s=n==null?void 0:n.player.attackDamage(),i=1e3/Ve,a=1/(((n==null?void 0:n.player.attackRate())??ie)/i);return[{label:"Health",value:(n==null?void 0:n.player.stats.health)??0},{label:"Max health",value:(n==null?void 0:n.player.stats.maxHealth)??0},{label:"",value:""},{label:"Att. min",value:(s==null?void 0:s.at(0))??0},{label:"Att. max",value:(s==null?void 0:s.at(1))??0},{label:"Att. rate",value:`${(a==null?void 0:a.toFixed(2))??0} p/s`},{label:"",value:""},{label:"Phys. res",value:(n==null?void 0:n.player.stats.physRes)??0},{label:"Mag. res",value:(n==null?void 0:n.player.stats.magRes)??0}]}),r=T(()=>{const s=["weapon","offhand"],i=["head","shoulder","chest","hand","leg","foot"];return[{label:dl(),isDisabled:!1,isEmpty:!0},...s.map(a=>{const o=a&&(n==null?void 0:n.player.equipment.find(f=>f.equipSlot===a));return{label:(o==null?void 0:o.label)??a,isDisabled:!o,subtext:Object.entries((o==null?void 0:o.stats)??{}).map(([f,c])=>`[${f}: ${c}]`).join(""),onClick:o?()=>n==null?void 0:n.onUnequip(o):void 0}}),{label:hl(),isDisabled:!1,isEmpty:!0},...i.map(a=>{const o=a&&(n==null?void 0:n.player.equipment.find(f=>f.equipSlot===a));return{label:(o==null?void 0:o.label)??a,isDisabled:!o,subtext:Object.entries((o==null?void 0:o.stats)??{}).map(([f,c])=>`[${f}: ${c}]`).join(""),onClick:o?()=>n==null?void 0:n.onUnequip(o):void 0}})]});return(()=>{var s=gl(),i=s.firstChild,a=i.nextSibling,o=a.firstChild,f=o.nextSibling;return h(i,d(we,{get children(){return[d(H,{get when(){return e()==="stats"},get children(){return d(Z,{get each(){return l()},children:c=>(()=>{var u=yl(),p=u.firstChild,b=p.nextSibling;return h(p,()=>c.label),h(b,()=>c.value),Y(()=>u.classList.toggle("border-b",!!c.label)),u})()})}}),d(H,{get when(){return e()==="equip"},get children(){return d(Z,{get each(){return r()},children:c=>(()=>{var u=pl(),p=u.firstChild,b=p.nextSibling;return Oe(u,"click",c.onClick),h(p,()=>c.label),h(b,()=>c.subtext),Y(m=>{var _=!c.isEmpty,$=!!c.isDisabled;return _!==m.e&&u.classList.toggle("border-b",m.e=_),$!==m.t&&p.classList.toggle("text-gray-700",m.t=$),m},{e:void 0,t:void 0}),u})()})}})]}})),o.$$click=()=>t("equip"),f.$$click=()=>t("stats"),Y(c=>{var u=e()==="equip",p=e()==="stats";return u!==c.e&&o.classList.toggle("selected",c.e=u),p!==c.t&&f.classList.toggle("selected",c.t=p),c},{e:void 0,t:void 0}),s})()};le(["click"]);var ml=v('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative mb-3"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="px-2 py-1 bg-blue-300 w-full flex flex-row justify-between items-center mb-2"><span class="font-bold text-xl text-black">Transfer</span><div class="flex flex-row gap-4"></div></div><div class="px-2 py-1 bg-red-300 w-full flex flex-row justify-between items-center"><span class="font-bold text-xl text-black">Drop</span><div class="flex flex-row gap-4">'),vl=v('<div class="h-full relative pb-2"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2"></div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Leave stash'),_l=v('<div class="border p-1 cursor-pointer flex flex-row justify-between"><div></div><div>(<!>)'),wl=v('<div class="border p-1 flex flex-row justify-between border-gray-700 text-gray-700">Empty');const $l=()=>{const e=W(K),[t,n]=O(),l=T(()=>((e==null?void 0:e.state.stash)??[]).map(o=>o?{...U[o.name],stack:o.stack}:null)),r=o=>{o<0||!(e!=null&&e.state.stash[o])||n(o)},s=T(()=>{const o=t()??-1;if(!(o<0))return l().at(o)}),i=o=>{const f=s();f&&(e==null||e.removeInventory(f,o),o>=(f.stack??1)&&n(void 0))},a=o=>{const f=s();if(!f)return;o=o===1/0?(e==null?void 0:e.state.stash.reduce((u,p)=>(p==null?void 0:p.name)===f.name?u+p.stack:u,0))??0:o;const c=e==null?void 0:e.addInventory(f,o);e==null||e.removeStash(f,c)};return(()=>{var o=vl(),f=o.firstChild,c=f.nextSibling;return f.$$click=()=>n(void 0),h(f,d(Z,{get each(){return l()},children:(u,p)=>d(Sl,{item:u,onSelect:()=>r(p())})})),h(o,d(P,{get when(){return s()},get children(){var u=ml(),p=u.firstChild,b=p.firstChild,m=b.firstChild,_=m.nextSibling,$=_.firstChild,k=$.nextSibling;k.nextSibling;var S=b.nextSibling,x=S.firstChild,A=x.firstChild,L=A.nextSibling,N=x.nextSibling,R=N.firstChild,M=R.nextSibling;return m.$$click=()=>n(void 0),h(_,()=>{var D;return(D=s())==null?void 0:D.label},$),h(_,()=>{var D;return(D=s())==null?void 0:D.stack},k),h(L,d(G,{onClick:()=>a(1),children:"One"}),null),h(L,d(G,{onClick:()=>{var D;return a(((D=s())==null?void 0:D.stack)??1)},children:"Stack"}),null),h(L,d(G,{onClick:()=>a(1/0),children:"All"}),null),h(M,d(G,{onClick:()=>i(1),children:"One"}),null),h(M,d(G,{onClick:()=>{var D;return i(((D=s())==null?void 0:D.stack)??1)},children:"Stack"}),null),h(M,d(G,{onClick:()=>i(1/0),children:"All"}),null),u}}),c),c.$$click=()=>e==null?void 0:e.onNavigate("_back"),o})()},Sl=e=>{const t=n=>{n.stopPropagation(),e.onSelect()};return d(P,{get when(){return e.item},get fallback(){return wl()},get children(){var n=_l(),l=n.firstChild,r=l.nextSibling,s=r.firstChild,i=s.nextSibling;return i.nextSibling,n.$$click=t,h(l,()=>{var a;return(a=e.item)==null?void 0:a.label}),h(r,()=>{var a;return(a=e.item)==null?void 0:a.stack},i),n}})};le(["click"]);var kl=v('<div class="flex flex-col p-2 gap-2 w-full"><div class="border p-2 font-bold cursor-pointer">RESET');const xl=()=>{const e=W(K);return(()=>{var t=kl(),n=t.firstChild;return Oe(n,"click",e==null?void 0:e.onClearState),t})()};le(["click"]);var Cl=v('<div class="w-dvw h-dvh lg:w-[360px] lg:h-[800px] flex flex-col justify-between"><div class="h-3/10 bg-gray-400"><div class=h-1/10></div><div class=h-9/10></div></div><div class=h-1/10></div><div class="h-5/10 bg-gray-800">'),Al=v("<div>Unknown view"),Ll=v('<div class="h-1/10 w-full flex flex-row justify-between font-bold">'),El=v('<div class="flex flex-col gap-2 p-1 h-full"><div class="bg-black text-left pl-1"></div><div class="text-black whitespace-pre-wrap text-left overflow-y-auto text-sm">'),Ml=v('<div class="h-full bg-white flex flex-row"><div class="text-black bottom-0 left-0 border border-gray-100 p-1 flex flex-col gap-1 bg-white"><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide bad"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide good"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide meta"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide drop"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide basic"></div></div><div class="text-black h-full overflow-y-auto flex flex-col w-full">'),Tl=v('<div class="flex flex-row items-center px-1 transition-colors duration-500 border-t border-gray-200"><div class="text-xs text-blue-400 mr-1">[<!>]</div><div class="text-wrap text-xs text-left">'),Il=v('<div class="flex flex-row bg-black px-1 justify-between"><div class=text-red-500>HP <!>/</div><div class=text-yellow-500>Gold </div><div class=text-green-500>Lvl <!> (<!>%)'),jl=v('<div class="content-center w-1/4 border border-l-0 cursor-pointer last:border-r-0">');function Ol(){return d(kn,{get children(){return d(Qt,{get children(){return d(ql,{})}})}})}const ql=()=>{const[e,t]=O("story"),n=W(K),l=T(()=>e()==="story"&&(n==null?void 0:n.story().name)==="story_stash_1"?"stash":e());return(()=>{var r=Cl(),s=r.firstChild,i=s.firstChild,a=i.nextSibling,o=s.nextSibling,f=o.nextSibling;return h(i,d(Nl,{})),h(a,d(Dl,{})),h(o,d(Rl,{})),h(f,d(we,{get fallback(){return Al()},get children(){return[d(H,{get when(){return l()==="story"},get children(){return d(Mn,{})}}),d(H,{get when(){return l()==="stash"},get children(){return d($l,{})}}),d(H,{get when(){return l()==="invent"},get children(){return d(Hn,{})}}),d(H,{get when(){return l()==="skills"},get children(){return d(Gn,{})}}),d(H,{get when(){return l()==="stats"},get children(){return d(bl,{})}}),d(H,{get when(){return l()==="menu"},get children(){return d(xl,{})}})]}})),h(r,d(Pl,{onChange:t,get view(){return e()}}),null),r})()},Pl=e=>(()=>{var t=Ll();return h(t,d(fe,{label:"Story",onClick:()=>e.onChange("story"),get view(){return e.view},type:"story"}),null),h(t,d(fe,{label:"Invent",onClick:()=>e.onChange("invent"),get view(){return e.view},type:"invent"}),null),h(t,d(fe,{label:"Skills",onClick:()=>e.onChange("skills"),get view(){return e.view},type:"skills"}),null),h(t,d(fe,{label:"Stats",onClick:()=>e.onChange("stats"),get view(){return e.view},type:"stats"}),null),h(t,d(fe,{label:"Menu",onClick:()=>e.onChange("menu"),get view(){return e.view},type:"menu"}),null),t})(),Dl=()=>{const e=W(K);return d(we,{get children(){return[d(H,{get when(){return(e==null?void 0:e.story().type)==="dialogue"},get children(){var t=El(),n=t.firstChild,l=n.nextSibling;return h(n,()=>(e==null?void 0:e.story().label)??"Story"),h(l,()=>e==null?void 0:e.story().description),t}}),d(H,{get when(){return(e==null?void 0:e.story().type)==="encounter"},get children(){return d(sl,{})}}),d(H,{get when(){return(e==null?void 0:e.story().type)==="task"},get children(){return d(fl,{})}})]}})},Rl=()=>{const[e,t]=O(),{log:n}=W(K)??{},[l,r]=Fe({good:!0,bad:!0,meta:!0,drop:!0,basic:!0}),s=T(()=>{const i=e();if(!i)return;const a=i.scrollTop+i.clientHeight>i.scrollHeight-10;return setTimeout(()=>a&&i.scrollTo(0,i.scrollHeight??0)),n==null?void 0:n().filter(o=>l[o.type])});return(()=>{var i=Ml(),a=i.firstChild,o=a.firstChild,f=o.nextSibling,c=f.nextSibling,u=c.nextSibling,p=u.nextSibling,b=a.nextSibling;return o.$$click=()=>r("bad",!l.bad),f.$$click=()=>r("good",!l.good),c.$$click=()=>r("meta",!l.meta),u.$$click=()=>r("drop",!l.drop),p.$$click=()=>r("basic",!l.basic),Bt(t,b),h(b,d(Z,{get each(){return s()},children:m=>(()=>{var _=Tl(),$=_.firstChild,k=$.firstChild,S=k.nextSibling;S.nextSibling;var x=$.nextSibling;return h($,()=>m.time,S),h(x,()=>m.msg),Y(A=>dt(_,{"last:bg-red-500 last:text-white bg-red-200":m.type==="bad","last:bg-green-500 last:text-white bg-green-200":m.type==="good","last:bg-yellow-500 bg-yellow-200":m.type==="meta","last:bg-blue-500 last:text-white bg-blue-200":m.type==="drop"},A)),_})()})),Y(m=>{var _=!l.bad,$=!!l.bad,k=!l.good,S=!!l.good,x=!l.meta,A=!!l.meta,L=!l.drop,N=!!l.drop,R=!l.basic,M=!!l.basic;return _!==m.e&&o.classList.toggle("bg-red-100",m.e=_),$!==m.t&&o.classList.toggle("bg-red-500",m.t=$),k!==m.a&&f.classList.toggle("bg-green-100",m.a=k),S!==m.o&&f.classList.toggle("bg-green-500",m.o=S),x!==m.i&&c.classList.toggle("bg-yellow-100",m.i=x),A!==m.n&&c.classList.toggle("bg-yellow-500",m.n=A),L!==m.s&&u.classList.toggle("bg-blue-100",m.s=L),N!==m.h&&u.classList.toggle("bg-blue-500",m.h=N),R!==m.r&&p.classList.toggle("bg-gray-100",m.r=R),M!==m.d&&p.classList.toggle("bg-gray-500",m.d=M),m},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},Nl=()=>{const e=W(K);return(()=>{var t=Il(),n=t.firstChild,l=n.firstChild,r=l.nextSibling;r.nextSibling;var s=n.nextSibling;s.firstChild;var i=s.nextSibling,a=i.firstChild,o=a.nextSibling,f=o.nextSibling,c=f.nextSibling;return c.nextSibling,h(n,()=>e==null?void 0:e.player.stats.health,r),h(n,()=>e==null?void 0:e.player.stats.maxHealth,null),h(s,()=>e==null?void 0:e.player.stats.gold,null),h(i,()=>be((e==null?void 0:e.player.stats.experience)??0),o),h(i,()=>(wt((e==null?void 0:e.player.stats.experience)??0)*100).toFixed(0),c),t})()},fe=e=>(()=>{var t=jl();return Oe(t,"click",e.onClick),h(t,()=>e.label),Y(n=>dt(t,{"border-t-0 bg-gray-800":e.view===e.type},n)),t})();le(["click"]);const Hl=document.getElementById("root");Rt(()=>d(Ol,{}),Hl);
