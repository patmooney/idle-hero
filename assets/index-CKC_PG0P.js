var at=Object.defineProperty;var ct=(e,t,n)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var L=(e,t,n)=>ct(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();const ut=!1,ft=(e,t)=>e===t,K=Symbol("solid-proxy"),ve=Symbol("solid-track"),ae={equals:ft};let Ne=Ke;const V=1,ce=2,Re={owned:null,cleanups:null,context:null,owner:null};var k=null;let me=null,dt=null,C=null,P=null,N=null,pe=0;function oe(e,t){const n=C,r=k,s=e.length===0,l=t===void 0?r:t,o=s?Re:{owned:null,cleanups:null,context:l?l.context:null,owner:l},i=s?e:()=>e(()=>j(()=>ee(o)));k=o,C=null;try{return Q(i,!0)}finally{C=n,k=r}}function O(e,t){t=t?Object.assign({},ae,t):ae;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),Ue(n,s));return[Ve.bind(n),r]}function q(e,t,n){const r=Ee(e,t,!1,V);re(r)}function ht(e,t,n){Ne=pt;const r=Ee(e,t,!1,V);r.user=!0,N?N.push(r):re(r)}function M(e,t,n){n=n?Object.assign({},ae,n):ae;const r=Ee(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,re(r),Ve.bind(r)}function gt(e){return Q(e,!1)}function j(e){if(C===null)return e();const t=C;C=null;try{return e()}finally{C=t}}function Ce(e){ht(()=>j(e))}function He(e){return k===null||(k.cleanups===null?k.cleanups=[e]:k.cleanups.push(e)),e}function we(){return C}function Fe(e,t){const n=Symbol("context");return{id:n,Provider:vt(n),defaultValue:e}}function R(e){let t;return k&&k.context&&(t=k.context[e.id])!==void 0?t:e.defaultValue}function Be(e){const t=M(e),n=M(()=>_e(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function Ve(){if(this.sources&&this.state)if(this.state===V)re(this);else{const e=P;P=null,Q(()=>fe(this),!1),P=e}if(C){const e=this.observers?this.observers.length:0;C.sources?(C.sources.push(this),C.sourceSlots.push(e)):(C.sources=[this],C.sourceSlots=[e]),this.observers?(this.observers.push(C),this.observerSlots.push(C.sources.length-1)):(this.observers=[C],this.observerSlots=[C.sources.length-1])}return this.value}function Ue(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&Q(()=>{for(let s=0;s<e.observers.length;s+=1){const l=e.observers[s],o=me&&me.running;o&&me.disposed.has(l),(o?!l.tState:!l.state)&&(l.pure?P.push(l):N.push(l),l.observers&&Ye(l)),o||(l.state=V)}if(P.length>1e6)throw P=[],new Error},!1)),t}function re(e){if(!e.fn)return;ee(e);const t=pe;bt(e,e.value,t)}function bt(e,t,n){let r;const s=k,l=C;C=k=e;try{r=e.fn(t)}catch(o){return e.pure&&(e.state=V,e.owned&&e.owned.forEach(ee),e.owned=null),e.updatedAt=n+1,Ge(o)}finally{C=l,k=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Ue(e,r):e.value=r,e.updatedAt=n)}function Ee(e,t,n,r=V,s){const l={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:k,context:k?k.context:null,pure:n};return k===null||k!==Re&&(k.owned?k.owned.push(l):k.owned=[l]),l}function ue(e){if(e.state===0)return;if(e.state===ce)return fe(e);if(e.suspense&&j(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<pe);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===V)re(e);else if(e.state===ce){const r=P;P=null,Q(()=>fe(e,t[0]),!1),P=r}}function Q(e,t){if(P)return e();let n=!1;t||(P=[]),N?n=!0:N=[],pe++;try{const r=e();return yt(n),r}catch(r){n||(N=null),P=null,Ge(r)}}function yt(e){if(P&&(Ke(P),P=null),e)return;const t=N;N=null,t.length&&Q(()=>Ne(t),!1)}function Ke(e){for(let t=0;t<e.length;t++)ue(e[t])}function pt(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:ue(r)}for(t=0;t<n;t++)ue(e[t])}function fe(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const s=r.state;s===V?r!==t&&(!r.updatedAt||r.updatedAt<pe)&&ue(r):s===ce&&fe(r,t)}}}function Ye(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=ce,n.pure?P.push(n):N.push(n),n.observers&&Ye(n))}}function ee(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const l=s.pop(),o=n.observerSlots.pop();r<s.length&&(l.sourceSlots[o]=r,s[r]=l,n.observerSlots[r]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)ee(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)ee(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function mt(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Ge(e,t=k){throw mt(e)}function _e(e){if(typeof e=="function"&&!e.length)return _e(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=_e(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function vt(e,t){return function(r){let s;return q(()=>s=j(()=>(k.context={...k.context,[e]:r.value},Be(()=>r.children))),void 0),s}}const wt=Symbol("fallback");function Oe(e){for(let t=0;t<e.length;t++)e[t]()}function _t(e,t,n={}){let r=[],s=[],l=[],o=0,i=t.length>1?[]:null;return He(()=>Oe(l)),()=>{let a=e()||[],f=a.length,u,c;return a[ve],j(()=>{let m,d,$,E,I,A,x,h,v;if(f===0)o!==0&&(Oe(l),l=[],r=[],s=[],o=0,i&&(i=[])),n.fallback&&(r=[wt],s[0]=oe(_=>(l[0]=_,n.fallback())),o=1);else if(o===0){for(s=new Array(f),c=0;c<f;c++)r[c]=a[c],s[c]=oe(y);o=f}else{for($=new Array(f),E=new Array(f),i&&(I=new Array(f)),A=0,x=Math.min(o,f);A<x&&r[A]===a[A];A++);for(x=o-1,h=f-1;x>=A&&h>=A&&r[x]===a[h];x--,h--)$[h]=s[x],E[h]=l[x],i&&(I[h]=i[x]);for(m=new Map,d=new Array(h+1),c=h;c>=A;c--)v=a[c],u=m.get(v),d[c]=u===void 0?-1:u,m.set(v,c);for(u=A;u<=x;u++)v=r[u],c=m.get(v),c!==void 0&&c!==-1?($[c]=s[u],E[c]=l[u],i&&(I[c]=i[u]),c=d[c],m.set(v,c)):l[u]();for(c=A;c<f;c++)c in $?(s[c]=$[c],l[c]=E[c],i&&(i[c]=I[c],i[c](c))):s[c]=oe(y);s=s.slice(0,o=f),r=a.slice(0)}return s});function y(m){if(l[c]=m,i){const[d,$]=O(c);return i[c]=$,t(a[c],d)}return t(a[c])}}}function g(e,t){return j(()=>e(t||{}))}const Xe=e=>`Stale read from <${e}>.`;function Y(e){const t="fallback"in e&&{fallback:()=>e.fallback};return M(_t(()=>e.each,e.children,t||void 0))}function B(e){const t=e.keyed,n=M(()=>e.when,void 0,void 0),r=t?n:M(n,void 0,{equals:(s,l)=>!s==!l});return M(()=>{const s=r();if(s){const l=e.children;return typeof l=="function"&&l.length>0?j(()=>l(t?s:()=>{if(!j(r))throw Xe("Show");return n()})):l}return e.fallback},void 0,void 0)}function le(e){const t=Be(()=>e.children),n=M(()=>{const r=t(),s=Array.isArray(r)?r:[r];let l=()=>{};for(let o=0;o<s.length;o++){const i=o,a=s[o],f=l,u=M(()=>f()?void 0:a.when,void 0,void 0),c=a.keyed?u:M(u,void 0,{equals:(y,m)=>!y==!m});l=()=>f()||(c()?[i,u,a]:void 0)}return l});return M(()=>{const r=n()();if(!r)return e.fallback;const[s,l,o]=r,i=o.children;return typeof i=="function"&&i.length>0?j(()=>i(o.keyed?l():()=>{var f;if(((f=j(n)())==null?void 0:f[0])!==s)throw Xe("Match");return l()})):i},void 0,void 0)}function T(e){return e}const ie=e=>M(()=>e());function $t(e,t,n){let r=n.length,s=t.length,l=r,o=0,i=0,a=t[s-1].nextSibling,f=null;for(;o<s||i<l;){if(t[o]===n[i]){o++,i++;continue}for(;t[s-1]===n[l-1];)s--,l--;if(s===o){const u=l<r?i?n[i-1].nextSibling:n[l-i]:a;for(;i<l;)e.insertBefore(n[i++],u)}else if(l===i)for(;o<s;)(!f||!f.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[l-1]&&n[i]===t[s-1]){const u=t[--s].nextSibling;e.insertBefore(n[i++],t[o++].nextSibling),e.insertBefore(n[--l],u),t[s]=n[l]}else{if(!f){f=new Map;let c=i;for(;c<l;)f.set(n[c],c++)}const u=f.get(t[o]);if(u!=null)if(i<u&&u<l){let c=o,y=1,m;for(;++c<s&&c<l&&!((m=f.get(t[c]))==null||m!==u+y);)y++;if(y>u-i){const d=t[o];for(;i<u;)e.insertBefore(n[i++],d)}else e.replaceChild(n[i++],t[o++])}else o++;else t[o++].remove()}}}const Pe="_$DX_DELEGATE";function St(e,t,n,r={}){let s;return oe(l=>{s=l,t===document?e():b(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{s(),t.textContent=""}}function w(e,t,n,r){let s;const l=()=>{const i=document.createElement("template");return i.innerHTML=e,i.content.firstChild},o=()=>(s||(s=l())).cloneNode(!0);return o.cloneNode=o,o}function se(e,t=window.document){const n=t[Pe]||(t[Pe]=new Set);for(let r=0,s=e.length;r<s;r++){const l=e[r];n.has(l)||(n.add(l),t.addEventListener(l,At))}}function We(e,t,n,r){Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n}function Qe(e,t,n={}){const r=Object.keys(t||{}),s=Object.keys(n);let l,o;for(l=0,o=s.length;l<o;l++){const i=s[l];!i||i==="undefined"||t[i]||(Ie(e,i,!1),delete n[i])}for(l=0,o=r.length;l<o;l++){const i=r[l],a=!!t[i];!i||i==="undefined"||n[i]===a||!a||(Ie(e,i,!0),n[i]=a)}return n}function kt(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function xt(e,t,n){return j(()=>e(t,n))}function b(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return de(e,t,r,n);q(s=>de(e,t(),s,n),r)}function Ie(e,t,n){const r=t.trim().split(/\s+/);for(let s=0,l=r.length;s<l;s++)e.classList.toggle(r[s],n)}function At(e){let t=e.target;const n=`$$${e.type}`,r=e.target,s=e.currentTarget,l=a=>Object.defineProperty(e,"target",{configurable:!0,value:a}),o=()=>{const a=t[n];if(a&&!t.disabled){const f=t[`${n}Data`];if(f!==void 0?a.call(t,f,e):a.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&l(t.host),!0},i=()=>{for(;o()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const a=e.composedPath();l(a[0]);for(let f=0;f<a.length-2&&(t=a[f],!!o());f++){if(t._$host){t=t._$host,i();break}if(t.parentNode===s)break}}else i();l(r)}function de(e,t,n,r,s){for(;typeof n=="function";)n=n();if(t===n)return n;const l=typeof t,o=r!==void 0;if(e=o&&n[0]&&n[0].parentNode||e,l==="string"||l==="number"){if(l==="number"&&(t=t.toString(),t===n))return n;if(o){let i=n[0];i&&i.nodeType===3?i.data!==t&&(i.data=t):i=document.createTextNode(t),n=G(e,n,r,i)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||l==="boolean")n=G(e,n,r);else{if(l==="function")return q(()=>{let i=t();for(;typeof i=="function";)i=i();n=de(e,i,n,r)}),()=>n;if(Array.isArray(t)){const i=[],a=n&&Array.isArray(n);if($e(i,t,n,s))return q(()=>n=de(e,i,n,r,!0)),()=>n;if(i.length===0){if(n=G(e,n,r),o)return n}else a?n.length===0?Te(e,i,r):$t(e,n,i):(n&&G(e),Te(e,i));n=i}else if(t.nodeType){if(Array.isArray(n)){if(o)return n=G(e,n,r,t);G(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function $e(e,t,n,r){let s=!1;for(let l=0,o=t.length;l<o;l++){let i=t[l],a=n&&n[e.length],f;if(!(i==null||i===!0||i===!1))if((f=typeof i)=="object"&&i.nodeType)e.push(i);else if(Array.isArray(i))s=$e(e,i,a)||s;else if(f==="function")if(r){for(;typeof i=="function";)i=i();s=$e(e,Array.isArray(i)?i:[i],Array.isArray(a)?a:[a])||s}else e.push(i),s=!0;else{const u=String(i);a&&a.nodeType===3&&a.data===u?e.push(a):e.push(document.createTextNode(u))}}return s}function Te(e,t,n=null){for(let r=0,s=t.length;r<s;r++)e.insertBefore(t[r],n)}function G(e,t,n,r){if(n===void 0)return e.textContent="";const s=r||document.createTextNode("");if(t.length){let l=!1;for(let o=t.length-1;o>=0;o--){const i=t[o];if(s!==i){const a=i.parentNode===e;!l&&!o?a?e.replaceChild(s,i):e.insertBefore(s,n):a&&i.remove()}else l=!0}}else e.insertBefore(s,n);return[s]}const Se=Symbol("store-raw"),W=Symbol("store-node"),D=Symbol("store-has"),Je=Symbol("store-self");function Ze(e){let t=e[K];if(!t&&(Object.defineProperty(e,K,{value:t=new Proxy(e,Lt)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let s=0,l=n.length;s<l;s++){const o=n[s];r[o].get&&Object.defineProperty(e,o,{enumerable:r[o].enumerable,get:r[o].get.bind(t)})}}return t}function he(e){let t;return e!=null&&typeof e=="object"&&(e[K]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function te(e,t=new Set){let n,r,s,l;if(n=e!=null&&e[Se])return n;if(!he(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let o=0,i=e.length;o<i;o++)s=e[o],(r=te(s,t))!==s&&(e[o]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const o=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let a=0,f=o.length;a<f;a++)l=o[a],!i[l].get&&(s=e[l],(r=te(s,t))!==s&&(e[l]=r))}return e}function ge(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function ne(e,t,n){if(e[t])return e[t];const[r,s]=O(n,{equals:!1,internal:!0});return r.$=s,e[t]=r}function Ct(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===K||t===W||(delete n.value,delete n.writable,n.get=()=>e[K][t]),n}function ze(e){we()&&ne(ge(e,W),Je)()}function Et(e){return ze(e),Reflect.ownKeys(e)}const Lt={get(e,t,n){if(t===Se)return e;if(t===K)return n;if(t===ve)return ze(e),n;const r=ge(e,W),s=r[t];let l=s?s():e[t];if(t===W||t===D||t==="__proto__")return l;if(!s){const o=Object.getOwnPropertyDescriptor(e,t);we()&&(typeof l!="function"||e.hasOwnProperty(t))&&!(o&&o.get)&&(l=ne(r,t,l)())}return he(l)?Ze(l):l},has(e,t){return t===Se||t===K||t===ve||t===W||t===D||t==="__proto__"?!0:(we()&&ne(ge(e,D),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Et,getOwnPropertyDescriptor:Ct};function be(e,t,n,r=!1){if(!r&&e[t]===n)return;const s=e[t],l=e.length;n===void 0?(delete e[t],e[D]&&e[D][t]&&s!==void 0&&e[D][t].$()):(e[t]=n,e[D]&&e[D][t]&&s===void 0&&e[D][t].$());let o=ge(e,W),i;if((i=ne(o,t,s))&&i.$(()=>n),Array.isArray(e)&&e.length!==l){for(let a=e.length;a<l;a++)(i=o[a])&&i.$();(i=ne(o,"length",l))&&i.$(e.length)}(i=o[Je])&&i.$()}function et(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const s=n[r];be(e,s,t[s])}}function Mt(e,t){if(typeof t=="function"&&(t=t(e)),t=te(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const s=t[n];e[n]!==s&&be(e,n,s)}be(e,"length",r)}else et(e,t)}function Z(e,t,n=[]){let r,s=e;if(t.length>1){r=t.shift();const o=typeof r,i=Array.isArray(e);if(Array.isArray(r)){for(let a=0;a<r.length;a++)Z(e,[r[a]].concat(t),n);return}else if(i&&o==="function"){for(let a=0;a<e.length;a++)r(e[a],a)&&Z(e,[a].concat(t),n);return}else if(i&&o==="object"){const{from:a=0,to:f=e.length-1,by:u=1}=r;for(let c=a;c<=f;c+=u)Z(e,[c].concat(t),n);return}else if(t.length>1){Z(e[r],t,[r].concat(n));return}s=e[r],n=[r].concat(n)}let l=t[0];typeof l=="function"&&(l=l(s,n),l===s)||r===void 0&&l==null||(l=te(l),r===void 0||he(s)&&he(l)&&!Array.isArray(l)?et(s,l):be(e,r,l))}function ke(...[e,t]){const n=te(e||{}),r=Array.isArray(n),s=Ze(n);function l(...o){gt(()=>{r&&o.length===1?Mt(n,o[0]):Z(n,o)})}return[s,l]}const Ot=80,Pt=5,tt=1.7,nt=20,X=5,rt=100,lt=new Array(495).fill(1).map((e,t)=>Math.floor(Ot*Math.pow(t+1,tt))),xe=new Array(500).fill(1).map((e,t)=>Math.floor(Pt*Math.pow(t+1,tt))),st=(e,t=lt)=>{if(!e)return 0;const n=t.findIndex(l=>l>e),r=e-(t[n-1]??0),s=t[n]-(t[n-1]??0);return r/s},Le=(e,t=lt)=>t.findIndex(n=>n>e),it=Fe(),ye=new Event("tick"),It=e=>{const[t,n]=O(0),r=new EventTarget;Ce(()=>{setInterval(()=>{n(t()+1),r==null||r.dispatchEvent(ye)},rt)});const s=()=>r==null?void 0:r.dispatchEvent(ye);return g(it.Provider,{value:{evt:r,fire:s},get children(){return e.children}})},Tt=[{name:"hay_hand_1",label:"Hay hand wraps",stackable:!1,equipSlot:"hand",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{attMin:1,attMax:3}},{name:"hay_head_1",label:"Hay bandana",stackable:!1,equipSlot:"head",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{maxHealth:5}},{name:"hay_chest_1",label:"Hay vest",stackable:!1,equipSlot:"chest",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",50]],stats:{physRes:1}}],qt=[{name:"recipe_hay_hand_1",label:"Recipe: Hay hand wraps",stackable:!1,exclusive:!0,craftableItem:"hay_hand_1"},{name:"recipe_hay_head_1",label:"Recipe: Hay bandana",stackable:!1,exclusive:!0,craftableItem:"hay_head_1"},{name:"recipe_hay_chest_1",label:"Recipe: Hay vest",stackable:!1,exclusive:!0,craftableItem:"hay_chest_1"}].map(e=>({...e,use:t=>(t.player.recipes.includes(e.craftableItem)||(t.setPlayer("recipes",[...t.player.recipes,e.craftableItem]),t.setState("prohibitedItems",[...t.state.prohibitedItems,e.name])),t.removeInventory(e.name),!0)})),jt=[{name:"hay_1",label:"Hay",stackable:!0,maxStack:100},{name:"wood_1",label:"Wooden log",stackable:!0,maxStack:100}],F=[Tt,qt,jt].flat().reduce((e,t)=>(e[t.name]=t,e),{});var Dt=w("<span class=text-red-500>Fight scarecrows"),Nt=w('<span class="font-bold ml-1">'),Rt=w('<span class="font-bold text-blue-500 mr-1">Hay'),Ht=w("<span class=font-bold>"),Ft=w('<div class="font-bold m-2"><div>" .. Loathsome shadowed cloaks</div><div>Golden light shimmering, blind eyes</div><div>Fear, is Death knocking? .. "'),Bt=w('<div class="font-bold m-2"><div>" .. Am *I* the keeper of the wheat?</div><div>... or is it the keeper of me? .. "');const Vt=[{name:"story_town_1",label:"Town",description:"You are in town",type:"dialogue",options:[{label:"Visit Farm",goto:"story_farmer_1"},{label:"Home",goto:"story_home_1"}]},{name:"story_farmer_1",label:"Farm",description:"A vacant expressionless farmer. Hasn't washed in days.",type:"dialogue",options:[{label:"Approach the farmer",goto:"story_farmer_2"},{label:Dt(),goto:"story_scarecrows_1"},{label:"Sell Hay",action:e=>{const t=e.player.invent,{removeInventory:n,onAddStat:r}=e,s=t.filter(l=>(l==null?void 0:l.name)==="hay_1").reduce((l,o)=>l+((o==null?void 0:o.stack)??0),0);s&&(n("hay_1",s),r("gold",s),e.onLog(["You sell",(()=>{var l=Nt();return b(l,s),l})()," ",Rt(),"For ",(()=>{var l=Ht();return b(l,s),l})()," gold"],"meta"))}}]},{name:"story_farmer_2",label:"Farmer",description:["You approach, he holds your wrist loosely like an exhausted child.",Ft(),"He sits and cries."],type:"dialogue",options:[{label:"Console",goto:"story_farmer_3"},{label:"Leave",goto:"story_farmer_1"}]},{name:"story_farmer_3",label:"Farmer",description:Bt(),type:"dialogue",options:[{label:"Silently leave",goto:"story_farmer_1"}]},{name:"story_scarecrows_1",label:"Scarecrows",description:"Fighting scarecrows",type:"encounter",encounters:[{name:"enc_scarecrow_1",label:"Scarecrow",health:10,chance:1,experience:50,drops:[{name:"hay_1",chance:1},{name:"recipe_hay_hand_1",chance:.05},{name:"recipe_hay_head_1",chance:.05},{name:"recipe_hay_chest_1",chance:.05}]}]}],Ut=[{type:"craft",name:"bench_simple",label:"Simple crafting bench",cratingType:"basic",craftingComplexity:1}],Kt=Ut.reduce((e,t)=>(e[t.name]=t,e),{}),Yt=[{name:"story_home_1",label:"Home",description:"Home sweet home",type:"dialogue",options:[{label:"Build",goto:"story_home_2"},{label:"Stash",goto:"story_home_3"},{label:"Craft",goto:"story_home_4"}]},{name:"story_home_4",label:"Crafting",description:"A workshop",type:"dialogue",options:e=>e.state.furniture.map(t=>Kt[t]).filter(t=>t.type==="craft").map(t=>({label:t.label,goto:`story_craft_${t.cratingType}_1`}))},{name:"story_craft_basic_1",label:"Basic crafting",description:"A very simple crafting table",type:"dialogue",options:e=>e.player.recipes.map(t=>F[t]).filter(t=>t.craftType==="basic").map(t=>{var n;return{label:t.label,action:r=>Gt(r,t),isDisabled:!Xt(e,t),subtext:(n=t.ingredients)==null?void 0:n.map(r=>`${F[r[0]].label} (${r[1]})`).join(" - ")}})}],Gt=(e,t)=>{var n;e.addInventory(t),(n=t.ingredients)==null||n.forEach(r=>e.removeInventory(...r))},Xt=(e,t)=>{var n;return(n=t.ingredients)!=null&&n.length?t.ingredients.every(r=>e.player.invent.reduce((l,o)=>((o==null?void 0:o.name)===r[0]&&(l=l+(o.stack??1)),l),0)>=r[1]):!0},Ae=[Vt,Yt].flat().reduce((e,t)=>(e[t.name]=t,e),{});class Wt{constructor(t){L(this,"name");L(this,"label");L(this,"description");L(this,"type");L(this,"encounters");L(this,"duration");L(this,"cooldown");L(this,"items");L(this,"skills");L(this,"options");this.label=t.label,this.type=t.type,this.name=t.name,this.description=t.description,Object.assign(this,t)}getEncounter(){var n;const t=Math.random();if(!(this.type!=="encounter"||!((n=this.encounters)!=null&&n.length)))return this.encounters.sort((r,s)=>r.chance-s.chance).find(r=>t<=r.chance)}getDrops(t){var r;const n=(r=t.drops)==null?void 0:r.filter(s=>Math.random()<=s.chance);return n==null?void 0:n.map(s=>F[s.name]).filter(Boolean)}}const Qt=[{name:"unarmed",label:"Unarmed",bonus:new Array(501).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{attMin:t%10===0?1:0,attMax:1,attSpeed:t%50===0?.1:0}}}).filter(Boolean)}],ot=[Qt].flat().reduce((e,t)=>(e[t.name]=t,e),{}),Jt=(e,t)=>{const n=ot[e];if(!n)return{};const r=Le(t,xe),s=n.bonus.filter(l=>l.level<=r);return(s==null?void 0:s.reduce((l,o)=>(Object.entries(o.stats).forEach(([i,a])=>{l[i]=(l[i]??0)+a}),l),{}))??{}};class Zt{constructor(t={},n=new Array(nt).fill(null)){L(this,"equipment");L(this,"stats");L(this,"mastery");L(this,"invent");L(this,"recipes");this.equipment=t.equipment??[],this.mastery=t.mastery??{},this.recipes=t.recipes??[],this.stats=t.stats??{gold:0,experience:0,health:10,maxHealth:10,strength:1,agility:1,attSpeed:0},this.invent=n}weaponMastery(){var t;return((t=this.equipment.find(n=>n.equipSlot==="weapon"))==null?void 0:t.masteryType)??"unarmed"}getMasteryPerk(t){return Jt(t,this.mastery[t]??0)}attackDamage(){let t=this.equipment.reduce((a,f)=>{var u;return a+(((u=f.stats)==null?void 0:u.attMin)??0)},1),n=this.equipment.reduce((a,f)=>{var u;return a+(((u=f.stats)==null?void 0:u.attMax)??0)},1);const r=this.weaponMastery(),s=this.getMasteryPerk(r);t+=(s==null?void 0:s.attMin)??0,n+=(s==null?void 0:s.attMax)??0;const l=1+Math.pow((this.stats.strength??0)/100,.7),o=Math.round(t*l),i=Math.round(n*l);return[o,i]}attackRate(){const n=Math.min(100,Math.max(1,this.stats.agility??0)),r=1,s=X/5,l=Math.sqrt(n/100),o=s*l,i=X/5,a=Math.min(this.equipment.reduce((I,A)=>{var x;return I+(((x=A.stats)==null?void 0:x.attSpeed)??0)},0),1),f=a*i,u=X/5,c=this.weaponMastery(),y=this.getMasteryPerk(c),m=(y.attSpeed??0)*u,$=(X/2.5-1)*((l+a+(y.attSpeed??0))/3);return Math.max(X-o-f-$-m,r)}}class zt{constructor(t){L(this,"prohibitedItems");L(this,"furniture");this.prohibitedItems=[],this.furniture=[],Object.assign(this,t)}}const z="story_town_1",H=Fe(),qe=e=>new Wt(Ae[e]??Ae[z]),en=e=>{const[t,n]=O(qe(z)),[r,s]=ke(new Zt({})),[l,o]=ke(new zt({furniture:["bench_simple"]})),[i,a]=O([z]),[f,u]=O([]),c=(h,v=1)=>{if(typeof h=="string"){if(!F[h])return console.warn("Invalid or not found item",h),v;h=F[h]}let _=[...r.invent];if(h.exclusive&&_.find(p=>(p==null?void 0:p.name)===h.name))return 0;let S=v;return h.stackable&&h.maxStack&&(_=_.map(p=>{if(!(p!=null&&p.name)||!(p!=null&&p.stack)||!p.maxStack||!S)return p;if(p.name===h.name&&p.stack<p.maxStack){let U=Math.min(p.stack+S,p.maxStack);return S-=U-p.stack,{...p,stack:U}}return p})),S&&(_=_.map(p=>{if(!S)return p;if(p===null){const U=Math.min(S,h.maxStack??1);return S-=U,{...h,stack:U}}return p})),S<v&&s("invent",_),v-S},y=(h,v=1)=>{if(typeof h=="string"){if(!F[h])return console.warn("Invalid or not found item",h),!1;h=F[h]}if(r.invent.findLastIndex(p=>(p==null?void 0:p.name)===h.name)<0)return!1;const S=[...r.invent.toReversed().map(p=>{if(!v||(p==null?void 0:p.name)!==h.name||!(p!=null&&p.stack))return p;if(p.stack<=v)return v-=p.stack,null;const U=p.stack-v;return v=0,{...p,stack:U}}).reverse()].filter(Boolean);return S.push(...new Array(nt-S.length).fill(null)),s("invent",S),!0},m=h=>{if(h!=="_back"&&!Ae[h]){console.error(`Unknown story ${h}`);return}h==="_back"?(h=i().at(-2)??z,i().length>1&&a(i().slice(0,-1))):a([...i(),h]),n(qe(h))},d=(h,v=1)=>{const _=(r.stats[h]??0)+v;s("stats",h,_)},x={story:t,onNavigate:m,onAddStat:d,player:r,state:l,setState:o,setPlayer:s,addInventory:c,removeInventory:y,log:f,onLog:(h,v="basic")=>{var p;const _=new Date,S={msg:h,time:[_.getHours(),_.getMinutes(),_.getSeconds()].join(":"),type:v};u([...f().slice(Math.min(((p=f())==null?void 0:p.length)-999,0)),S])},onAddMastery:(h,v=1)=>{const _=(r.mastery[h]??0)+v;s("mastery",h,_)},onEquip:h=>{if(y(h)){let v=!1;return s("equipment",[...r.equipment.map(_=>_.equipSlot===h.equipSlot?(v=!0,Object.entries(_.stats??{}).forEach(([S,p])=>d(S,0-p)),c(_),h):_),...v?[]:[h]]),Object.entries(h.stats??{}).forEach(([_,S])=>d(_,S)),!0}return!1},onUnequip:h=>!!r.equipment.find(_=>_.name===h.name)&&c(h)?(s("equipment",[...r.equipment.filter(_=>_.name!==h.name)]),Object.entries(h.stats??{}).forEach(([_,S])=>d(_,0-S)),!0):!1};return g(H.Provider,{value:x,get children(){return e.children}})};var tn=w('<div class="flex flex-row mt-auto gap-2"><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Go back</div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Town'),nn=w('<div class="flex flex-col gap-5 p-2 h-full overflow-y-auto">'),rn=w("<div class=text-gray-500>Nothing here..."),ln=w('<span class="text-xs text-gray-400">'),sn=w('<div class="w-full border content-center h-12 text-lg font-bold flex flex-col justify-center">');const on=()=>{const e=R(H),t=r=>{if(r.goto)return e==null?void 0:e.onNavigate(r.goto);if(r.action&&e)return r.action(e)},n=M(()=>{const r=e==null?void 0:e.story().options;return Array.isArray(r)?r:(r==null?void 0:r(e))??[]});return(()=>{var r=nn();return b(r,g(B,{get when(){return n().length},get fallback(){return rn()},get children(){return g(Y,{get each(){return n()},children:s=>(()=>{var l=sn();return l.$$click=()=>!s.isDisabled&&t(s),b(l,()=>s.label,null),b(l,g(B,{get when(){return s.subtext},get children(){var o=ln();return b(o,()=>s.subtext),o}}),null),q(o=>{var i=!!s.isDisabled,a=!s.isDisabled;return i!==o.e&&l.classList.toggle("text-gray-500",o.e=i),a!==o.t&&l.classList.toggle("cursor-pointer",o.t=a),o},{e:void 0,t:void 0}),l})()})}}),null),b(r,g(B,{get when(){var s;return((s=e==null?void 0:e.story())==null?void 0:s.name)!==z},get children(){var s=tn(),l=s.firstChild,o=l.nextSibling;return l.$$click=()=>t({label:"Go back",goto:"_back"}),o.$$click=()=>t({label:"Back to town",goto:"story_town_1"}),s}}),null),r})()};se(["click"]);var an=w("<button>use"),cn=w("<button>equip"),un=w('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2"><div class="flex flex-col gap-2"><div> </div><div class="flex flex-row gap-1 justify-between"><button>drop</button><button>drop all'),fn=w('<div class="h-full relative"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2">'),dn=w('<div class="border p-1 cursor-pointer flex flex-row justify-between"><div></div><div>(<!>)');const hn=()=>{const e=R(H),[t,n]=O(),r=()=>{var o;const l=t();!l||!e||(o=l.use)!=null&&o.call(l,e)&&n(void 0)},s=()=>{const l=t();!l.equipSlot||!e||e.onEquip(l)&&n(void 0)};return(()=>{var l=fn(),o=l.firstChild;return o.$$click=()=>n(void 0),b(o,g(Y,{get each(){return(e==null?void 0:e.player.invent)??[]},children:i=>g(gn,{item:i,onSelect:()=>n(i)})})),b(l,g(B,{get when(){return t()},get children(){var i=un(),a=i.firstChild,f=a.firstChild,u=f.firstChild,c=f.nextSibling,y=c.firstChild,m=y.nextSibling;return b(f,()=>{var d;return(d=t())==null?void 0:d.label},u),b(f,()=>{var d;return(d=t())==null?void 0:d.equipSlot},null),y.$$click=()=>e==null?void 0:e.removeInventory(t()),m.$$click=()=>e==null?void 0:e.removeInventory(t(),1/0),b(c,g(B,{get when(){var d;return(d=t())==null?void 0:d.use},get children(){var d=an();return d.$$click=r,d}}),null),b(c,g(B,{get when(){return t().equipSlot},get children(){var d=cn();return d.$$click=s,d}}),null),i}}),null),l})()},gn=e=>{const t=n=>{n.stopPropagation(),e.onSelect()};return g(B,{get when(){return e.item},get children(){var n=dn(),r=n.firstChild,s=r.nextSibling,l=s.firstChild,o=l.nextSibling;return o.nextSibling,n.$$click=t,b(r,()=>{var i;return(i=e.item)==null?void 0:i.label}),b(s,()=>{var i;return(i=e.item)==null?void 0:i.stack},o),n}})};se(["click"]);var bn=w('<div class="w-full h-full border rounded relative text-black bg-gray-500"><div class="ease-linear w-0 h-full rounded"></div><div class="absolute left-1/2 top-1/2 -translate-1/2 whitespace-nowrap">');const yn=e=>{const t=R(it),[n,r]=O(e.ticks),s=()=>{let l=n();l<=0&&(e.onFinish(),l=e.ticks+1),r(l-1)};return Ce(()=>t==null?void 0:t.evt.addEventListener(ye.type,s)),He(()=>t==null?void 0:t.evt.removeEventListener(ye.type,s)),g(Me,{get max(){return e.ticks},get value(){return e.ticks-n()},get type(){return e.type},get showPc(){return e.showPc},get showNumber(){return e.showNumber},get label(){return e.label}})},Me=e=>{const t=M(()=>Math.min(e.value/e.max*100,100));return(()=>{var n=bn(),r=n.firstChild,s=r.nextSibling;return b(s,g(le,{get children(){return[g(T,{get when(){return e.showPc},get children(){return[ie(()=>e.label)," (",ie(()=>t().toFixed(0)),"%)"]}}),g(T,{get when(){return e.showNumber},get children(){return[ie(()=>e.label)," ",ie(()=>e.value)]}})]}})),q(l=>{var o=t()+"%",i=!e.type,a=e.type==="green",f=e.type==="yellow",u=e.type==="blue",c=e.type==="red";return o!==l.e&&kt(r,"width",l.e=o),i!==l.t&&r.classList.toggle("bg-white",l.t=i),a!==l.a&&r.classList.toggle("bg-green-500",l.a=a),f!==l.o&&r.classList.toggle("bg-yellow-500",l.o=f),u!==l.i&&r.classList.toggle("bg-blue-500",l.i=u),c!==l.n&&r.classList.toggle("bg-red-500",l.n=c),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),n})()};var pn=w('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Skills</button><button>Mastery</button><button>Recipes'),mn=w('<div class="flex flex-row justify-between items-center"><div></div><div class="h-4 w-32">'),vn=w('<div class="flex flex-row justify-between items-center"><div>');const je=()=>{const[e,t]=O("mastery"),n=R(H),r=M(()=>Object.entries((n==null?void 0:n.player.mastery)??{}).map(([l,o])=>{const i=ot[l];return{label:i==null?void 0:i.label,progress:st(o,xe)*100,level:Le(o,xe)}})),s=M(()=>(n==null?void 0:n.player.recipes.map(l=>F[l]))??[]);return(()=>{var l=pn(),o=l.firstChild,i=o.nextSibling,a=i.firstChild,f=a.nextSibling,u=f.nextSibling;return b(o,g(le,{get children(){return[g(T,{get when(){return e()==="skills"},children:"TODO"}),g(T,{get when(){return e()==="mastery"},get children(){return g(Y,{get each(){return r()},children:c=>(()=>{var y=mn(),m=y.firstChild,d=m.nextSibling;return b(m,()=>c.label),b(d,g(Me,{get label(){return`${c.level}`},type:"yellow",max:100,get value(){return c.progress},showPc:!0})),y})()})}}),g(T,{get when(){return e()==="recipes"},get children(){return g(Y,{get each(){return s()},children:c=>(()=>{var y=vn(),m=y.firstChild;return b(m,()=>c.label),y})()})}})]}})),a.$$click=()=>t("skills"),f.$$click=()=>t("mastery"),u.$$click=()=>t("recipes"),q(c=>{var y=e()==="skills",m=e()==="mastery",d=e()==="recipes";return y!==c.e&&a.classList.toggle("selected",c.e=y),m!==c.t&&f.classList.toggle("selected",c.t=m),d!==c.a&&u.classList.toggle("selected",c.a=d),c},{e:void 0,t:void 0,a:void 0}),l})()};se(["click"]);var wn=w('<span class="text-red-800 font-bold">'),_n=w('<span class="text-green-800 font-bold">'),$n=w('<span class="text-red-800 font-bold m-1">'),Sn=w('<span class="font-bold m-1">'),kn=w("<div class=text-red-800>"),De=w("<div class=h-8>"),xn=w('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>Attacking (<!>)');const An=()=>{const e=R(H),[t,n]=O(25),[r,s]=O(0),[l,o]=O(),[i,a]=O();Ce(()=>{var u;n((e==null?void 0:e.player.attackRate())??25),a(e==null?void 0:e.story().getEncounter()),o((u=i())==null?void 0:u.health)});const f=()=>{var A,x;const[u,c]=[e==null?void 0:e.player,e==null?void 0:e.story()],y=i(),m=l();if(!u||!c)return;if(n((e==null?void 0:e.player.attackRate())??25),!y){a(e==null?void 0:e.story().getEncounter()),o((A=i())==null?void 0:A.health);return}if(!m)return;const[d,$]=(e==null?void 0:e.player.attackDamage())??[0,1],E=d+Math.round(Math.random()*($-d)),I=m-Math.min(E,m);if(e==null||e.onLog(["You hit the ",(()=>{var h=wn();return b(h,y.label),h})()," for ",(()=>{var h=_n();return b(h,E),h})()," damage"],"basic"),e==null||e.onAddMastery(e.player.weaponMastery(),E),I<=0){e==null||e.onLog(["You killed the",(()=>{var v=$n();return b(v,y.label),v})()],"good"),s(r()+1),a(void 0),y.experience&&(e==null||e.onAddStat("experience",y.experience));const h=(x=c.getDrops(y))==null?void 0:x.filter(v=>!(e!=null&&e.state.prohibitedItems.includes(v.name))).filter(v=>!!(e!=null&&e.addInventory(v)));return h!=null&&h.length&&(e==null||e.onLog(["It dropped:",(()=>{var v=Sn();return b(v,h==null?void 0:h.map(_=>_.label).join(", ")),v})()],"drop")),f()}o(Math.max(I,0))};return(()=>{var u=xn(),c=u.firstChild,y=c.firstChild,m=y.nextSibling;return m.nextSibling,b(c,r,m),b(u,g(B,{get when(){return i()},get children(){return[(()=>{var d=kn();return b(d,()=>{var $;return($=i())==null?void 0:$.label}),d})(),(()=>{var d=De();return b(d,g(yn,{get ticks(){return t()},onFinish:f,label:"Attack",showPc:!0})),d})(),(()=>{var d=De();return b(d,g(Me,{type:"red",get max(){return i().health},get value(){return l()},label:"Health",showNumber:!0})),d})()]}}),null),u})()};var Cn=w('<div class="text-lg font-bold mt-5">Weapon'),En=w('<div class="text-lg font-bold mt-5">Armour'),Ln=w('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Equip</button><button>Stats'),Mn=w('<div class="flex flex-row justify-between border-gray-700"><div></div><div>'),On=w('<div class="flex flex-row justify-between items-center border-gray-700"><div></div><div class="text-xs text-gray-500">');const Pn=()=>{const[e,t]=O("stats"),n=R(H),r=M(()=>{const l=n==null?void 0:n.player.attackDamage(),o=1e3/rt,i=1/(((n==null?void 0:n.player.attackRate())??X)/o);return[{label:"Health",value:(n==null?void 0:n.player.stats.health)??0},{label:"Max health",value:(n==null?void 0:n.player.stats.maxHealth)??0},{label:"",value:" "},{label:"Att. min",value:(l==null?void 0:l.at(0))??0},{label:"Att. max",value:(l==null?void 0:l.at(1))??0},{label:"Att. rate",value:`${(i==null?void 0:i.toFixed(2))??0} p/s`},{label:"",value:" "},{label:"Phys. res",value:(n==null?void 0:n.player.stats.physRes)??0},{label:"Mag. res",value:(n==null?void 0:n.player.stats.magRes)??0}]}),s=M(()=>{const l=["weapon","offhand"],o=["head","shoulder","chest","hand","leg","foot"];return[{label:Cn(),isDisabled:!1,isEmpty:!0},...l.map(i=>{const a=i&&(n==null?void 0:n.player.equipment.find(f=>f.equipSlot===i));return{label:(a==null?void 0:a.label)??i,isDisabled:!a,subtext:Object.entries((a==null?void 0:a.stats)??{}).map(([f,u])=>`[${f}: ${u}]`).join(""),onClick:a?()=>n==null?void 0:n.onUnequip(a):void 0}}),{label:En(),isDisabled:!1,isEmpty:!0},...o.map(i=>{const a=i&&(n==null?void 0:n.player.equipment.find(f=>f.equipSlot===i));return{label:(a==null?void 0:a.label)??i,isDisabled:!a,subtext:Object.entries((a==null?void 0:a.stats)??{}).map(([f,u])=>`[${f}: ${u}]`).join(""),onClick:a?()=>n==null?void 0:n.onUnequip(a):void 0}})]});return(()=>{var l=Ln(),o=l.firstChild,i=o.nextSibling,a=i.firstChild,f=a.nextSibling;return b(o,g(le,{get children(){return[g(T,{get when(){return e()==="stats"},get children(){return g(Y,{get each(){return r()},children:u=>(()=>{var c=Mn(),y=c.firstChild,m=y.nextSibling;return b(y,()=>u.label),b(m,()=>u.value),q(()=>c.classList.toggle("border-b",!!u.label)),c})()})}}),g(T,{get when(){return e()==="equip"},get children(){return g(Y,{get each(){return s()},children:u=>(()=>{var c=On(),y=c.firstChild,m=y.nextSibling;return We(c,"click",u.onClick),b(y,()=>u.label),b(m,()=>u.subtext),q(d=>{var $=!u.isEmpty,E=!!u.isDisabled;return $!==d.e&&c.classList.toggle("border-b",d.e=$),E!==d.t&&y.classList.toggle("text-gray-700",d.t=E),d},{e:void 0,t:void 0}),c})()})}})]}})),a.$$click=()=>t("equip"),f.$$click=()=>t("stats"),q(u=>{var c=e()==="equip",y=e()==="stats";return c!==u.e&&a.classList.toggle("selected",u.e=c),y!==u.t&&f.classList.toggle("selected",u.t=y),u},{e:void 0,t:void 0}),l})()};se(["click"]);var In=w('<div class="w-dvw h-dvh lg:w-[360px] lg:h-[800px] flex flex-col justify-between"><div class="h-3/10 bg-gray-400"><div class=h-1/10></div><div class=h-9/10></div></div><div class=h-1/10></div><div class="h-5/10 bg-gray-800">'),Tn=w("<div>Unknown view"),qn=w('<div class="h-1/10 w-full flex flex-row justify-between font-bold">'),jn=w('<div class="flex flex-col gap-2 p-1 h-full"><div class="bg-black text-left pl-1"></div><div class="text-black whitespace-pre-wrap text-left overflow-y-auto text-sm">'),Dn=w('<div class="h-full bg-white flex flex-row"><div class="text-black bottom-0 left-0 border border-gray-100 p-1 flex flex-col gap-1 bg-white"><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide bad"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide good"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide meta"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide drop"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide basic"></div></div><div class="text-black h-full overflow-y-auto flex flex-col w-full">'),Nn=w('<div class="flex flex-row items-center px-1 transition-colors duration-500 border-t border-gray-200"><div class="text-xs text-blue-400 mr-1">[<!>]</div><div class="text-wrap text-xs text-left">'),Rn=w('<div class="flex flex-row bg-black px-1 justify-between"><div class=text-red-500>HP <!>/</div><div class=text-yellow-500>Gold </div><div class=text-green-500>Lvl <!> (<!>%)'),Hn=w('<div class="content-center w-1/4 border border-l-0 cursor-pointer last:border-r-0">');function Fn(){const[e,t]=O("story");return g(en,{get children(){return g(It,{get children(){var n=In(),r=n.firstChild,s=r.firstChild,l=s.nextSibling,o=r.nextSibling,i=o.nextSibling;return b(s,g(Kn,{})),b(l,g(Vn,{})),b(o,g(Un,{})),b(i,g(le,{get fallback(){return Tn()},get children(){return[g(T,{get when(){return e()==="story"},get children(){return g(on,{})}}),g(T,{get when(){return e()==="invent"},get children(){return g(hn,{})}}),g(T,{get when(){return e()==="skills"},get children(){return g(je,{})}}),g(T,{get when(){return e()==="stats"},get children(){return g(Pn,{})}}),g(T,{get when(){return e()==="menu"},get children(){return g(je,{})}})]}})),b(n,g(Bn,{onChange:t,get view(){return e()}}),null),n}})}})}const Bn=e=>(()=>{var t=qn();return b(t,g(J,{label:"Story",onClick:()=>e.onChange("story"),get view(){return e.view},type:"story"}),null),b(t,g(J,{label:"Invent",onClick:()=>e.onChange("invent"),get view(){return e.view},type:"invent"}),null),b(t,g(J,{label:"Skills",onClick:()=>e.onChange("skills"),get view(){return e.view},type:"skills"}),null),b(t,g(J,{label:"Stats",onClick:()=>e.onChange("stats"),get view(){return e.view},type:"stats"}),null),b(t,g(J,{label:"Menu",onClick:()=>e.onChange("menu"),get view(){return e.view},type:"menu"}),null),t})(),Vn=()=>{const e=R(H);return g(le,{get children(){return[g(T,{get when(){return(e==null?void 0:e.story().type)==="dialogue"},get children(){var t=jn(),n=t.firstChild,r=n.nextSibling;return b(n,()=>(e==null?void 0:e.story().label)??"Story"),b(r,()=>e==null?void 0:e.story().description),t}}),g(T,{get when(){return(e==null?void 0:e.story().type)==="encounter"},get children(){return g(An,{})}})]}})},Un=()=>{const[e,t]=O(),{log:n}=R(H)??{},[r,s]=ke({good:!0,bad:!0,meta:!0,drop:!0,basic:!0}),l=M(()=>{const o=e();if(!o)return;const i=o.scrollTop+o.clientHeight>o.scrollHeight-10;return setTimeout(()=>i&&o.scrollTo(0,o.scrollHeight??0)),n==null?void 0:n().filter(a=>r[a.type])});return(()=>{var o=Dn(),i=o.firstChild,a=i.firstChild,f=a.nextSibling,u=f.nextSibling,c=u.nextSibling,y=c.nextSibling,m=i.nextSibling;return a.$$click=()=>s("bad",!r.bad),f.$$click=()=>s("good",!r.good),u.$$click=()=>s("meta",!r.meta),c.$$click=()=>s("drop",!r.drop),y.$$click=()=>s("basic",!r.basic),xt(t,m),b(m,g(Y,{get each(){return l()},children:d=>(()=>{var $=Nn(),E=$.firstChild,I=E.firstChild,A=I.nextSibling;A.nextSibling;var x=E.nextSibling;return b(E,()=>d.time,A),b(x,()=>d.msg),q(h=>Qe($,{"last:bg-red-500 last:text-white bg-red-200":d.type==="bad","last:bg-green-500 last:text-white bg-green-200":d.type==="good","last:bg-yellow-500 bg-yellow-200":d.type==="meta","last:bg-blue-500 last:text-white bg-blue-200":d.type==="drop"},h)),$})()})),q(d=>{var $=!r.bad,E=!!r.bad,I=!r.good,A=!!r.good,x=!r.meta,h=!!r.meta,v=!r.drop,_=!!r.drop,S=!r.basic,p=!!r.basic;return $!==d.e&&a.classList.toggle("bg-red-100",d.e=$),E!==d.t&&a.classList.toggle("bg-red-500",d.t=E),I!==d.a&&f.classList.toggle("bg-green-100",d.a=I),A!==d.o&&f.classList.toggle("bg-green-500",d.o=A),x!==d.i&&u.classList.toggle("bg-yellow-100",d.i=x),h!==d.n&&u.classList.toggle("bg-yellow-500",d.n=h),v!==d.s&&c.classList.toggle("bg-blue-100",d.s=v),_!==d.h&&c.classList.toggle("bg-blue-500",d.h=_),S!==d.r&&y.classList.toggle("bg-gray-100",d.r=S),p!==d.d&&y.classList.toggle("bg-gray-500",d.d=p),d},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),o})()},Kn=()=>{const e=R(H);return(()=>{var t=Rn(),n=t.firstChild,r=n.firstChild,s=r.nextSibling;s.nextSibling;var l=n.nextSibling;l.firstChild;var o=l.nextSibling,i=o.firstChild,a=i.nextSibling,f=a.nextSibling,u=f.nextSibling;return u.nextSibling,b(n,()=>e==null?void 0:e.player.stats.health,s),b(n,()=>e==null?void 0:e.player.stats.maxHealth,null),b(l,()=>e==null?void 0:e.player.stats.gold,null),b(o,()=>Le((e==null?void 0:e.player.stats.experience)??0),a),b(o,()=>(st((e==null?void 0:e.player.stats.experience)??0)*100).toFixed(0),u),t})()},J=e=>(()=>{var t=Hn();return We(t,"click",e.onClick),b(t,()=>e.label),q(n=>Qe(t,{"border-t-0 bg-gray-800":e.view===e.type},n)),t})();se(["click"]);const Yn=document.getElementById("root");St(()=>g(Fn,{}),Yn);
