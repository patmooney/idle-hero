var kt=Object.defineProperty;var xt=(e,t,n)=>t in e?kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var M=(e,t,n)=>xt(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const Ct=!1,At=(e,t)=>e===t,ne=Symbol("solid-proxy"),Oe=Symbol("solid-track"),me={equals:At};let tt=ot;const ee=1,_e=2,nt={owned:null,cleanups:null,context:null,owner:null};var I=null;let je=null,Lt=null,O=null,B=null,G=null,Ee=0;function pe(e,t){const n=O,l=I,s=e.length===0,r=t===void 0?l:t,i=s?nt:{owned:null,cleanups:null,context:r?r.context:null,owner:r},a=s?e:()=>e(()=>K(()=>de(i)));I=i,O=null;try{return oe(a,!0)}finally{O=n,I=l}}function j(e,t){t=t?Object.assign({},me,t):me;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},l=s=>(typeof s=="function"&&(s=s(n.value)),it(n,s));return[at.bind(n),l]}function U(e,t,n){const l=Ue(e,t,!1,ee);ye(l)}function ve(e,t,n){tt=Tt;const l=Ue(e,t,!1,ee);l.user=!0,G?G.push(l):ye(l)}function T(e,t,n){n=n?Object.assign({},me,n):me;const l=Ue(e,t,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=n.equals||void 0,ye(l),at.bind(l)}function lt(e){return oe(e,!1)}function K(e){if(O===null)return e();const t=O;O=null;try{return e()}finally{O=t}}function ge(e){ve(()=>K(e))}function Me(e){return I===null||(I.cleanups===null?I.cleanups=[e]:I.cleanups.push(e)),e}function qe(){return O}function rt(e,t){const n=Symbol("context");return{id:n,Provider:jt(n),defaultValue:e}}function V(e){let t;return I&&I.context&&(t=I.context[e.id])!==void 0?t:e.defaultValue}function st(e){const t=T(e),n=T(()=>Pe(t()));return n.toArray=()=>{const l=n();return Array.isArray(l)?l:l!=null?[l]:[]},n}function at(){if(this.sources&&this.state)if(this.state===ee)ye(this);else{const e=B;B=null,oe(()=>$e(this),!1),B=e}if(O){const e=this.observers?this.observers.length:0;O.sources?(O.sources.push(this),O.sourceSlots.push(e)):(O.sources=[this],O.sourceSlots=[e]),this.observers?(this.observers.push(O),this.observerSlots.push(O.sources.length-1)):(this.observers=[O],this.observerSlots=[O.sources.length-1])}return this.value}function it(e,t,n){let l=e.value;return(!e.comparator||!e.comparator(l,t))&&(e.value=t,e.observers&&e.observers.length&&oe(()=>{for(let s=0;s<e.observers.length;s+=1){const r=e.observers[s],i=je&&je.running;i&&je.disposed.has(r),(i?!r.tState:!r.state)&&(r.pure?B.push(r):G.push(r),r.observers&&ct(r)),i||(r.state=ee)}if(B.length>1e6)throw B=[],new Error},!1)),t}function ye(e){if(!e.fn)return;de(e);const t=Ee;Et(e,e.value,t)}function Et(e,t,n){let l;const s=I,r=O;O=I=e;try{l=e.fn(t)}catch(i){return e.pure&&(e.state=ee,e.owned&&e.owned.forEach(de),e.owned=null),e.updatedAt=n+1,ut(i)}finally{O=r,I=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?it(e,l):e.value=l,e.updatedAt=n)}function Ue(e,t,n,l=ee,s){const r={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:I,context:I?I.context:null,pure:n};return I===null||I!==nt&&(I.owned?I.owned.push(r):I.owned=[r]),r}function we(e){if(e.state===0)return;if(e.state===_e)return $e(e);if(e.suspense&&K(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Ee);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===ee)ye(e);else if(e.state===_e){const l=B;B=null,oe(()=>$e(e,t[0]),!1),B=l}}function oe(e,t){if(B)return e();let n=!1;t||(B=[]),G?n=!0:G=[],Ee++;try{const l=e();return Mt(n),l}catch(l){n||(G=null),B=null,ut(l)}}function Mt(e){if(B&&(ot(B),B=null),e)return;const t=G;G=null,t.length&&oe(()=>tt(t),!1)}function ot(e){for(let t=0;t<e.length;t++)we(e[t])}function Tt(e){let t,n=0;for(t=0;t<e.length;t++){const l=e[t];l.user?e[n++]=l:we(l)}for(t=0;t<n;t++)we(e[t])}function $e(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const l=e.sources[n];if(l.sources){const s=l.state;s===ee?l!==t&&(!l.updatedAt||l.updatedAt<Ee)&&we(l):s===_e&&$e(l,t)}}}function ct(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=_e,n.pure?B.push(n):G.push(n),n.observers&&ct(n))}}function de(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),l=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const r=s.pop(),i=n.observerSlots.pop();l<s.length&&(r.sourceSlots[i]=l,s[l]=r,n.observerSlots[l]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)de(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)de(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function It(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ut(e,t=I){throw It(e)}function Pe(e){if(typeof e=="function"&&!e.length)return Pe(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const l=Pe(e[n]);Array.isArray(l)?t.push.apply(t,l):t.push(l)}return t}return e}function jt(e,t){return function(l){let s;return U(()=>s=K(()=>(I.context={...I.context,[e]:l.value},st(()=>l.children))),void 0),s}}const Ot=Symbol("fallback");function Xe(e){for(let t=0;t<e.length;t++)e[t]()}function qt(e,t,n={}){let l=[],s=[],r=[],i=0,a=t.length>1?[]:null;return Me(()=>Xe(r)),()=>{let o=e()||[],d=o.length,u,c;return o[Oe],K(()=>{let p,m,E,x,A,C,k,$,L;if(d===0)i!==0&&(Xe(r),r=[],l=[],s=[],i=0,a&&(a=[])),n.fallback&&(l=[Ot],s[0]=pe(P=>(r[0]=P,n.fallback())),i=1);else if(i===0){for(s=new Array(d),c=0;c<d;c++)l[c]=o[c],s[c]=pe(y);i=d}else{for(E=new Array(d),x=new Array(d),a&&(A=new Array(d)),C=0,k=Math.min(i,d);C<k&&l[C]===o[C];C++);for(k=i-1,$=d-1;k>=C&&$>=C&&l[k]===o[$];k--,$--)E[$]=s[k],x[$]=r[k],a&&(A[$]=a[k]);for(p=new Map,m=new Array($+1),c=$;c>=C;c--)L=o[c],u=p.get(L),m[c]=u===void 0?-1:u,p.set(L,c);for(u=C;u<=k;u++)L=l[u],c=p.get(L),c!==void 0&&c!==-1?(E[c]=s[u],x[c]=r[u],a&&(A[c]=a[u]),c=m[c],p.set(L,c)):r[u]();for(c=C;c<d;c++)c in E?(s[c]=E[c],r[c]=x[c],a&&(a[c]=A[c],a[c](c))):s[c]=pe(y);s=s.slice(0,i=d),l=o.slice(0)}return s});function y(p){if(r[c]=p,a){const[m,E]=j(c);return a[c]=E,t(o[c],m)}return t(o[c])}}}function g(e,t){return K(()=>e(t||{}))}const ft=e=>`Stale read from <${e}>.`;function z(e){const t="fallback"in e&&{fallback:()=>e.fallback};return T(qt(()=>e.each,e.children,t||void 0))}function q(e){const t=e.keyed,n=T(()=>e.when,void 0,void 0),l=t?n:T(n,void 0,{equals:(s,r)=>!s==!r});return T(()=>{const s=l();if(s){const r=e.children;return typeof r=="function"&&r.length>0?K(()=>r(t?s:()=>{if(!K(l))throw ft("Show");return n()})):r}return e.fallback},void 0,void 0)}function be(e){const t=st(()=>e.children),n=T(()=>{const l=t(),s=Array.isArray(l)?l:[l];let r=()=>{};for(let i=0;i<s.length;i++){const a=i,o=s[i],d=r,u=T(()=>d()?void 0:o.when,void 0,void 0),c=o.keyed?u:T(u,void 0,{equals:(y,p)=>!y==!p});r=()=>d()||(c()?[a,u,o]:void 0)}return r});return T(()=>{const l=n()();if(!l)return e.fallback;const[s,r,i]=l,a=i.children;return typeof a=="function"&&a.length>0?K(()=>a(i.keyed?r():()=>{var d;if(((d=K(n)())==null?void 0:d[0])!==s)throw ft("Match");return r()})):a},void 0,void 0)}function N(e){return e}const te=e=>T(()=>e());function Pt(e,t,n){let l=n.length,s=t.length,r=l,i=0,a=0,o=t[s-1].nextSibling,d=null;for(;i<s||a<r;){if(t[i]===n[a]){i++,a++;continue}for(;t[s-1]===n[r-1];)s--,r--;if(s===i){const u=r<l?a?n[a-1].nextSibling:n[r-a]:o;for(;a<r;)e.insertBefore(n[a++],u)}else if(r===a)for(;i<s;)(!d||!d.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[r-1]&&n[a]===t[s-1]){const u=t[--s].nextSibling;e.insertBefore(n[a++],t[i++].nextSibling),e.insertBefore(n[--r],u),t[s]=n[r]}else{if(!d){d=new Map;let c=a;for(;c<r;)d.set(n[c],c++)}const u=d.get(t[i]);if(u!=null)if(a<u&&u<r){let c=i,y=1,p;for(;++c<s&&c<r&&!((p=d.get(t[c]))==null||p!==u+y);)y++;if(y>u-a){const m=t[i];for(;a<u;)e.insertBefore(n[a++],m)}else e.replaceChild(n[a++],t[i++])}else i++;else t[i++].remove()}}}const Ge="_$DX_DELEGATE";function Dt(e,t,n,l={}){let s;return pe(r=>{s=r,t===document?e():b(t,e(),t.firstChild?null:void 0,n)},l.owner),()=>{s(),t.textContent=""}}function v(e,t,n,l){let s;const r=()=>{const a=document.createElement("template");return a.innerHTML=e,a.content.firstChild},i=()=>(s||(s=r())).cloneNode(!0);return i.cloneNode=i,i}function re(e,t=window.document){const n=t[Ge]||(t[Ge]=new Set);for(let l=0,s=e.length;l<s;l++){const r=e[l];n.has(r)||(n.add(r),t.addEventListener(r,Ht))}}function We(e,t,n,l){Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n}function dt(e,t,n={}){const l=Object.keys(t||{}),s=Object.keys(n);let r,i;for(r=0,i=s.length;r<i;r++){const a=s[r];!a||a==="undefined"||t[a]||(ze(e,a,!1),delete n[a])}for(r=0,i=l.length;r<i;r++){const a=l[r],o=!!t[a];!a||a==="undefined"||n[a]===o||!o||(ze(e,a,!0),n[a]=o)}return n}function Rt(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function Nt(e,t,n){return K(()=>e(t,n))}function b(e,t,n,l){if(n!==void 0&&!l&&(l=[]),typeof t!="function")return Se(e,t,l,n);U(s=>Se(e,t(),s,n),l)}function ze(e,t,n){const l=t.trim().split(/\s+/);for(let s=0,r=l.length;s<r;s++)e.classList.toggle(l[s],n)}function Ht(e){let t=e.target;const n=`$$${e.type}`,l=e.target,s=e.currentTarget,r=o=>Object.defineProperty(e,"target",{configurable:!0,value:o}),i=()=>{const o=t[n];if(o&&!t.disabled){const d=t[`${n}Data`];if(d!==void 0?o.call(t,d,e):o.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&r(t.host),!0},a=()=>{for(;i()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const o=e.composedPath();r(o[0]);for(let d=0;d<o.length-2&&(t=o[d],!!i());d++){if(t._$host){t=t._$host,a();break}if(t.parentNode===s)break}}else a();r(l)}function Se(e,t,n,l,s){for(;typeof n=="function";)n=n();if(t===n)return n;const r=typeof t,i=l!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,r==="string"||r==="number"){if(r==="number"&&(t=t.toString(),t===n))return n;if(i){let a=n[0];a&&a.nodeType===3?a.data!==t&&(a.data=t):a=document.createTextNode(t),n=se(e,n,l,a)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||r==="boolean")n=se(e,n,l);else{if(r==="function")return U(()=>{let a=t();for(;typeof a=="function";)a=a();n=Se(e,a,n,l)}),()=>n;if(Array.isArray(t)){const a=[],o=n&&Array.isArray(n);if(De(a,t,n,s))return U(()=>n=Se(e,a,n,l,!0)),()=>n;if(a.length===0){if(n=se(e,n,l),i)return n}else o?n.length===0?Je(e,a,l):Pt(e,n,a):(n&&se(e),Je(e,a));n=a}else if(t.nodeType){if(Array.isArray(n)){if(i)return n=se(e,n,l,t);se(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function De(e,t,n,l){let s=!1;for(let r=0,i=t.length;r<i;r++){let a=t[r],o=n&&n[e.length],d;if(!(a==null||a===!0||a===!1))if((d=typeof a)=="object"&&a.nodeType)e.push(a);else if(Array.isArray(a))s=De(e,a,o)||s;else if(d==="function")if(l){for(;typeof a=="function";)a=a();s=De(e,Array.isArray(a)?a:[a],Array.isArray(o)?o:[o])||s}else e.push(a),s=!0;else{const u=String(a);o&&o.nodeType===3&&o.data===u?e.push(o):e.push(document.createTextNode(u))}}return s}function Je(e,t,n=null){for(let l=0,s=t.length;l<s;l++)e.insertBefore(t[l],n)}function se(e,t,n,l){if(n===void 0)return e.textContent="";const s=l||document.createTextNode("");if(t.length){let r=!1;for(let i=t.length-1;i>=0;i--){const a=t[i];if(s!==a){const o=a.parentNode===e;!r&&!i?o?e.replaceChild(s,a):e.insertBefore(s,n):o&&a.remove()}else r=!0}}else e.insertBefore(s,n);return[s]}const Re=Symbol("store-raw"),ie=Symbol("store-node"),X=Symbol("store-has"),ht=Symbol("store-self");function gt(e){let t=e[ne];if(!t&&(Object.defineProperty(e,ne,{value:t=new Proxy(e,Vt)}),!Array.isArray(e))){const n=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let s=0,r=n.length;s<r;s++){const i=n[s];l[i].get&&Object.defineProperty(e,i,{enumerable:l[i].enumerable,get:l[i].get.bind(t)})}}return t}function ke(e){let t;return e!=null&&typeof e=="object"&&(e[ne]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function le(e,t=new Set){let n,l,s,r;if(n=e!=null&&e[Re])return n;if(!ke(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,a=e.length;i<a;i++)s=e[i],(l=le(s,t))!==s&&(e[i]=l)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),a=Object.getOwnPropertyDescriptors(e);for(let o=0,d=i.length;o<d;o++)r=i[o],!a[r].get&&(s=e[r],(l=le(s,t))!==s&&(e[r]=l))}return e}function xe(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function he(e,t,n){if(e[t])return e[t];const[l,s]=j(n,{equals:!1,internal:!0});return l.$=s,e[t]=l}function Bt(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===ne||t===ie||(delete n.value,delete n.writable,n.get=()=>e[ne][t]),n}function yt(e){qe()&&he(xe(e,ie),ht)()}function Ft(e){return yt(e),Reflect.ownKeys(e)}const Vt={get(e,t,n){if(t===Re)return e;if(t===ne)return n;if(t===Oe)return yt(e),n;const l=xe(e,ie),s=l[t];let r=s?s():e[t];if(t===ie||t===X||t==="__proto__")return r;if(!s){const i=Object.getOwnPropertyDescriptor(e,t);qe()&&(typeof r!="function"||e.hasOwnProperty(t))&&!(i&&i.get)&&(r=he(l,t,r)())}return ke(r)?gt(r):r},has(e,t){return t===Re||t===ne||t===Oe||t===ie||t===X||t==="__proto__"?!0:(qe()&&he(xe(e,X),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Ft,getOwnPropertyDescriptor:Bt};function Ce(e,t,n,l=!1){if(!l&&e[t]===n)return;const s=e[t],r=e.length;n===void 0?(delete e[t],e[X]&&e[X][t]&&s!==void 0&&e[X][t].$()):(e[t]=n,e[X]&&e[X][t]&&s===void 0&&e[X][t].$());let i=xe(e,ie),a;if((a=he(i,t,s))&&a.$(()=>n),Array.isArray(e)&&e.length!==r){for(let o=e.length;o<r;o++)(a=i[o])&&a.$();(a=he(i,"length",r))&&a.$(e.length)}(a=i[ht])&&a.$()}function bt(e,t){const n=Object.keys(t);for(let l=0;l<n.length;l+=1){const s=n[l];Ce(e,s,t[s])}}function Ut(e,t){if(typeof t=="function"&&(t=t(e)),t=le(t),Array.isArray(t)){if(e===t)return;let n=0,l=t.length;for(;n<l;n++){const s=t[n];e[n]!==s&&Ce(e,n,s)}Ce(e,"length",l)}else bt(e,t)}function fe(e,t,n=[]){let l,s=e;if(t.length>1){l=t.shift();const i=typeof l,a=Array.isArray(e);if(Array.isArray(l)){for(let o=0;o<l.length;o++)fe(e,[l[o]].concat(t),n);return}else if(a&&i==="function"){for(let o=0;o<e.length;o++)l(e[o],o)&&fe(e,[o].concat(t),n);return}else if(a&&i==="object"){const{from:o=0,to:d=e.length-1,by:u=1}=l;for(let c=o;c<=d;c+=u)fe(e,[c].concat(t),n);return}else if(t.length>1){fe(e[l],t,[l].concat(n));return}s=e[l],n=[l].concat(n)}let r=t[0];typeof r=="function"&&(r=r(s,n),r===s)||l===void 0&&r==null||(r=le(r),l===void 0||ke(s)&&ke(r)&&!Array.isArray(r)?bt(s,r):Ce(e,l,r))}function Ne(...[e,t]){const n=le(e||{}),l=Array.isArray(n),s=gt(n);function r(...i){lt(()=>{l&&i.length===1?Ut(n,i[0]):fe(n,i)})}return[s,r]}const Wt=80,Yt=5,pt=1.7,mt=20,ae=20,He=100,_t=500,Kt=720*60*1e3,Xt=5,vt=new Array(495).fill(1).map((e,t)=>Math.floor(Wt*Math.pow(t+1,pt))),Ae=new Array(500).fill(1).map((e,t)=>Math.floor(Yt*Math.pow(t+1,pt))),wt=(e,t=vt)=>{if(!e)return 0;const n=t.findIndex(r=>r>e);if(n<0&&e>0)return 1;const l=e-(t[n-1]??0),s=t[n]-(t[n-1]??0);return l/s},Te=(e,t=vt)=>{const n=t.findIndex(l=>l>e);return n<0&&e>0?t.length:n};var Gt=v('<div class="flex w-full absolute h-full items-center bg-main justify-center text-white text-xl top-0 left-0">Catching up... (<!>)');const Ie=rt(),H=new Event("tick"),zt=e=>{const[t,n]=j(0),[l,s]=j(!0),[r,i]=j(0),a=new EventTarget;ge(()=>{setInterval(()=>{l()||(n(t()+1),a==null||a.dispatchEvent(H))},He)}),document.addEventListener("visibilitychange",()=>{document.hidden?(s(!0),window.localStorage.setItem("freeze_time",`${Date.now()}`)):o()});const o=()=>{s(!0);const c=parseInt(window.localStorage.getItem("freeze_time")??`${Date.now()}`),y=Math.min(Date.now()-c,Kt);let p=Math.floor(y/He);i(p),d()},d=()=>{let c=r();c>0&&requestIdleCallback(()=>{let y=1e3;for(;c>0&&y>0;)a==null||a.dispatchEvent(H),n(t()+1),c--,y--;i(c),c>0?d():s(!1)})};window.addEventListener("load",()=>setTimeout(o,500)),window.addEventListener("beforeunload",()=>{window.localStorage.setItem("freeze_time",`${Date.now()}`)});const u=()=>a==null?void 0:a.dispatchEvent(H);return g(Ie.Provider,{value:{evt:a,fire:u,pause:l},get children(){return[te(()=>e.children),g(q,{get when(){return l()},get children(){var c=Gt(),y=c.firstChild,p=y.nextSibling;return p.nextSibling,b(c,r,p),c}})]}})},Jt=[{name:"hay_hand_1",label:"Hay hand wraps",stackable:!1,equipSlot:"hand",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{attMin:1,attMax:3}},{name:"hay_head_1",label:"Hay bandana",stackable:!1,equipSlot:"head",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{maxHealth:5}},{name:"hay_chest_1",label:"Hay vest",stackable:!1,equipSlot:"chest",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",50]],stats:{physRes:1}},{name:"utility_axe_1",label:"Rusty axe",stackable:!1,equipSlot:"weapon",utilityType:"axe",stats:{}}],Qt=[{name:"recipe_hay_hand_1",label:"Recipe: Hay hand wraps",stackable:!1,exclusive:!0,craftableItem:"hay_hand_1"},{name:"recipe_hay_head_1",label:"Recipe: Hay bandana",stackable:!1,exclusive:!0,craftableItem:"hay_head_1"},{name:"recipe_hay_chest_1",label:"Recipe: Hay vest",stackable:!1,exclusive:!0,craftableItem:"hay_chest_1"}].map(e=>({...e,use:t=>(t.onTask({noRepeat:!0,label:"Learning",description:e.label,duration:100,onComplete:()=>(t.player.recipes.includes(e.craftableItem)||(t.setPlayer("recipes",[...t.player.recipes,e.craftableItem]),t.setState("prohibitedItems",[...t.state.prohibitedItems,e.name])),t.removeInventory(e.name),t.onNavigate("_back"),!0)}),!1)})),Zt=[{name:"hay_1",label:"Hay",stackable:!0,maxStack:100},{name:"wood_log_1",label:"Wooden log",stackable:!0,maxStack:100}],en=[{name:"wood_club_1",label:"Wooden Club",equipSlot:"weapon",craftType:"weapon",craftComplexity:1,craftLevel:1,ingredients:[["wood_log_1",15]],masteryType:"mace",stats:{attMin:2,attMax:5,attSpeed:-.1}},{name:"wood_shield_1",label:"Wooden Shield",equipSlot:"offhand",craftType:"armour",craftComplexity:1,craftLevel:1,ingredients:[["wood_log_1",20]],stats:{physRes:2,maxHealth:10}},{name:"wood_chest_1",label:"Wooden Plank Vest",equipSlot:"chest",craftType:"armour",craftComplexity:2,craftLevel:1,ingredients:[["wood_log_1",40]],stats:{physRes:3,agility:-1}},{name:"stone_axe_1",label:"Stone Axe",equipSlot:"weapon",craftType:"weapon",craftComplexity:2,craftLevel:2,ingredients:[["wood_log_1",10],["stone_1",10]],masteryType:"axe",stats:{attMin:3,attMax:8,attSpeed:-.05,strength:1}},{name:"stone_helm_1",label:"Stone Helm",equipSlot:"head",craftType:"armour",craftComplexity:2,craftLevel:2,ingredients:[["stone_1",20],["hay_1",10]],stats:{physRes:4,maxHealth:10,intelligence:-1}},{name:"copper_sword_1",label:"Copper Shortsword",equipSlot:"weapon",craftType:"weapon",craftComplexity:3,craftLevel:2,ingredients:[["copper_ingot_1",8],["wood_log_1",5]],masteryType:"sword",stats:{attMin:4,attMax:10,attSpeed:.1,dexterity:1}},{name:"copper_chest_1",label:"Copper Breastplate",equipSlot:"chest",craftType:"armour",craftComplexity:3,craftLevel:2,ingredients:[["copper_ingot_1",15]],stats:{physRes:5,magRes:1,strength:1}},{name:"iron_spear_1",label:"Iron Spear",equipSlot:"weapon",craftType:"weapon",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",12],["wood_log_1",8]],masteryType:"spear",stats:{attMin:6,attMax:14,attSpeed:0,dexterity:2}},{name:"iron_helm_1",label:"Iron Helmet",equipSlot:"head",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",8]],stats:{physRes:6,maxHealth:15,charisma:-1}},{name:"iron_boots_1",label:"Iron Greaves",equipSlot:"foot",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",6]],stats:{physRes:3,agility:-1}}],F=[Jt,Qt,Zt,en].flat().reduce((e,t)=>(e[t.name]=t,e),{});var tn=v('<div class="font-bold m-2">'),nn=v("<div>");const Be=e=>(()=>{var t=tn();return b(t,g(z,{get each(){return e.lines},children:(n,l)=>(()=>{var s=nn();return b(s,g(q,{get when(){return l()===0},children:'" .. '}),null),b(s,n,null),b(s,g(q,{get when(){return l()===e.lines.length-1},children:' .. "'}),null),s})()})),t})();var ln=v("<span class=text-red-500>Fight scarecrows"),rn=v('<span class="font-bold ml-1">'),sn=v('<span class="font-bold text-blue-500 mr-1">Hay'),an=v("<span class=font-bold>");const on=[{name:"story_town_1",label:"Town",description:"You are in town",type:"dialogue",options:[{label:"Visit Farm",goto:"story_farmer_1"},{label:"Leave the town",goto:"story_forest_1"},{label:"Merchants",goto:"story_town_merchants_1"},{label:"Home",goto:"story_home_1"}]},{name:"story_farmer_1",label:"Farm",description:"A vacant expressionless farmer. Hasn't washed in days.",type:"dialogue",options:[{label:"Approach the farmer",goto:"story_farmer_2"},{label:ln(),goto:"story_scarecrows_1"},{label:"Sell Hay",action:e=>{const t=e.player.invent,{removeInventory:n,onAddStat:l}=e,s=t.filter(r=>(r==null?void 0:r.name)==="hay_1").reduce((r,i)=>r+((i==null?void 0:i.stack)??0),0);s&&(n("hay_1",s),l("gold",s),e.onLog(["You sell",(()=>{var r=rn();return b(r,s),r})()," ",sn(),"For ",(()=>{var r=an();return b(r,s),r})()," gold"],"meta"))}}]},{name:"story_farmer_2",label:"Farmer",description:["You approach, he holds your wrist loosely like an exhausted child.",g(Be,{lines:["Loathsome shadowed cloaks","Golden light shimmering, blind eyes","Fear, is Death knocking?"]}),"He sits and cries."],type:"dialogue",options:[{label:"Console",goto:"story_farmer_3"},{label:"Leave",goto:"_back"}]},{name:"story_farmer_3",label:"Farmer",description:g(Be,{lines:["Am *I* the keeper of the wheat?","... or is it the keeper of me?"]}),type:"dialogue",options:[{label:"Silently leave",goto:"_back.2"}]},{name:"story_scarecrows_1",label:"Scarecrows",description:"Fighting scarecrows",type:"encounter",cooldown:20,encounters:[{name:"enc_scarecrow_1",label:"Scarecrow",health:10,chance:1,experience:50,drops:[{name:"hay_1",chance:1},{name:"recipe_hay_hand_1",chance:.05},{name:"recipe_hay_head_1",chance:.05},{name:"recipe_hay_chest_1",chance:.05}]}]}],cn=[{type:"craft",name:"bench_simple",label:"Simple crafting bench",cratingType:"basic",craftingComplexity:1}],un=cn.reduce((e,t)=>(e[t.name]=t,e),{});var fn=v("<div class=font-bold>Stash"),dn=v("<div>Retrieve items from stash here, place in stash from your invent");const hn=[{name:"story_home_1",label:"Home",description:"Home sweet home",type:"dialogue",options:[{label:"Build",goto:"story_home_2"},{label:"Stash",goto:"story_stash_1"},{label:"Craft",goto:"story_home_4"}]},{name:"story_stash_1",label:"Stash",type:"dialogue",description:[fn(),dn()]},{name:"story_home_4",label:"Crafting",description:"A workshop",type:"dialogue",options:e=>e.state.furniture.map(t=>un[t]).filter(t=>t.type==="craft").map(t=>({label:t.label,goto:`story_craft_${t.cratingType}_1`}))},{name:"story_craft_basic_1",label:"Basic crafting",description:"A very simple crafting table",type:"dialogue",options:e=>e.player.recipes.map(t=>F[t]).filter(t=>t.craftType==="basic").map(t=>{var n;return{label:t.label,action:l=>{l.onTask({noRepeat:!0,label:"Crafting",description:t.label,duration:100,onComplete:()=>gn(l,t)})},isDisabled:!yn(e,t),subtext:(n=t.ingredients)==null?void 0:n.map(l=>`${F[l[0]].label} (${l[1]})`).join(" - ")}})}],gn=(e,t)=>{var n;e.addInventory(t),(n=t.ingredients)==null||n.forEach(l=>e.removeInventory(...l))},yn=(e,t)=>{var n;return(n=t.ingredients)!=null&&n.length?t.ingredients.every(l=>e.player.invent.reduce((r,i)=>((i==null?void 0:i.name)===l[0]&&(r=r+(i.stack??1)),r),0)>=l[1]):!0};var bn=v("<span class=text-red-500>Venture deeper");const pn=[{type:"dialogue",name:"story_forest_1",label:"Forest border",description:"The canopy casts a shadow. Sounds, eyes ... movement",options:e=>[{label:"Chop wood",goto:"task_chop_wood_1",isDisabled:!!!e.player.equipment.find(n=>n.equipSlot==="weapon"&&n.utilityType==="axe")},{label:bn(),goto:"story_forest_2"}]},{type:"task",name:"task_chop_wood_1",label:"Surrounded by trees",description:"Chopping wood",duration:100,masteryType:"woodcutting",cooldown:10,experience:1,utilityType:"axe",items:[{name:"wood_log_1",chance:1}]},{name:"story_forest_2",label:"Deep forest",description:"Creatures block your path...",type:"encounter",limit:5,onComplete:e=>e.onNavigate("story_forest_3"),cooldown:20,encounters:[{name:"enc_rabbit_1",label:"Little rabbit",chance:.4,experience:50,drops:[],health:5,stats:{attMin:0,attMax:1,attSpeed:10}},{name:"enc_deer_1",label:"Frightened deer",chance:.2,experience:50,drops:[],health:10,stats:{attMin:0,attMax:4,attSpeed:45}},{name:"enc_dead_tree_1",label:"Dead tree",chance:1,experience:10,health:10}]},{name:"story_forest_3",label:"welcome to the deep forest",type:"dialogue",description:"You made it!"}],mn=[{name:"utility_axe_1",cost:100}],_n=[{type:"dialogue",name:"story_town_merchants_1",label:"Town Bazaar",description:"Souks, stalls, spices, hands... hands... hands...",options:[{label:"Tool merchant",goto:"story_town_merchant_tool_1"}]},{type:"dialogue",name:"story_town_merchant_tool_1",label:"Tool Merchant",description:["A burly man, skin of leather ",g(Be,{lines:["The very finest tools"]})],options:e=>{const t=e.player.stats.gold;return mn.map(n=>{const l=F[n.name];return{label:(l==null?void 0:l.label)??"UNKNOWN",action:s=>{s.addInventory(l),s.onAddStat("gold",0-n.cost),s.onNavigate("story_town_merchant_tool_1")},isDisabled:n.cost>t}})}}],Fe=[on,hn,pn,_n].flat().reduce((e,t)=>(e[t.name]=t,e),{}),vn=[{name:"furniture_bench_basic_1",label:"Basic bench",type:"craft",craftingComplexity:1,cratingType:"basic"},{name:"furniture_stash_1",label:"Basic stash",type:"stash",storageSize:5}],wn=[vn].flat().reduce((e,t)=>(e[t.name]=t,e),{}),$n=[{name:"unarmed",label:"Unarmed",bonus:new Array(_t+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{attMin:t%10===0?1:0,attMax:1,attSpeed:t%50===0?.1:0}}}).filter(Boolean)}],Sn=[{name:"woodcutting",label:"Woodcutting",bonus:new Array(_t+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{durationModifier:t%10===0?10:0},dropModifiers:[{name:"wood_log_1",chance:t%50===0?1:0}]}}).filter(Boolean)}],Ye=[$n,Sn].flat().reduce((e,t)=>(e[t.name]=t,e),{}),$t=(e,t)=>{const n=Ye[e];if(!n)return{};const l=Te(t,Ae),s=n.bonus.filter(r=>r.level<=l);return(s==null?void 0:s.reduce((r,i)=>(Object.entries(i.stats).forEach(([a,o])=>{r[a]=(r[a]??0)+o}),r),{}))??{}},kn=(e,t,n)=>{const l=Ye[t];if(!l)return 0;const s=Te(n,Ae),r=l.bonus.filter(i=>i.level<=s);return r==null?void 0:r.reduce((i,a)=>{var o,d;return i+(((d=(o=a.dropModifiers)==null?void 0:o.find(u=>u.name===e))==null?void 0:d.chance)??0)},0)};let St=class{constructor(t){M(this,"name");M(this,"label");M(this,"description");M(this,"type");M(this,"encounters");M(this,"duration");M(this,"noRepeat");M(this,"cooldown");M(this,"limit");M(this,"items");M(this,"skills");M(this,"options");M(this,"onComplete");M(this,"masteryType");M(this,"experience");M(this,"utilityType");this.label=t.label,this.type=t.type,this.name=t.name,this.description=t.description,Object.assign(this,t)}getEncounter(){var n;if(this.type==="task")return{name:"task",label:this.label,health:this.duration??0,chance:1,drops:this.items};const t=Math.random();if(!(this.type!=="encounter"||!((n=this.encounters)!=null&&n.length)))return this.encounters.sort((l,s)=>l.chance-s.chance).find(l=>t<=l.chance)}getDamage(t){const{attMin:n,attMax:l}=t.stats??{};if(!(!n||!l))return n+Math.round(Math.random()*(n-l))}getDrops(t){return this.getItems(t==null?void 0:t.drops)}getItems(t=this.items??[],n,l){let s=[];for(let r of t){let i=r.chance;for(n&&l&&(i=i+kn(r.name,n,l));i>0;)Math.random()<=i&&s.push(r),i--}return s==null?void 0:s.map(r=>F[r.name]).filter(Boolean)}};class Qe{constructor(t={},n=new Array(mt).fill(null)){M(this,"equipment");M(this,"stats");M(this,"mastery");M(this,"invent");M(this,"recipes");this.equipment=t.equipment??[],this.mastery=t.mastery??{},this.recipes=t.recipes??[],this.stats=t.stats??{gold:120,experience:0,health:10,maxHealth:10,strength:1,agility:1,attSpeed:0},this.invent=n}weaponMastery(){var t;return((t=this.equipment.find(n=>n.equipSlot==="weapon"))==null?void 0:t.masteryType)??"unarmed"}getMasteryPerk(t){return $t(t,this.mastery[t]??0)}attackDamage(){let t=this.equipment.reduce((o,d)=>{var u;return o+(((u=d.stats)==null?void 0:u.attMin)??0)},1),n=this.equipment.reduce((o,d)=>{var u;return o+(((u=d.stats)==null?void 0:u.attMax)??0)},1);const l=this.weaponMastery(),s=this.getMasteryPerk(l);t+=(s==null?void 0:s.attMin)??0,n+=(s==null?void 0:s.attMax)??0;const r=1+Math.pow((this.stats.strength??0)/100,.7),i=Math.round(t*r),a=Math.round(n*r);return[i,a]}attackRate(){const n=Math.min(100,Math.max(1,this.stats.agility??0)),l=1,s=ae/5,r=Math.sqrt(n/100),i=s*r,a=ae/5,o=Math.min(this.equipment.reduce((A,C)=>{var k;return A+(((k=C.stats)==null?void 0:k.attSpeed)??0)},0),1),d=o*a,u=ae/5,c=this.weaponMastery(),y=this.getMasteryPerk(c),p=(y.attSpeed??0)*u,E=(ae/2.5-1)*((r+o+(y.attSpeed??0))/3);return Math.max(ae-i-d-E-p,l)}}class Ze{constructor(t){M(this,"prohibitedItems");M(this,"furniture");M(this,"stash");this.prohibitedItems=[],this.furniture=[],this.stash=new Array(Xt).fill(null),Object.assign(this,t)}}const Z="story_town_1",W=rt(),ce=e=>new St(Fe[e]??Fe[Z]),xn=e=>{const[t,n]=j(ce(Z)),[l,s]=Ne(new Qe({})),[r,i]=Ne(new Ze({furniture:["furniture_bench_basic_1"]})),[a,o]=j([Z]),[d,u]=j([]);ge(()=>c());const c=()=>{const f=JSON.parse(window.localStorage.getItem("save")??"null");f&&(s({...f.player,invent:f.player.invent.map(_=>_?{...F[_.name],stack:_.stack}:null)}),i(f.state),o(f.nav),n(ce(f.story)))},y=()=>{lt(()=>{s(new Qe({})),i(new Ze({furniture:["furniture_bench_basic_1"]})),n(ce(Z)),o([Z])}),p()},p=()=>{window.localStorage.setItem("save",JSON.stringify({player:le(l),story:t().name,state:le(r),nav:a()}))};window.addEventListener("beforeunload",p),setInterval(p,1e4);const m=(f,_=1)=>{if(!_)return _;if(_===1/0)return console.error("Cannot add infinite items to invent"),0;if(typeof f=="string"){if(!F[f])return console.warn("Invalid or not found item",f),_;f=F[f]}let w=[...l.invent];if(f.exclusive&&w.find(h=>(h==null?void 0:h.name)===f.name))return 0;let S=_;return f.stackable&&f.maxStack&&(w=w.map(h=>{if(!(h!=null&&h.name)||!(h!=null&&h.stack)||!h.maxStack||!S)return h;if(h.name===f.name&&h.stack<h.maxStack){let R=Math.min(h.stack+S,h.maxStack);return S-=R-h.stack,{...h,stack:R}}return h})),S&&(w=w.map(h=>{if(!S)return h;if(h===null){const R=Math.min(S,f.maxStack??1);return S-=R,{...f,stack:R}}return h})),S<_&&s("invent",w),_-S},E=(f,_=1)=>{if(!_)return!1;if(typeof f=="string"){if(!F[f])return console.warn("Invalid or not found item",f),!1;f=F[f]}if(l.invent.findLastIndex(h=>(h==null?void 0:h.name)===f.name)<0)return!1;const S=[...l.invent.toReversed().map(h=>{if(!_||(h==null?void 0:h.name)!==f.name||!(h!=null&&h.stack))return h;if(h.stack<=_)return _-=h.stack,null;const R=h.stack-_;return _=0,{...h,stack:R}}).reverse()].filter(Boolean);return S.push(...new Array(mt-S.length).fill(null)),s("invent",S),!0},x=(f,_=1)=>{if(!_)return _;if(_===1/0)return console.error("Cannot add infinite items to stash"),0;if(typeof f=="string"){if(!F[f])return console.warn("Invalid or not found item",f),_;f=F[f]}let w=[...r.stash];if(f.exclusive&&w.find(h=>(h==null?void 0:h.name)===f.name))return 0;let S=_;return f.stackable&&f.maxStack&&(w=w.map(h=>{if(!(h!=null&&h.name)||!(h!=null&&h.stack)||!S)return h;if(h.name===f.name&&h.stack<f.maxStack){let R=Math.min(h.stack+S,f.maxStack);return S-=R-h.stack,{...h,stack:R}}return h})),S&&(w=w.map(h=>{if(!S)return h;if(h===null){const R=Math.min(S,f.maxStack??1);return S-=R,{name:f.name,stack:R}}return h})),S<_&&i("stash",w),_-S},A=T(()=>{try{return r.furniture.map(f=>wn[f]).filter(f=>f.type==="stash").reduce((f,_)=>f+(_.storageSize??0),0)}catch(f){return console.error(f),1}}),C=(f,_=1)=>{if(!_)return!1;if(typeof f=="string"){if(!F[f])return console.warn("Invalid or not found item",f),!1;f=F[f]}if(r.stash.findLastIndex(h=>(h==null?void 0:h.name)===f.name)<0)return!1;const S=[...r.stash.toReversed().map(h=>{if(!_||(h==null?void 0:h.name)!==f.name||!(h!=null&&h.stack))return h;if(h.stack<=_)return _-=h.stack,null;const R=h.stack-_;return _=0,{...h,stack:R}}).reverse()].filter(Boolean);return S.push(...new Array(A()-S.length).fill(null)),i("stash",S),!0},k=f=>{if(f==="_start"){const w=a().at(0)??Z;o([w]),n(ce(w));return}const _=/^_back/.test(f);if(!_&&!Fe[f]){console.error(`Unknown story ${f}`);return}if(_){const[w,S]=f.split("."),h=Math.min(parseInt(S??"1"),a().length+1);f=a().at(-1-h)??Z,a().length>1&&o(a().slice(0,-h))}else a().at(-1)!==f&&o([...a(),f]);n(ce(f))},$=(f,_=1)=>{const w=(l.stats[f]??0)+_;s("stats",f,w)},Q={story:t,onNavigate:k,onAddStat:$,player:l,state:r,setState:i,setPlayer:s,addInventory:m,removeInventory:E,log:d,onLog:(f,_="basic")=>{var h;const w=new Date,S={msg:f,time:[w.getHours(),w.getMinutes(),w.getSeconds()].join(":"),type:_};u([...d().slice(Math.min(((h=d())==null?void 0:h.length)-999,0)),S])},onAddMastery:(f,_=1)=>{const w=(l.mastery[f]??0)+_;s("mastery",f,w)},onEquip:f=>{if(E(f)){let _=!1;return s("equipment",[...l.equipment.map(w=>w.equipSlot===f.equipSlot?(_=!0,Object.entries(w.stats??{}).forEach(([S,h])=>$(S,0-h)),m(w),f):w),..._?[]:[f]]),Object.entries(f.stats??{}).forEach(([w,S])=>$(w,S)),!0}return!1},onUnequip:f=>!!l.equipment.find(w=>w.name===f.name)&&m(f)?(s("equipment",[...l.equipment.filter(w=>w.name!==f.name)]),Object.entries(f.stats??{}).forEach(([w,S])=>$(w,0-S)),!0):!1,onTask:f=>{o([...a(),"task"]),n(new St({name:"task",type:"task",...f,onComplete:f.noRepeat?f.onComplete??(()=>k("_back")):void 0}))},navStack:a,addStash:x,removeStash:C,onClearState:y};return g(W.Provider,{value:Q,get children(){return e.children}})};var Cn=v('<div class="flex flex-row mt-auto gap-2"><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Go back</div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Town'),An=v('<div class="flex flex-col gap-5 p-2 h-full overflow-y-auto">'),Ln=v("<div class=text-gray-500>Nothing here..."),En=v('<span class="text-xs text-gray-400">'),Mn=v('<div class="w-full border content-center h-12 text-lg font-bold flex flex-col justify-center">');const Tn=()=>{const e=V(W),t=l=>{if(l.goto)return e==null?void 0:e.onNavigate(l.goto);if(l.action&&e)return l.action(e)},n=T(()=>{const l=e==null?void 0:e.story().options;return Array.isArray(l)?l:(l==null?void 0:l(e))??[]});return(()=>{var l=An();return b(l,g(q,{get when(){return n().length},get fallback(){return Ln()},get children(){return g(z,{get each(){return n()},children:s=>(()=>{var r=Mn();return r.$$click=()=>!s.isDisabled&&t(s),b(r,()=>s.label,null),b(r,g(q,{get when(){return s.subtext},get children(){var i=En();return b(i,()=>s.subtext),i}}),null),U(i=>{var a=!!s.isDisabled,o=!s.isDisabled;return a!==i.e&&r.classList.toggle("text-gray-500",i.e=a),o!==i.t&&r.classList.toggle("cursor-pointer",i.t=o),i},{e:void 0,t:void 0}),r})()})}}),null),b(l,g(q,{get when(){var s;return((s=e==null?void 0:e.story())==null?void 0:s.name)!==Z},get children(){var s=Cn(),r=s.firstChild,i=r.nextSibling;return r.$$click=()=>t({label:"Go back",goto:"_back"}),i.$$click=()=>t({label:"Back to town",goto:"_start"}),s}}),null),l})()};re(["click"]);var In=v("<button class=m-auto>use"),jn=v("<button class=m-auto>equip"),On=v('<div class="px-2 py-1 bg-blue-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Stash</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All'),qn=v('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative mb-3"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="w-full flex flex-row justify-between gp-2 mb-2"></div><div class="px-2 py-1 bg-red-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Drop</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All'),Pn=v('<div class="h-full relative"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2">'),Dn=v('<div class="border p-1 cursor-pointer flex flex-row justify-between"><div></div><div>(<!>)'),Rn=v('<div class="border p-1 flex flex-row justify-between border-gray-700 text-gray-700">Empty');const Nn=()=>{const e=V(W),[t,n]=j(),l=u=>{u<0||!(e!=null&&e.player.invent[u])||n(u)},s=T(()=>{const u=t()??-1;if(!(u<0))return e==null?void 0:e.player.invent.at(u)}),r=()=>{var c;const u=s();!u||!e||(c=u==null?void 0:u.use)!=null&&c.call(u,e)&&n(void 0)},i=()=>{const u=s();!(u!=null&&u.equipSlot)||!e||e.onEquip(u)&&n(void 0)},a=u=>{const c=s();c&&(e==null||e.removeInventory(c,u),u>=(c.stack??1)&&n(void 0))},o=u=>{const c=s();if(c&&(u=u===1/0?(e==null?void 0:e.player.invent.reduce((y,p)=>(p==null?void 0:p.name)===c.name?y+(p.stack??0):y,0))??0:u,c)){const y=e==null?void 0:e.addStash(c,u);e==null||e.removeInventory(c,y)}},d=T(()=>e==null?void 0:e.navStack().includes("story_home_1"));return(()=>{var u=Pn(),c=u.firstChild;return c.$$click=()=>n(void 0),b(c,g(z,{get each(){return(e==null?void 0:e.player.invent)??[]},children:(y,p)=>g(Hn,{item:y,onSelect:()=>l(p())})})),b(u,g(q,{get when(){return s()},get children(){var y=qn(),p=y.firstChild,m=p.firstChild,E=m.firstChild,x=E.nextSibling,A=x.firstChild,C=A.nextSibling;C.nextSibling;var k=m.nextSibling,$=k.firstChild,L=$.nextSibling,P=L.firstChild,D=P.nextSibling,Y=D.firstChild,J=Y.nextSibling,Q=J.nextSibling;return E.$$click=()=>n(void 0),b(x,()=>{var f;return(f=s())==null?void 0:f.label},A),b(x,()=>{var f;return(f=s())==null?void 0:f.stack},C),b($,g(q,{get when(){var f;return(f=s())==null?void 0:f.use},get children(){var f=In();return f.$$click=r,f}}),null),b($,g(q,{get when(){return s().equipSlot},get children(){var f=jn();return f.$$click=i,f}}),null),b(k,g(q,{get when(){return d()},get children(){var f=On(),_=f.firstChild,w=_.nextSibling,S=w.firstChild,h=S.nextSibling,R=h.nextSibling;return S.$$click=()=>o(1),h.$$click=()=>{var Ke;return o(((Ke=s())==null?void 0:Ke.stack)??1)},R.$$click=()=>o(1/0),f}}),L),Y.$$click=()=>a(1),J.$$click=()=>{var f;return a(((f=s())==null?void 0:f.stack)??1)},Q.$$click=()=>a(1/0),y}}),null),u})()},Hn=e=>{const t=n=>{n.stopPropagation(),e.onSelect()};return g(q,{get when(){return e.item},get fallback(){return Rn()},get children(){var n=Dn(),l=n.firstChild,s=l.nextSibling,r=s.firstChild,i=r.nextSibling;return i.nextSibling,n.$$click=t,b(l,()=>{var a;return(a=e.item)==null?void 0:a.label}),b(s,()=>{var a;return(a=e.item)==null?void 0:a.stack},i),n}})};re(["click"]);var Bn=v('<div class="w-full border rounded relative text-black bg-gray-500"><div class="ease-linear w-0 h-full rounded"></div><div class="absolute left-1/2 top-1/2 -translate-1/2 whitespace-nowrap">');const Ve=e=>{const t=V(Ie),[n,l]=j(e.ticks),s=()=>{let r=n();r<=0&&(e.onFinish(),r=e.ticks+1),l(r-1)};return ge(()=>t==null?void 0:t.evt.addEventListener(H.type,s)),Me(()=>t==null?void 0:t.evt.removeEventListener(H.type,s)),g(Le,{get max(){return e.ticks},get value(){return e.ticks-n()},get type(){return e.type},get showPc(){return e.showPc},get showNumber(){return e.showNumber},get label(){return e.label}})},Le=e=>{const t=T(()=>Math.min(e.value/e.max*100,100));return(()=>{var n=Bn(),l=n.firstChild,s=l.nextSibling;return b(s,g(be,{get children(){return[g(N,{get when(){return e.showPc},get children(){return[te(()=>e.label)," (",te(()=>t().toFixed(0)),"%)"]}}),g(N,{get when(){return e.showNumber},get children(){return[te(()=>e.label)," ",te(()=>e.value)]}})]}})),U(r=>{var i=!e.isSmall,a=t()+"%",o=!e.type,d=e.type==="green",u=e.type==="yellow",c=e.type==="blue",y=e.type==="red";return i!==r.e&&n.classList.toggle("h-full",r.e=i),a!==r.t&&Rt(l,"width",r.t=a),o!==r.a&&l.classList.toggle("bg-white",r.a=o),d!==r.o&&l.classList.toggle("bg-green-500",r.o=d),u!==r.i&&l.classList.toggle("bg-yellow-500",r.i=u),c!==r.n&&l.classList.toggle("bg-blue-500",r.n=c),y!==r.s&&l.classList.toggle("bg-red-500",r.s=y),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),n})()};var Fn=v('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Skills</button><button>Mastery</button><button>Recipes'),Vn=v('<div class="flex flex-row justify-between items-center"><div></div><div class="h-4 w-32">'),Un=v('<div class="flex flex-row justify-between items-center"><div>');const Wn=()=>{const[e,t]=j("mastery"),n=V(W),l=T(()=>Object.entries((n==null?void 0:n.player.mastery)??{}).map(([r,i])=>{const a=Ye[r];return{label:a==null?void 0:a.label,progress:wt(i,Ae)*100,level:Te(i,Ae)}})),s=T(()=>(n==null?void 0:n.player.recipes.map(r=>F[r]))??[]);return(()=>{var r=Fn(),i=r.firstChild,a=i.nextSibling,o=a.firstChild,d=o.nextSibling,u=d.nextSibling;return b(i,g(be,{get children(){return[g(N,{get when(){return e()==="skills"},children:"TODO"}),g(N,{get when(){return e()==="mastery"},get children(){return g(z,{get each(){return l()},children:c=>(()=>{var y=Vn(),p=y.firstChild,m=p.nextSibling;return b(p,()=>c.label),b(m,g(Le,{get label(){return`${c.level}`},type:"yellow",max:100,get value(){return c.progress},showPc:!0})),y})()})}}),g(N,{get when(){return e()==="recipes"},get children(){return g(z,{get each(){return s()},children:c=>(()=>{var y=Un(),p=y.firstChild;return b(p,()=>c.label),y})()})}})]}})),o.$$click=()=>t("skills"),d.$$click=()=>t("mastery"),u.$$click=()=>t("recipes"),U(c=>{var y=e()==="skills",p=e()==="mastery",m=e()==="recipes";return y!==c.e&&o.classList.toggle("selected",c.e=y),p!==c.t&&d.classList.toggle("selected",c.t=p),m!==c.a&&u.classList.toggle("selected",c.a=m),c},{e:void 0,t:void 0,a:void 0}),r})()};re(["click"]);var Yn=v('<span class="text-red-800 font-bold">'),Kn=v('<span class="text-green-800 font-bold">'),et=v('<span class="text-red-800 font-bold m-1">'),Xn=v('<span class="font-bold m-1">'),Gn=v("<span class=font-bold>"),zn=v("<div class=text-red-800>"),Jn=v("<div class=h-8><div class=h-2>"),Qn=v("<div class=h-2>"),Zn=v('<div class="h-8 mt-5">'),el=v('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>Attacking (<!>)');const tl=()=>{const e=V(W),t=V(Ie),[n,l]=j(25),[s,r]=j(0),[i,a]=j(0),[o,d]=j(),[u,c]=j();ve(()=>{t!=null&&t.pause()?t==null||t.evt.addEventListener(H.type,y):t==null||t.evt.removeEventListener(H.type,y)});const y=()=>{n()<=0&&u()?p():l(n()-1)};ge(()=>{var x;l((e==null?void 0:e.player.attackRate())??25),c(e==null?void 0:e.story().getEncounter()),d((x=u())==null?void 0:x.health)});const p=()=>{var J,Q,f;const x=!(t!=null&&t.pause()),[A,C]=[e==null?void 0:e.player,e==null?void 0:e.story()],k=u(),$=o();if(!A||!C)return;if(l((e==null?void 0:e.player.attackRate())??25),!k&&C.limit&&i()>=C.limit){(J=C.onComplete)==null||J.call(C);return}if(!k){c(e==null?void 0:e.story().getEncounter()),d((Q=u())==null?void 0:Q.health);return}if(!$)return;const[L,P]=(e==null?void 0:e.player.attackDamage())??[0,1],D=L+Math.round(Math.random()*(P-L)),Y=$-Math.min(D,$);if(x&&(e==null||e.onLog(["You hit the ",(()=>{var _=Yn();return b(_,k.label),_})()," for ",(()=>{var _=Kn();return b(_,D),_})()," damage"],"basic")),e==null||e.onAddMastery(e.player.weaponMastery(),D),Y<=0){x&&(e==null||e.onLog(["You killed the",(()=>{var w=et();return b(w,k.label),w})()],"good")),a(i()+1),c(void 0),k.experience&&(e==null||e.onAddStat("experience",k.experience));const _=(f=C.getDrops(k))==null?void 0:f.filter(w=>!(e!=null&&e.state.prohibitedItems.includes(w.name))).filter(w=>!!(e!=null&&e.addInventory(w)));if(_!=null&&_.length&&x&&(e==null||e.onLog(["It dropped:",(()=>{var w=Xn();return b(w,_==null?void 0:_.map(S=>S.label).join(", ")),w})()],"drop")),C.noRepeat)return;r(C.cooldown??0),t==null||t.evt.addEventListener(H.type,E)}d(Math.max(Y,0))},m=()=>{var P;const x=!(t!=null&&t.pause()),[A,C]=[e==null?void 0:e.player,e==null?void 0:e.story()];if(!A||!C)return;const{attMin:k,attMax:$}=((P=u())==null?void 0:P.stats)??{};if(k===void 0||$===void 0)return;const L=k+Math.round(Math.random()*($-k));if(x&&(e==null||e.onLog([(()=>{var D=et();return b(D,u().label),D})()," hits you for ",(()=>{var D=Gn();return b(D,L),D})()," damage!"],"bad")),A.stats.health<=L){e==null||e.onNavigate("_start");return}e==null||e.onAddStat("health",-L)},E=()=>{if(s()<=0)return t==null||t.evt.removeEventListener(H.type,E),p();r(s()-1)};return Me(()=>{t==null||t.evt.removeEventListener(H.type,E)}),g(q,{get when(){return!(t!=null&&t.pause())},get children(){var x=el(),A=x.firstChild,C=A.firstChild,k=C.nextSibling;return k.nextSibling,b(A,i,k),b(A,g(q,{get when(){return e==null?void 0:e.story().limit},get children(){return[" / ",te(()=>e==null?void 0:e.story().limit)]}}),k),b(x,g(q,{get when(){var $;return te(()=>!!(!u()&&(e!=null&&e.story().limit)))()&&i()>=((($=e.story())==null?void 0:$.limit)??0)},children:"There is nothing left here to destroy"}),null),b(x,g(q,{get when(){return u()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var $=zn();return b($,()=>{var L;return(L=u())==null?void 0:L.label}),$})(),(()=>{var $=Jn(),L=$.firstChild;return b($,g(Le,{type:"red",get max(){return(e==null?void 0:e.player.stats.maxHealth)??10},get value(){return(e==null?void 0:e.player.stats.health)??0},label:"You",showNumber:!0}),L),b(L,g(Ve,{get ticks(){return n()},onFinish:p,type:"yellow",isSmall:!0})),$})(),(()=>{var $=Zn();return b($,g(Le,{type:"red",get max(){return u().health},get value(){return o()},get label(){var L;return(L=u())==null?void 0:L.label},showNumber:!0}),null),b($,g(q,{get when(){var L,P;return(P=(L=u())==null?void 0:L.stats)==null?void 0:P.attSpeed},get children(){var L=Qn();return b(L,g(Ve,{get ticks(){return u().stats.attSpeed},onFinish:m,type:"yellow",isSmall:!0})),L}}),null),$})()]}}),null),x}})};var nl=v('<span class="text-red-800 font-bold m-1">'),ll=v('<span class="font-bold m-1">'),rl=v("<div class=text-red-800>"),sl=v("<div class=h-8>"),al=v('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>');const il=()=>{const e=V(W),t=V(Ie),[n,l]=j(!1),[s,r]=j(0),[i,a]=j(0),o=T(()=>{const y=e==null?void 0:e.story().masteryType;if(y){const p=$t(y,e.player.mastery[y]??0);return Math.max(1,((e==null?void 0:e.story().duration)??100)-(p.durationModifier??0))}return(e==null?void 0:e.story().duration)??100});ve(()=>{const[y,p]=[e==null?void 0:e.player,e==null?void 0:e.story()];!y||!p||p.utilityType&&(y.equipment.find(m=>m.utilityType===p.utilityType)||e==null||e.onNavigate("_back"))}),ve(()=>{o()&&(t!=null&&t.pause()?(a(o()),t==null||t.evt.addEventListener(H.type,d)):t==null||t.evt.removeEventListener(H.type,d))});const d=()=>{i()<=0&&n()?u():a(i()-1)};ge(()=>{l(!0)});const u=()=>{var E,x;const[y,p]=[e==null?void 0:e.player,e==null?void 0:e.story()];if(!y||!p)return;if(!n()){a(o()),l(!0);return}l(!1),e==null||e.onLog(["You finished",(()=>{var A=nl();return b(A,p.description),A})()],"good"),p.masteryType&&(e==null||e.onAddMastery(p.masteryType,p.experience??0));const m=(E=p.getItems(void 0,p.masteryType,p.masteryType?y.mastery[p.masteryType]:void 0))==null?void 0:E.filter(A=>!(e!=null&&e.state.prohibitedItems.includes(A.name))).filter(A=>!!(e!=null&&e.addInventory(A)));if(m!=null&&m.length&&(e==null||e.onLog(["You gained:",(()=>{var A=ll();return b(A,m==null?void 0:m.map(C=>C.label).join(", ")),A})()],"drop")),p.noRepeat)return((x=p.onComplete)==null?void 0:x.call(p))??(e==null?void 0:e.onNavigate("_back"));r(p.cooldown??0),t==null||t.evt.addEventListener(H.type,c)},c=()=>{if(s()<=0)return t==null||t.evt.removeEventListener(H.type,c),u();r(s()-1)};return Me(()=>{t==null||t.evt.removeEventListener(H.type,d),t==null||t.evt.removeEventListener(H.type,c)}),g(q,{get when(){return!(t!=null&&t.pause())},get children(){var y=al(),p=y.firstChild;return b(p,()=>e==null?void 0:e.story().label),b(y,g(q,{get when(){return n()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var m=rl();return b(m,()=>e==null?void 0:e.story().description),m})(),(()=>{var m=sl();return b(m,g(Ve,{get ticks(){return o()},onFinish:u,label:"Task",showPc:!0})),m})()]}}),null),y}})};var ol=v('<div class="text-lg font-bold mt-5">Weapon'),cl=v('<div class="text-lg font-bold mt-5">Armour'),ul=v('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Equip</button><button>Stats'),fl=v('<div class="flex flex-row justify-between border-gray-700"><div></div><div>'),dl=v('<div class="flex flex-row justify-between items-center border-gray-700"><div></div><div class="text-xs text-gray-500">');const hl=()=>{const[e,t]=j("stats"),n=V(W),l=T(()=>{const r=n==null?void 0:n.player.attackDamage(),i=1e3/He,a=1/(((n==null?void 0:n.player.attackRate())??ae)/i);return[{label:"Health",value:(n==null?void 0:n.player.stats.health)??0},{label:"Max health",value:(n==null?void 0:n.player.stats.maxHealth)??0},{label:"",value:" "},{label:"Att. min",value:(r==null?void 0:r.at(0))??0},{label:"Att. max",value:(r==null?void 0:r.at(1))??0},{label:"Att. rate",value:`${(a==null?void 0:a.toFixed(2))??0} p/s`},{label:"",value:" "},{label:"Phys. res",value:(n==null?void 0:n.player.stats.physRes)??0},{label:"Mag. res",value:(n==null?void 0:n.player.stats.magRes)??0}]}),s=T(()=>{const r=["weapon","offhand"],i=["head","shoulder","chest","hand","leg","foot"];return[{label:ol(),isDisabled:!1,isEmpty:!0},...r.map(a=>{const o=a&&(n==null?void 0:n.player.equipment.find(d=>d.equipSlot===a));return{label:(o==null?void 0:o.label)??a,isDisabled:!o,subtext:Object.entries((o==null?void 0:o.stats)??{}).map(([d,u])=>`[${d}: ${u}]`).join(""),onClick:o?()=>n==null?void 0:n.onUnequip(o):void 0}}),{label:cl(),isDisabled:!1,isEmpty:!0},...i.map(a=>{const o=a&&(n==null?void 0:n.player.equipment.find(d=>d.equipSlot===a));return{label:(o==null?void 0:o.label)??a,isDisabled:!o,subtext:Object.entries((o==null?void 0:o.stats)??{}).map(([d,u])=>`[${d}: ${u}]`).join(""),onClick:o?()=>n==null?void 0:n.onUnequip(o):void 0}})]});return(()=>{var r=ul(),i=r.firstChild,a=i.nextSibling,o=a.firstChild,d=o.nextSibling;return b(i,g(be,{get children(){return[g(N,{get when(){return e()==="stats"},get children(){return g(z,{get each(){return l()},children:u=>(()=>{var c=fl(),y=c.firstChild,p=y.nextSibling;return b(y,()=>u.label),b(p,()=>u.value),U(()=>c.classList.toggle("border-b",!!u.label)),c})()})}}),g(N,{get when(){return e()==="equip"},get children(){return g(z,{get each(){return s()},children:u=>(()=>{var c=dl(),y=c.firstChild,p=y.nextSibling;return We(c,"click",u.onClick),b(y,()=>u.label),b(p,()=>u.subtext),U(m=>{var E=!u.isEmpty,x=!!u.isDisabled;return E!==m.e&&c.classList.toggle("border-b",m.e=E),x!==m.t&&y.classList.toggle("text-gray-700",m.t=x),m},{e:void 0,t:void 0}),c})()})}})]}})),o.$$click=()=>t("equip"),d.$$click=()=>t("stats"),U(u=>{var c=e()==="equip",y=e()==="stats";return c!==u.e&&o.classList.toggle("selected",u.e=c),y!==u.t&&d.classList.toggle("selected",u.t=y),u},{e:void 0,t:void 0}),r})()};re(["click"]);var gl=v('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative mb-3"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="px-2 py-1 bg-blue-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Take</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All</button></div></div><div class="px-2 py-1 bg-red-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Drop</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All'),yl=v('<div class="h-full relative pb-2"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2"></div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Leave stash'),bl=v('<div class="border p-1 cursor-pointer flex flex-row justify-between"><div></div><div>(<!>)'),pl=v('<div class="border p-1 flex flex-row justify-between border-gray-700 text-gray-700">Empty');const ml=()=>{const e=V(W),[t,n]=j(),l=T(()=>((e==null?void 0:e.state.stash)??[]).map(o=>o?{...F[o.name],stack:o.stack}:null)),s=o=>{o<0||!(e!=null&&e.state.stash[o])||n(o)},r=T(()=>{const o=t()??-1;if(!(o<0))return l().at(o)}),i=o=>{const d=r();d&&(e==null||e.removeInventory(d,o),o>=(d.stack??1)&&n(void 0))},a=o=>{const d=r();if(!d)return;o=o===1/0?(e==null?void 0:e.state.stash.reduce((c,y)=>(y==null?void 0:y.name)===d.name?c+y.stack:c,0))??0:o;const u=e==null?void 0:e.addInventory(d,o);e==null||e.removeStash(d,u)};return(()=>{var o=yl(),d=o.firstChild,u=d.nextSibling;return d.$$click=()=>n(void 0),b(d,g(z,{get each(){return l()},children:(c,y)=>g(_l,{item:c,onSelect:()=>s(y())})})),b(o,g(q,{get when(){return r()},get children(){var c=gl(),y=c.firstChild,p=y.firstChild,m=p.firstChild,E=m.nextSibling,x=E.firstChild,A=x.nextSibling;A.nextSibling;var C=p.nextSibling,k=C.firstChild,$=k.firstChild,L=$.nextSibling,P=L.firstChild,D=P.nextSibling,Y=D.nextSibling,J=k.nextSibling,Q=J.firstChild,f=Q.nextSibling,_=f.firstChild,w=_.nextSibling,S=w.nextSibling;return m.$$click=()=>n(void 0),b(E,()=>{var h;return(h=r())==null?void 0:h.label},x),b(E,()=>{var h;return(h=r())==null?void 0:h.stack},A),P.$$click=()=>a(1),D.$$click=()=>{var h;return a(((h=r())==null?void 0:h.stack)??1)},Y.$$click=()=>a(1/0),_.$$click=()=>i(1),w.$$click=()=>{var h;return i(((h=r())==null?void 0:h.stack)??1)},S.$$click=()=>i(1/0),c}}),u),u.$$click=()=>e==null?void 0:e.onNavigate("_back"),o})()},_l=e=>{const t=n=>{n.stopPropagation(),e.onSelect()};return g(q,{get when(){return e.item},get fallback(){return pl()},get children(){var n=bl(),l=n.firstChild,s=l.nextSibling,r=s.firstChild,i=r.nextSibling;return i.nextSibling,n.$$click=t,b(l,()=>{var a;return(a=e.item)==null?void 0:a.label}),b(s,()=>{var a;return(a=e.item)==null?void 0:a.stack},i),n}})};re(["click"]);var vl=v('<div class="flex flex-col p-2 gap-2 w-full"><div class="border p-2 font-bold cursor-pointer">RESET');const wl=()=>{const e=V(W);return(()=>{var t=vl(),n=t.firstChild;return We(n,"click",e==null?void 0:e.onClearState),t})()};re(["click"]);var $l=v('<div class="w-dvw h-dvh lg:w-[360px] lg:h-[800px] flex flex-col justify-between"><div class="h-3/10 bg-gray-400"><div class=h-1/10></div><div class=h-9/10></div></div><div class=h-1/10></div><div class="h-5/10 bg-gray-800">'),Sl=v("<div>Unknown view"),kl=v('<div class="h-1/10 w-full flex flex-row justify-between font-bold">'),xl=v('<div class="flex flex-col gap-2 p-1 h-full"><div class="bg-black text-left pl-1"></div><div class="text-black whitespace-pre-wrap text-left overflow-y-auto text-sm">'),Cl=v('<div class="h-full bg-white flex flex-row"><div class="text-black bottom-0 left-0 border border-gray-100 p-1 flex flex-col gap-1 bg-white"><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide bad"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide good"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide meta"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide drop"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide basic"></div></div><div class="text-black h-full overflow-y-auto flex flex-col w-full">'),Al=v('<div class="flex flex-row items-center px-1 transition-colors duration-500 border-t border-gray-200"><div class="text-xs text-blue-400 mr-1">[<!>]</div><div class="text-wrap text-xs text-left">'),Ll=v('<div class="flex flex-row bg-black px-1 justify-between"><div class=text-red-500>HP <!>/</div><div class=text-yellow-500>Gold </div><div class=text-green-500>Lvl <!> (<!>%)'),El=v('<div class="content-center w-1/4 border border-l-0 cursor-pointer last:border-r-0">');function Ml(){return g(xn,{get children(){return g(zt,{get children(){return g(Tl,{})}})}})}const Tl=()=>{const[e,t]=j("story"),n=V(W),l=T(()=>e()==="story"&&(n==null?void 0:n.story().name)==="story_stash_1"?"stash":e());return(()=>{var s=$l(),r=s.firstChild,i=r.firstChild,a=i.nextSibling,o=r.nextSibling,d=o.nextSibling;return b(i,g(ql,{})),b(a,g(jl,{})),b(o,g(Ol,{})),b(d,g(be,{get fallback(){return Sl()},get children(){return[g(N,{get when(){return l()==="story"},get children(){return g(Tn,{})}}),g(N,{get when(){return l()==="stash"},get children(){return g(ml,{})}}),g(N,{get when(){return l()==="invent"},get children(){return g(Nn,{})}}),g(N,{get when(){return l()==="skills"},get children(){return g(Wn,{})}}),g(N,{get when(){return l()==="stats"},get children(){return g(hl,{})}}),g(N,{get when(){return l()==="menu"},get children(){return g(wl,{})}})]}})),b(s,g(Il,{onChange:t,get view(){return e()}}),null),s})()},Il=e=>(()=>{var t=kl();return b(t,g(ue,{label:"Story",onClick:()=>e.onChange("story"),get view(){return e.view},type:"story"}),null),b(t,g(ue,{label:"Invent",onClick:()=>e.onChange("invent"),get view(){return e.view},type:"invent"}),null),b(t,g(ue,{label:"Skills",onClick:()=>e.onChange("skills"),get view(){return e.view},type:"skills"}),null),b(t,g(ue,{label:"Stats",onClick:()=>e.onChange("stats"),get view(){return e.view},type:"stats"}),null),b(t,g(ue,{label:"Menu",onClick:()=>e.onChange("menu"),get view(){return e.view},type:"menu"}),null),t})(),jl=()=>{const e=V(W);return g(be,{get children(){return[g(N,{get when(){return(e==null?void 0:e.story().type)==="dialogue"},get children(){var t=xl(),n=t.firstChild,l=n.nextSibling;return b(n,()=>(e==null?void 0:e.story().label)??"Story"),b(l,()=>e==null?void 0:e.story().description),t}}),g(N,{get when(){return(e==null?void 0:e.story().type)==="encounter"},get children(){return g(tl,{})}}),g(N,{get when(){return(e==null?void 0:e.story().type)==="task"},get children(){return g(il,{})}})]}})},Ol=()=>{const[e,t]=j(),{log:n}=V(W)??{},[l,s]=Ne({good:!0,bad:!0,meta:!0,drop:!0,basic:!0}),r=T(()=>{const i=e();if(!i)return;const a=i.scrollTop+i.clientHeight>i.scrollHeight-10;return setTimeout(()=>a&&i.scrollTo(0,i.scrollHeight??0)),n==null?void 0:n().filter(o=>l[o.type])});return(()=>{var i=Cl(),a=i.firstChild,o=a.firstChild,d=o.nextSibling,u=d.nextSibling,c=u.nextSibling,y=c.nextSibling,p=a.nextSibling;return o.$$click=()=>s("bad",!l.bad),d.$$click=()=>s("good",!l.good),u.$$click=()=>s("meta",!l.meta),c.$$click=()=>s("drop",!l.drop),y.$$click=()=>s("basic",!l.basic),Nt(t,p),b(p,g(z,{get each(){return r()},children:m=>(()=>{var E=Al(),x=E.firstChild,A=x.firstChild,C=A.nextSibling;C.nextSibling;var k=x.nextSibling;return b(x,()=>m.time,C),b(k,()=>m.msg),U($=>dt(E,{"last:bg-red-500 last:text-white bg-red-200":m.type==="bad","last:bg-green-500 last:text-white bg-green-200":m.type==="good","last:bg-yellow-500 bg-yellow-200":m.type==="meta","last:bg-blue-500 last:text-white bg-blue-200":m.type==="drop"},$)),E})()})),U(m=>{var E=!l.bad,x=!!l.bad,A=!l.good,C=!!l.good,k=!l.meta,$=!!l.meta,L=!l.drop,P=!!l.drop,D=!l.basic,Y=!!l.basic;return E!==m.e&&o.classList.toggle("bg-red-100",m.e=E),x!==m.t&&o.classList.toggle("bg-red-500",m.t=x),A!==m.a&&d.classList.toggle("bg-green-100",m.a=A),C!==m.o&&d.classList.toggle("bg-green-500",m.o=C),k!==m.i&&u.classList.toggle("bg-yellow-100",m.i=k),$!==m.n&&u.classList.toggle("bg-yellow-500",m.n=$),L!==m.s&&c.classList.toggle("bg-blue-100",m.s=L),P!==m.h&&c.classList.toggle("bg-blue-500",m.h=P),D!==m.r&&y.classList.toggle("bg-gray-100",m.r=D),Y!==m.d&&y.classList.toggle("bg-gray-500",m.d=Y),m},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},ql=()=>{const e=V(W);return(()=>{var t=Ll(),n=t.firstChild,l=n.firstChild,s=l.nextSibling;s.nextSibling;var r=n.nextSibling;r.firstChild;var i=r.nextSibling,a=i.firstChild,o=a.nextSibling,d=o.nextSibling,u=d.nextSibling;return u.nextSibling,b(n,()=>e==null?void 0:e.player.stats.health,s),b(n,()=>e==null?void 0:e.player.stats.maxHealth,null),b(r,()=>e==null?void 0:e.player.stats.gold,null),b(i,()=>Te((e==null?void 0:e.player.stats.experience)??0),o),b(i,()=>(wt((e==null?void 0:e.player.stats.experience)??0)*100).toFixed(0),u),t})()},ue=e=>(()=>{var t=El();return We(t,"click",e.onClick),b(t,()=>e.label),U(n=>dt(t,{"border-t-0 bg-gray-800":e.view===e.type},n)),t})();re(["click"]);const Pl=document.getElementById("root");Dt(()=>g(Ml,{}),Pl);
