var kt=Object.defineProperty;var xt=(e,t,n)=>t in e?kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var T=(e,t,n)=>xt(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const Ct=!1,At=(e,t)=>e===t,te=Symbol("solid-proxy"),je=Symbol("solid-track"),_e={equals:At};let et=ot;const ee=1,me=2,tt={owned:null,cleanups:null,context:null,owner:null};var M=null;let Ie=null,Et=null,j=null,H=null,z=null,Ee=0;function pe(e,t){const n=j,l=M,s=e.length===0,r=t===void 0?l:t,o=s?tt:{owned:null,cleanups:null,context:r?r.context:null,owner:r},i=s?e:()=>e(()=>Y(()=>de(o)));M=o,j=null;try{return oe(i,!0)}finally{j=n,M=l}}function I(e,t){t=t?Object.assign({},_e,t):_e;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},l=s=>(typeof s=="function"&&(s=s(n.value)),it(n,s));return[st.bind(n),l]}function U(e,t,n){const l=Fe(e,t,!1,ee);be(l)}function ve(e,t,n){et=Mt;const l=Fe(e,t,!1,ee);l.user=!0,z?z.push(l):be(l)}function L(e,t,n){n=n?Object.assign({},_e,n):_e;const l=Fe(e,t,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=n.equals||void 0,be(l),st.bind(l)}function nt(e){return oe(e,!1)}function Y(e){if(j===null)return e();const t=j;j=null;try{return e()}finally{j=t}}function ge(e){ve(()=>Y(e))}function Le(e){return M===null||(M.cleanups===null?M.cleanups=[e]:M.cleanups.push(e)),e}function Oe(){return j}function lt(e,t){const n=Symbol("context");return{id:n,Provider:jt(n),defaultValue:e}}function F(e){let t;return M&&M.context&&(t=M.context[e.id])!==void 0?t:e.defaultValue}function rt(e){const t=L(e),n=L(()=>qe(t()));return n.toArray=()=>{const l=n();return Array.isArray(l)?l:l!=null?[l]:[]},n}function st(){if(this.sources&&this.state)if(this.state===ee)be(this);else{const e=H;H=null,oe(()=>$e(this),!1),H=e}if(j){const e=this.observers?this.observers.length:0;j.sources?(j.sources.push(this),j.sourceSlots.push(e)):(j.sources=[this],j.sourceSlots=[e]),this.observers?(this.observers.push(j),this.observerSlots.push(j.sources.length-1)):(this.observers=[j],this.observerSlots=[j.sources.length-1])}return this.value}function it(e,t,n){let l=e.value;return(!e.comparator||!e.comparator(l,t))&&(e.value=t,e.observers&&e.observers.length&&oe(()=>{for(let s=0;s<e.observers.length;s+=1){const r=e.observers[s],o=Ie&&Ie.running;o&&Ie.disposed.has(r),(o?!r.tState:!r.state)&&(r.pure?H.push(r):z.push(r),r.observers&&at(r)),o||(r.state=ee)}if(H.length>1e6)throw H=[],new Error},!1)),t}function be(e){if(!e.fn)return;de(e);const t=Ee;Lt(e,e.value,t)}function Lt(e,t,n){let l;const s=M,r=j;j=M=e;try{l=e.fn(t)}catch(o){return e.pure&&(e.state=ee,e.owned&&e.owned.forEach(de),e.owned=null),e.updatedAt=n+1,ct(o)}finally{j=r,M=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?it(e,l):e.value=l,e.updatedAt=n)}function Fe(e,t,n,l=ee,s){const r={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:M,context:M?M.context:null,pure:n};return M===null||M!==tt&&(M.owned?M.owned.push(r):M.owned=[r]),r}function we(e){if(e.state===0)return;if(e.state===me)return $e(e);if(e.suspense&&Y(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Ee);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===ee)be(e);else if(e.state===me){const l=H;H=null,oe(()=>$e(e,t[0]),!1),H=l}}function oe(e,t){if(H)return e();let n=!1;t||(H=[]),z?n=!0:z=[],Ee++;try{const l=e();return Tt(n),l}catch(l){n||(z=null),H=null,ct(l)}}function Tt(e){if(H&&(ot(H),H=null),e)return;const t=z;z=null,t.length&&oe(()=>et(t),!1)}function ot(e){for(let t=0;t<e.length;t++)we(e[t])}function Mt(e){let t,n=0;for(t=0;t<e.length;t++){const l=e[t];l.user?e[n++]=l:we(l)}for(t=0;t<n;t++)we(e[t])}function $e(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const l=e.sources[n];if(l.sources){const s=l.state;s===ee?l!==t&&(!l.updatedAt||l.updatedAt<Ee)&&we(l):s===me&&$e(l,t)}}}function at(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=me,n.pure?H.push(n):z.push(n),n.observers&&at(n))}}function de(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),l=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const r=s.pop(),o=n.observerSlots.pop();l<s.length&&(r.sourceSlots[o]=l,s[l]=r,n.observerSlots[l]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)de(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)de(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function It(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ct(e,t=M){throw It(e)}function qe(e){if(typeof e=="function"&&!e.length)return qe(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const l=qe(e[n]);Array.isArray(l)?t.push.apply(t,l):t.push(l)}return t}return e}function jt(e,t){return function(l){let s;return U(()=>s=Y(()=>(M.context={...M.context,[e]:l.value},rt(()=>l.children))),void 0),s}}const Ot=Symbol("fallback");function Xe(e){for(let t=0;t<e.length;t++)e[t]()}function qt(e,t,n={}){let l=[],s=[],r=[],o=0,i=t.length>1?[]:null;return Le(()=>Xe(r)),()=>{let a=e()||[],d=a.length,u,c;return a[je],Y(()=>{let y,p,$,A,C,x,k,E,q;if(d===0)o!==0&&(Xe(r),r=[],l=[],s=[],o=0,i&&(i=[])),n.fallback&&(l=[Ot],s[0]=pe(V=>(r[0]=V,n.fallback())),o=1);else if(o===0){for(s=new Array(d),c=0;c<d;c++)l[c]=a[c],s[c]=pe(b);o=d}else{for($=new Array(d),A=new Array(d),i&&(C=new Array(d)),x=0,k=Math.min(o,d);x<k&&l[x]===a[x];x++);for(k=o-1,E=d-1;k>=x&&E>=x&&l[k]===a[E];k--,E--)$[E]=s[k],A[E]=r[k],i&&(C[E]=i[k]);for(y=new Map,p=new Array(E+1),c=E;c>=x;c--)q=a[c],u=y.get(q),p[c]=u===void 0?-1:u,y.set(q,c);for(u=x;u<=k;u++)q=l[u],c=y.get(q),c!==void 0&&c!==-1?($[c]=s[u],A[c]=r[u],i&&(C[c]=i[u]),c=p[c],y.set(q,c)):r[u]();for(c=x;c<d;c++)c in $?(s[c]=$[c],r[c]=A[c],i&&(i[c]=C[c],i[c](c))):s[c]=pe(b);s=s.slice(0,o=d),l=a.slice(0)}return s});function b(y){if(r[c]=y,i){const[p,$]=I(c);return i[c]=$,t(a[c],p)}return t(a[c])}}}function g(e,t){return Y(()=>e(t||{}))}const ut=e=>`Stale read from <${e}>.`;function J(e){const t="fallback"in e&&{fallback:()=>e.fallback};return L(qt(()=>e.each,e.children,t||void 0))}function R(e){const t=e.keyed,n=L(()=>e.when,void 0,void 0),l=t?n:L(n,void 0,{equals:(s,r)=>!s==!r});return L(()=>{const s=l();if(s){const r=e.children;return typeof r=="function"&&r.length>0?Y(()=>r(t?s:()=>{if(!Y(l))throw ut("Show");return n()})):r}return e.fallback},void 0,void 0)}function ye(e){const t=rt(()=>e.children),n=L(()=>{const l=t(),s=Array.isArray(l)?l:[l];let r=()=>{};for(let o=0;o<s.length;o++){const i=o,a=s[o],d=r,u=L(()=>d()?void 0:a.when,void 0,void 0),c=a.keyed?u:L(u,void 0,{equals:(b,y)=>!b==!y});r=()=>d()||(c()?[i,u,a]:void 0)}return r});return L(()=>{const l=n()();if(!l)return e.fallback;const[s,r,o]=l,i=o.children;return typeof i=="function"&&i.length>0?Y(()=>i(o.keyed?r():()=>{var d;if(((d=Y(n)())==null?void 0:d[0])!==s)throw ut("Match");return r()})):i},void 0,void 0)}function D(e){return e}const ue=e=>L(()=>e());function Pt(e,t,n){let l=n.length,s=t.length,r=l,o=0,i=0,a=t[s-1].nextSibling,d=null;for(;o<s||i<r;){if(t[o]===n[i]){o++,i++;continue}for(;t[s-1]===n[r-1];)s--,r--;if(s===o){const u=r<l?i?n[i-1].nextSibling:n[r-i]:a;for(;i<r;)e.insertBefore(n[i++],u)}else if(r===i)for(;o<s;)(!d||!d.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[r-1]&&n[i]===t[s-1]){const u=t[--s].nextSibling;e.insertBefore(n[i++],t[o++].nextSibling),e.insertBefore(n[--r],u),t[s]=n[r]}else{if(!d){d=new Map;let c=i;for(;c<r;)d.set(n[c],c++)}const u=d.get(t[o]);if(u!=null)if(i<u&&u<r){let c=o,b=1,y;for(;++c<s&&c<r&&!((y=d.get(t[c]))==null||y!==u+b);)b++;if(b>u-i){const p=t[o];for(;i<u;)e.insertBefore(n[i++],p)}else e.replaceChild(n[i++],t[o++])}else o++;else t[o++].remove()}}}const Ye="_$DX_DELEGATE";function Rt(e,t,n,l={}){let s;return pe(r=>{s=r,t===document?e():_(t,e(),t.firstChild?null:void 0,n)},l.owner),()=>{s(),t.textContent=""}}function m(e,t,n,l){let s;const r=()=>{const i=document.createElement("template");return i.innerHTML=e,i.content.firstChild},o=()=>(s||(s=r())).cloneNode(!0);return o.cloneNode=o,o}function le(e,t=window.document){const n=t[Ye]||(t[Ye]=new Set);for(let l=0,s=e.length;l<s;l++){const r=e[l];n.has(r)||(n.add(r),t.addEventListener(r,Ht))}}function Ve(e,t,n,l){Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n}function ft(e,t,n={}){const l=Object.keys(t||{}),s=Object.keys(n);let r,o;for(r=0,o=s.length;r<o;r++){const i=s[r];!i||i==="undefined"||t[i]||(Ge(e,i,!1),delete n[i])}for(r=0,o=l.length;r<o;r++){const i=l[r],a=!!t[i];!i||i==="undefined"||n[i]===a||!a||(Ge(e,i,!0),n[i]=a)}return n}function Dt(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function Nt(e,t,n){return Y(()=>e(t,n))}function _(e,t,n,l){if(n!==void 0&&!l&&(l=[]),typeof t!="function")return Se(e,t,l,n);U(s=>Se(e,t(),s,n),l)}function Ge(e,t,n){const l=t.trim().split(/\s+/);for(let s=0,r=l.length;s<r;s++)e.classList.toggle(l[s],n)}function Ht(e){let t=e.target;const n=`$$${e.type}`,l=e.target,s=e.currentTarget,r=a=>Object.defineProperty(e,"target",{configurable:!0,value:a}),o=()=>{const a=t[n];if(a&&!t.disabled){const d=t[`${n}Data`];if(d!==void 0?a.call(t,d,e):a.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&r(t.host),!0},i=()=>{for(;o()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const a=e.composedPath();r(a[0]);for(let d=0;d<a.length-2&&(t=a[d],!!o());d++){if(t._$host){t=t._$host,i();break}if(t.parentNode===s)break}}else i();r(l)}function Se(e,t,n,l,s){for(;typeof n=="function";)n=n();if(t===n)return n;const r=typeof t,o=l!==void 0;if(e=o&&n[0]&&n[0].parentNode||e,r==="string"||r==="number"){if(r==="number"&&(t=t.toString(),t===n))return n;if(o){let i=n[0];i&&i.nodeType===3?i.data!==t&&(i.data=t):i=document.createTextNode(t),n=re(e,n,l,i)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||r==="boolean")n=re(e,n,l);else{if(r==="function")return U(()=>{let i=t();for(;typeof i=="function";)i=i();n=Se(e,i,n,l)}),()=>n;if(Array.isArray(t)){const i=[],a=n&&Array.isArray(n);if(Pe(i,t,n,s))return U(()=>n=Se(e,i,n,l,!0)),()=>n;if(i.length===0){if(n=re(e,n,l),o)return n}else a?n.length===0?ze(e,i,l):Pt(e,n,i):(n&&re(e),ze(e,i));n=i}else if(t.nodeType){if(Array.isArray(n)){if(o)return n=re(e,n,l,t);re(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Pe(e,t,n,l){let s=!1;for(let r=0,o=t.length;r<o;r++){let i=t[r],a=n&&n[e.length],d;if(!(i==null||i===!0||i===!1))if((d=typeof i)=="object"&&i.nodeType)e.push(i);else if(Array.isArray(i))s=Pe(e,i,a)||s;else if(d==="function")if(l){for(;typeof i=="function";)i=i();s=Pe(e,Array.isArray(i)?i:[i],Array.isArray(a)?a:[a])||s}else e.push(i),s=!0;else{const u=String(i);a&&a.nodeType===3&&a.data===u?e.push(a):e.push(document.createTextNode(u))}}return s}function ze(e,t,n=null){for(let l=0,s=t.length;l<s;l++)e.insertBefore(t[l],n)}function re(e,t,n,l){if(n===void 0)return e.textContent="";const s=l||document.createTextNode("");if(t.length){let r=!1;for(let o=t.length-1;o>=0;o--){const i=t[o];if(s!==i){const a=i.parentNode===e;!r&&!o?a?e.replaceChild(s,i):e.insertBefore(s,n):a&&i.remove()}else r=!0}}else e.insertBefore(s,n);return[s]}const Re=Symbol("store-raw"),ie=Symbol("store-node"),G=Symbol("store-has"),dt=Symbol("store-self");function ht(e){let t=e[te];if(!t&&(Object.defineProperty(e,te,{value:t=new Proxy(e,Vt)}),!Array.isArray(e))){const n=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let s=0,r=n.length;s<r;s++){const o=n[s];l[o].get&&Object.defineProperty(e,o,{enumerable:l[o].enumerable,get:l[o].get.bind(t)})}}return t}function ke(e){let t;return e!=null&&typeof e=="object"&&(e[te]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ne(e,t=new Set){let n,l,s,r;if(n=e!=null&&e[Re])return n;if(!ke(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let o=0,i=e.length;o<i;o++)s=e[o],(l=ne(s,t))!==s&&(e[o]=l)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const o=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let a=0,d=o.length;a<d;a++)r=o[a],!i[r].get&&(s=e[r],(l=ne(s,t))!==s&&(e[r]=l))}return e}function xe(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function he(e,t,n){if(e[t])return e[t];const[l,s]=I(n,{equals:!1,internal:!0});return l.$=s,e[t]=l}function Bt(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===te||t===ie||(delete n.value,delete n.writable,n.get=()=>e[te][t]),n}function gt(e){Oe()&&he(xe(e,ie),dt)()}function Ft(e){return gt(e),Reflect.ownKeys(e)}const Vt={get(e,t,n){if(t===Re)return e;if(t===te)return n;if(t===je)return gt(e),n;const l=xe(e,ie),s=l[t];let r=s?s():e[t];if(t===ie||t===G||t==="__proto__")return r;if(!s){const o=Object.getOwnPropertyDescriptor(e,t);Oe()&&(typeof r!="function"||e.hasOwnProperty(t))&&!(o&&o.get)&&(r=he(l,t,r)())}return ke(r)?ht(r):r},has(e,t){return t===Re||t===te||t===je||t===ie||t===G||t==="__proto__"?!0:(Oe()&&he(xe(e,G),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Ft,getOwnPropertyDescriptor:Bt};function Ce(e,t,n,l=!1){if(!l&&e[t]===n)return;const s=e[t],r=e.length;n===void 0?(delete e[t],e[G]&&e[G][t]&&s!==void 0&&e[G][t].$()):(e[t]=n,e[G]&&e[G][t]&&s===void 0&&e[G][t].$());let o=xe(e,ie),i;if((i=he(o,t,s))&&i.$(()=>n),Array.isArray(e)&&e.length!==r){for(let a=e.length;a<r;a++)(i=o[a])&&i.$();(i=he(o,"length",r))&&i.$(e.length)}(i=o[dt])&&i.$()}function bt(e,t){const n=Object.keys(t);for(let l=0;l<n.length;l+=1){const s=n[l];Ce(e,s,t[s])}}function Ut(e,t){if(typeof t=="function"&&(t=t(e)),t=ne(t),Array.isArray(t)){if(e===t)return;let n=0,l=t.length;for(;n<l;n++){const s=t[n];e[n]!==s&&Ce(e,n,s)}Ce(e,"length",l)}else bt(e,t)}function fe(e,t,n=[]){let l,s=e;if(t.length>1){l=t.shift();const o=typeof l,i=Array.isArray(e);if(Array.isArray(l)){for(let a=0;a<l.length;a++)fe(e,[l[a]].concat(t),n);return}else if(i&&o==="function"){for(let a=0;a<e.length;a++)l(e[a],a)&&fe(e,[a].concat(t),n);return}else if(i&&o==="object"){const{from:a=0,to:d=e.length-1,by:u=1}=l;for(let c=a;c<=d;c+=u)fe(e,[c].concat(t),n);return}else if(t.length>1){fe(e[l],t,[l].concat(n));return}s=e[l],n=[l].concat(n)}let r=t[0];typeof r=="function"&&(r=r(s,n),r===s)||l===void 0&&r==null||(r=ne(r),l===void 0||ke(s)&&ke(r)&&!Array.isArray(r)?bt(s,r):Ce(e,l,r))}function De(...[e,t]){const n=ne(e||{}),l=Array.isArray(n),s=ht(n);function r(...o){nt(()=>{l&&o.length===1?Ut(n,o[0]):fe(n,o)})}return[s,r]}const Wt=80,Kt=5,yt=1.7,pt=20,se=20,Ne=100,_t=500,Xt=720*60*1e3,Yt=5,mt=new Array(495).fill(1).map((e,t)=>Math.floor(Wt*Math.pow(t+1,yt))),Ae=new Array(500).fill(1).map((e,t)=>Math.floor(Kt*Math.pow(t+1,yt))),vt=(e,t=mt)=>{if(!e)return 0;const n=t.findIndex(r=>r>e);if(n<0&&e>0)return 1;const l=e-(t[n-1]??0),s=t[n]-(t[n-1]??0);return l/s},Te=(e,t=mt)=>{const n=t.findIndex(l=>l>e);return n<0&&e>0?t.length:n};var Gt=m('<div class="flex w-full absolute h-full items-center bg-main justify-center text-white text-xl top-0 left-0">Catching up... (<!>)');const Me=lt(),N=new Event("tick"),zt=e=>{const[t,n]=I(0),[l,s]=I(!0),[r,o]=I(0),i=new EventTarget;ge(()=>{setInterval(()=>{l()||(n(t()+1),i==null||i.dispatchEvent(N))},Ne)}),document.addEventListener("visibilitychange",()=>{document.hidden?(s(!0),window.localStorage.setItem("freeze_time",`${Date.now()}`)):a()});const a=()=>{s(!0);const c=parseInt(window.localStorage.getItem("freeze_time")??`${Date.now()}`),b=Math.min(Date.now()-c,Xt);let y=Math.floor(b/Ne);o(y),d()},d=()=>{let c=r();c>0&&requestIdleCallback(()=>{let b=1e3;for(;c>0&&b>0;)i==null||i.dispatchEvent(N),n(t()+1),c--,b--;o(c),c>0?d():s(!1)})};window.addEventListener("load",()=>setTimeout(a,500)),window.addEventListener("beforeunload",()=>{window.localStorage.setItem("freeze_time",`${Date.now()}`)});const u=()=>i==null?void 0:i.dispatchEvent(N);return g(Me.Provider,{value:{evt:i,fire:u,pause:l},get children(){return[ue(()=>e.children),g(R,{get when(){return l()},get children(){var c=Gt(),b=c.firstChild,y=b.nextSibling;return y.nextSibling,_(c,r,y),c}})]}})},Jt=[{name:"hay_hand_1",label:"Hay hand wraps",stackable:!1,equipSlot:"hand",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{attMin:1,attMax:3}},{name:"hay_head_1",label:"Hay bandana",stackable:!1,equipSlot:"head",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",25]],stats:{maxHealth:5}},{name:"hay_chest_1",label:"Hay vest",stackable:!1,equipSlot:"chest",craftComplexity:1,craftType:"basic",craftLevel:1,ingredients:[["hay_1",50]],stats:{physRes:1}},{name:"utility_axe_1",label:"Rusty axe",stackable:!1,equipSlot:"weapon",utilityType:"axe",stats:{}}],Qt=[{name:"recipe_hay_hand_1",label:"Recipe: Hay hand wraps",stackable:!1,exclusive:!0,craftableItem:"hay_hand_1"},{name:"recipe_hay_head_1",label:"Recipe: Hay bandana",stackable:!1,exclusive:!0,craftableItem:"hay_head_1"},{name:"recipe_hay_chest_1",label:"Recipe: Hay vest",stackable:!1,exclusive:!0,craftableItem:"hay_chest_1"}].map(e=>({...e,use:t=>(t.onTask({noRepeat:!0,label:"Learning",description:e.label,duration:100,onComplete:()=>(t.player.recipes.includes(e.craftableItem)||(t.setPlayer("recipes",[...t.player.recipes,e.craftableItem]),t.setState("prohibitedItems",[...t.state.prohibitedItems,e.name])),t.removeInventory(e.name),t.onNavigate("_back"),!0)}),!1)})),Zt=[{name:"hay_1",label:"Hay",stackable:!0,maxStack:100},{name:"wood_log_1",label:"Wooden log",stackable:!0,maxStack:100}],en=[{name:"wood_club_1",label:"Wooden Club",equipSlot:"weapon",craftType:"weapon",craftComplexity:1,craftLevel:1,ingredients:[["wood_log_1",15]],masteryType:"mace",stats:{attMin:2,attMax:5,attSpeed:-.1}},{name:"wood_shield_1",label:"Wooden Shield",equipSlot:"offhand",craftType:"armour",craftComplexity:1,craftLevel:1,ingredients:[["wood_log_1",20]],stats:{physRes:2,maxHealth:10}},{name:"wood_chest_1",label:"Wooden Plank Vest",equipSlot:"chest",craftType:"armour",craftComplexity:2,craftLevel:1,ingredients:[["wood_log_1",40]],stats:{physRes:3,agility:-1}},{name:"stone_axe_1",label:"Stone Axe",equipSlot:"weapon",craftType:"weapon",craftComplexity:2,craftLevel:2,ingredients:[["wood_log_1",10],["stone_1",10]],masteryType:"axe",stats:{attMin:3,attMax:8,attSpeed:-.05,strength:1}},{name:"stone_helm_1",label:"Stone Helm",equipSlot:"head",craftType:"armour",craftComplexity:2,craftLevel:2,ingredients:[["stone_1",20],["hay_1",10]],stats:{physRes:4,maxHealth:10,intelligence:-1}},{name:"copper_sword_1",label:"Copper Shortsword",equipSlot:"weapon",craftType:"weapon",craftComplexity:3,craftLevel:2,ingredients:[["copper_ingot_1",8],["wood_log_1",5]],masteryType:"sword",stats:{attMin:4,attMax:10,attSpeed:.1,dexterity:1}},{name:"copper_chest_1",label:"Copper Breastplate",equipSlot:"chest",craftType:"armour",craftComplexity:3,craftLevel:2,ingredients:[["copper_ingot_1",15]],stats:{physRes:5,magRes:1,strength:1}},{name:"iron_spear_1",label:"Iron Spear",equipSlot:"weapon",craftType:"weapon",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",12],["wood_log_1",8]],masteryType:"spear",stats:{attMin:6,attMax:14,attSpeed:0,dexterity:2}},{name:"iron_helm_1",label:"Iron Helmet",equipSlot:"head",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",8]],stats:{physRes:6,maxHealth:15,charisma:-1}},{name:"iron_boots_1",label:"Iron Greaves",equipSlot:"foot",craftType:"armour",craftComplexity:4,craftLevel:3,ingredients:[["iron_ingot_1",6]],stats:{physRes:3,agility:-1}}],B=[Jt,Qt,Zt,en].flat().reduce((e,t)=>(e[t.name]=t,e),{});var tn=m('<div class="font-bold m-2">'),nn=m("<div>");const He=e=>(()=>{var t=tn();return _(t,g(J,{get each(){return e.lines},children:(n,l)=>(()=>{var s=nn();return _(s,g(R,{get when(){return l()===0},children:'" .. '}),null),_(s,n,null),_(s,g(R,{get when(){return l()===e.lines.length-1},children:' .. "'}),null),s})()})),t})();var ln=m("<span class=text-red-500>Fight scarecrows"),rn=m('<span class="font-bold ml-1">'),sn=m('<span class="font-bold text-blue-500 mr-1">Hay'),on=m("<span class=font-bold>");const an=[{name:"story_town_1",label:"Town",description:"You are in town",type:"dialogue",options:[{label:"Visit Farm",goto:"story_farmer_1"},{label:"Leave the town",goto:"story_forest_1"},{label:"Merchants",goto:"story_town_merchants_1"},{label:"Home",goto:"story_home_1"}]},{name:"story_farmer_1",label:"Farm",description:"A vacant expressionless farmer. Hasn't washed in days.",type:"dialogue",options:[{label:"Approach the farmer",goto:"story_farmer_2"},{label:ln(),goto:"story_scarecrows_1"},{label:"Sell Hay",action:e=>{const t=e.player.invent,{removeInventory:n,onAddStat:l}=e,s=t.filter(r=>(r==null?void 0:r.name)==="hay_1").reduce((r,o)=>r+((o==null?void 0:o.stack)??0),0);s&&(n("hay_1",s),l("gold",s),e.onLog(["You sell",(()=>{var r=rn();return _(r,s),r})()," ",sn(),"For ",(()=>{var r=on();return _(r,s),r})()," gold"],"meta"))}}]},{name:"story_farmer_2",label:"Farmer",description:["You approach, he holds your wrist loosely like an exhausted child.",g(He,{lines:["Loathsome shadowed cloaks","Golden light shimmering, blind eyes","Fear, is Death knocking?"]}),"He sits and cries."],type:"dialogue",options:[{label:"Console",goto:"story_farmer_3"},{label:"Leave",goto:"_back"}]},{name:"story_farmer_3",label:"Farmer",description:g(He,{lines:["Am *I* the keeper of the wheat?","... or is it the keeper of me?"]}),type:"dialogue",options:[{label:"Silently leave",goto:"_back.2"}]},{name:"story_scarecrows_1",label:"Scarecrows",description:"Fighting scarecrows",type:"encounter",cooldown:20,encounters:[{name:"enc_scarecrow_1",label:"Scarecrow",health:10,chance:1,experience:50,drops:[{name:"hay_1",chance:1},{name:"recipe_hay_hand_1",chance:.05},{name:"recipe_hay_head_1",chance:.05},{name:"recipe_hay_chest_1",chance:.05}]}]}],cn=[{type:"craft",name:"bench_simple",label:"Simple crafting bench",cratingType:"basic",craftingComplexity:1}],un=cn.reduce((e,t)=>(e[t.name]=t,e),{});var fn=m("<div class=font-bold>Stash"),dn=m("<div>Retrieve items from stash here, place in stash from your invent");const hn=[{name:"story_home_1",label:"Home",description:"Home sweet home",type:"dialogue",options:[{label:"Build",goto:"story_home_2"},{label:"Stash",goto:"story_stash_1"},{label:"Craft",goto:"story_home_4"}]},{name:"story_stash_1",label:"Stash",type:"dialogue",description:[fn(),dn()]},{name:"story_home_4",label:"Crafting",description:"A workshop",type:"dialogue",options:e=>e.state.furniture.map(t=>un[t]).filter(t=>t.type==="craft").map(t=>({label:t.label,goto:`story_craft_${t.cratingType}_1`}))},{name:"story_craft_basic_1",label:"Basic crafting",description:"A very simple crafting table",type:"dialogue",options:e=>e.player.recipes.map(t=>B[t]).filter(t=>t.craftType==="basic").map(t=>{var n;return{label:t.label,action:l=>{l.onTask({noRepeat:!0,label:"Crafting",description:t.label,duration:100,onComplete:()=>gn(l,t)})},isDisabled:!bn(e,t),subtext:(n=t.ingredients)==null?void 0:n.map(l=>`${B[l[0]].label} (${l[1]})`).join(" - ")}})}],gn=(e,t)=>{var n;e.addInventory(t),(n=t.ingredients)==null||n.forEach(l=>e.removeInventory(...l))},bn=(e,t)=>{var n;return(n=t.ingredients)!=null&&n.length?t.ingredients.every(l=>e.player.invent.reduce((r,o)=>((o==null?void 0:o.name)===l[0]&&(r=r+(o.stack??1)),r),0)>=l[1]):!0},yn=[{type:"dialogue",name:"story_forest_1",label:"Forest border",description:"The canopy casts a shadow. Sounds, eyes ... movement",options:e=>[{label:"Chop wood",goto:"task_chop_wood_1",isDisabled:!!!e.player.equipment.find(n=>n.equipSlot==="weapon"&&n.utilityType==="axe")}]},{type:"task",name:"task_chop_wood_1",label:"Surrounded by trees",description:"Chopping wood",duration:100,masteryType:"woodcutting",cooldown:10,experience:1,utilityType:"axe",items:[{name:"wood_log_1",chance:1}]}],pn=[{name:"utility_axe_1",cost:100}],_n=[{type:"dialogue",name:"story_town_merchants_1",label:"Town Bazaar",description:"Souks, stalls, spices, hands... hands... hands...",options:[{label:"Tool merchant",goto:"story_town_merchant_tool_1"}]},{type:"dialogue",name:"story_town_merchant_tool_1",label:"Tool Merchant",description:["A burly man, skin of leather ",g(He,{lines:["The very finest tools"]})],options:e=>{const t=e.player.stats.gold;return pn.map(n=>{const l=B[n.name];return{label:(l==null?void 0:l.label)??"UNKNOWN",action:s=>{s.addInventory(l),s.onAddStat("gold",0-n.cost),s.onNavigate("story_town_merchant_tool_1")},isDisabled:n.cost>t}})}}],Be=[an,hn,yn,_n].flat().reduce((e,t)=>(e[t.name]=t,e),{}),mn=[{name:"furniture_bench_basic_1",label:"Basic bench",type:"craft",craftingComplexity:1,cratingType:"basic"},{name:"furniture_stash_1",label:"Basic stash",type:"stash",storageSize:5}],vn=[mn].flat().reduce((e,t)=>(e[t.name]=t,e),{}),wn=[{name:"unarmed",label:"Unarmed",bonus:new Array(_t+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{attMin:t%10===0?1:0,attMax:1,attSpeed:t%50===0?.1:0}}}).filter(Boolean)}],$n=[{name:"woodcutting",label:"Woodcutting",bonus:new Array(_t+1).fill(null).map((e,t)=>{if(!(!t||t%5!==0))return{level:t,stats:{durationModifier:t%10===0?10:0},dropModifiers:[{name:"wood_log_1",chance:t%50===0?1:0}]}}).filter(Boolean)}],Ue=[wn,$n].flat().reduce((e,t)=>(e[t.name]=t,e),{}),wt=(e,t)=>{const n=Ue[e];if(!n)return{};const l=Te(t,Ae),s=n.bonus.filter(r=>r.level<=l);return(s==null?void 0:s.reduce((r,o)=>(Object.entries(o.stats).forEach(([i,a])=>{r[i]=(r[i]??0)+a}),r),{}))??{}},Sn=(e,t,n)=>{const l=Ue[t];if(!l)return 0;const s=Te(n,Ae),r=l.bonus.filter(o=>o.level<=s);return r==null?void 0:r.reduce((o,i)=>{var a,d;return o+(((d=(a=i.dropModifiers)==null?void 0:a.find(u=>u.name===e))==null?void 0:d.chance)??0)},0)};let $t=class{constructor(t){T(this,"name");T(this,"label");T(this,"description");T(this,"type");T(this,"encounters");T(this,"duration");T(this,"noRepeat");T(this,"cooldown");T(this,"items");T(this,"skills");T(this,"options");T(this,"onComplete");T(this,"masteryType");T(this,"experience");T(this,"utilityType");this.label=t.label,this.type=t.type,this.name=t.name,this.description=t.description,Object.assign(this,t)}getEncounter(){var n;if(this.type==="task")return{name:"task",label:this.label,health:this.duration??0,chance:1,drops:this.items};const t=Math.random();if(!(this.type!=="encounter"||!((n=this.encounters)!=null&&n.length)))return this.encounters.sort((l,s)=>l.chance-s.chance).find(l=>t<=l.chance)}getDrops(t){return this.getItems(t==null?void 0:t.drops)}getItems(t=this.items??[],n,l){let s=[];for(let r of t){let o=r.chance;for(n&&l&&(o=o+Sn(r.name,n,l));o>0;)Math.random()<=o&&s.push(r),o--}return s==null?void 0:s.map(r=>B[r.name]).filter(Boolean)}};class Je{constructor(t={},n=new Array(pt).fill(null)){T(this,"equipment");T(this,"stats");T(this,"mastery");T(this,"invent");T(this,"recipes");this.equipment=t.equipment??[],this.mastery=t.mastery??{},this.recipes=t.recipes??[],this.stats=t.stats??{gold:120,experience:0,health:10,maxHealth:10,strength:1,agility:1,attSpeed:0},this.invent=n}weaponMastery(){var t;return((t=this.equipment.find(n=>n.equipSlot==="weapon"))==null?void 0:t.masteryType)??"unarmed"}getMasteryPerk(t){return wt(t,this.mastery[t]??0)}attackDamage(){let t=this.equipment.reduce((a,d)=>{var u;return a+(((u=d.stats)==null?void 0:u.attMin)??0)},1),n=this.equipment.reduce((a,d)=>{var u;return a+(((u=d.stats)==null?void 0:u.attMax)??0)},1);const l=this.weaponMastery(),s=this.getMasteryPerk(l);t+=(s==null?void 0:s.attMin)??0,n+=(s==null?void 0:s.attMax)??0;const r=1+Math.pow((this.stats.strength??0)/100,.7),o=Math.round(t*r),i=Math.round(n*r);return[o,i]}attackRate(){const n=Math.min(100,Math.max(1,this.stats.agility??0)),l=1,s=se/5,r=Math.sqrt(n/100),o=s*r,i=se/5,a=Math.min(this.equipment.reduce((C,x)=>{var k;return C+(((k=x.stats)==null?void 0:k.attSpeed)??0)},0),1),d=a*i,u=se/5,c=this.weaponMastery(),b=this.getMasteryPerk(c),y=(b.attSpeed??0)*u,$=(se/2.5-1)*((r+a+(b.attSpeed??0))/3);return Math.max(se-o-d-$-y,l)}}class Qe{constructor(t){T(this,"prohibitedItems");T(this,"furniture");T(this,"stash");this.prohibitedItems=[],this.furniture=[],this.stash=new Array(Yt).fill(null),Object.assign(this,t)}}const Z="story_town_1",W=lt(),ae=e=>new $t(Be[e]??Be[Z]),kn=e=>{const[t,n]=I(ae(Z)),[l,s]=De(new Je({})),[r,o]=De(new Qe({furniture:["furniture_bench_basic_1"]})),[i,a]=I([Z]),[d,u]=I([]);ge(()=>c());const c=()=>{const f=JSON.parse(window.localStorage.getItem("save")??"null");f&&(s({...f.player,invent:f.player.invent.map(v=>v?{...B[v.name],stack:v.stack}:null)}),o(f.state),a(f.nav),n(ae(f.story)))},b=()=>{nt(()=>{s(new Je({})),o(new Qe({furniture:["furniture_bench_basic_1"]})),n(ae(Z)),a([Z])}),y()},y=()=>{window.localStorage.setItem("save",JSON.stringify({player:ne(l),story:t().name,state:ne(r),nav:i()}))};window.addEventListener("beforeunload",y),setInterval(y,1e4);const p=(f,v=1)=>{if(!v)return v;if(v===1/0)return console.error("Cannot add infinite items to invent"),0;if(typeof f=="string"){if(!B[f])return console.warn("Invalid or not found item",f),v;f=B[f]}let w=[...l.invent];if(f.exclusive&&w.find(h=>(h==null?void 0:h.name)===f.name))return 0;let S=v;return f.stackable&&f.maxStack&&(w=w.map(h=>{if(!(h!=null&&h.name)||!(h!=null&&h.stack)||!h.maxStack||!S)return h;if(h.name===f.name&&h.stack<h.maxStack){let P=Math.min(h.stack+S,h.maxStack);return S-=P-h.stack,{...h,stack:P}}return h})),S&&(w=w.map(h=>{if(!S)return h;if(h===null){const P=Math.min(S,f.maxStack??1);return S-=P,{...f,stack:P}}return h})),S<v&&s("invent",w),v-S},$=(f,v=1)=>{if(!v)return!1;if(typeof f=="string"){if(!B[f])return console.warn("Invalid or not found item",f),!1;f=B[f]}if(l.invent.findLastIndex(h=>(h==null?void 0:h.name)===f.name)<0)return!1;const S=[...l.invent.toReversed().map(h=>{if(!v||(h==null?void 0:h.name)!==f.name||!(h!=null&&h.stack))return h;if(h.stack<=v)return v-=h.stack,null;const P=h.stack-v;return v=0,{...h,stack:P}}).reverse()].filter(Boolean);return S.push(...new Array(pt-S.length).fill(null)),s("invent",S),!0},A=(f,v=1)=>{if(!v)return v;if(v===1/0)return console.error("Cannot add infinite items to stash"),0;if(typeof f=="string"){if(!B[f])return console.warn("Invalid or not found item",f),v;f=B[f]}let w=[...r.stash];if(f.exclusive&&w.find(h=>(h==null?void 0:h.name)===f.name))return 0;let S=v;return f.stackable&&f.maxStack&&(w=w.map(h=>{if(!(h!=null&&h.name)||!(h!=null&&h.stack)||!S)return h;if(h.name===f.name&&h.stack<f.maxStack){let P=Math.min(h.stack+S,f.maxStack);return S-=P-h.stack,{...h,stack:P}}return h})),S&&(w=w.map(h=>{if(!S)return h;if(h===null){const P=Math.min(S,f.maxStack??1);return S-=P,{name:f.name,stack:P}}return h})),S<v&&o("stash",w),v-S},C=L(()=>(console.log(r.furniture.map(f=>vn[f])),1)),x=(f,v=1)=>{if(!v)return!1;if(typeof f=="string"){if(!B[f])return console.warn("Invalid or not found item",f),!1;f=B[f]}if(r.stash.findLastIndex(h=>(h==null?void 0:h.name)===f.name)<0)return!1;const S=[...r.stash.toReversed().map(h=>{if(!v||(h==null?void 0:h.name)!==f.name||!(h!=null&&h.stack))return h;if(h.stack<=v)return v-=h.stack,null;const P=h.stack-v;return v=0,{...h,stack:P}}).reverse()].filter(Boolean);return S.push(...new Array(C()-S.length).fill(null)),o("stash",S),!0},k=f=>{if(f==="_start"){const w=i().at(0)??Z;a([w]),n(ae(w));return}const v=/^_back/.test(f);if(!v&&!Be[f]){console.error(`Unknown story ${f}`);return}if(v){const[w,S]=f.split("."),h=Math.min(parseInt(S??"1"),i().length+1);f=i().at(-1-h)??Z,i().length>1&&a(i().slice(0,-h))}else i().at(-1)!==f&&a([...i(),f]);n(ae(f))},E=(f,v=1)=>{const w=(l.stats[f]??0)+v;s("stats",f,w)},O={story:t,onNavigate:k,onAddStat:E,player:l,state:r,setState:o,setPlayer:s,addInventory:p,removeInventory:$,log:d,onLog:(f,v="basic")=>{var h;const w=new Date,S={msg:f,time:[w.getHours(),w.getMinutes(),w.getSeconds()].join(":"),type:v};u([...d().slice(Math.min(((h=d())==null?void 0:h.length)-999,0)),S])},onAddMastery:(f,v=1)=>{const w=(l.mastery[f]??0)+v;s("mastery",f,w)},onEquip:f=>{if($(f)){let v=!1;return s("equipment",[...l.equipment.map(w=>w.equipSlot===f.equipSlot?(v=!0,Object.entries(w.stats??{}).forEach(([S,h])=>E(S,0-h)),p(w),f):w),...v?[]:[f]]),Object.entries(f.stats??{}).forEach(([w,S])=>E(w,S)),!0}return!1},onUnequip:f=>!!l.equipment.find(w=>w.name===f.name)&&p(f)?(s("equipment",[...l.equipment.filter(w=>w.name!==f.name)]),Object.entries(f.stats??{}).forEach(([w,S])=>E(w,0-S)),!0):!1,onTask:f=>{a([...i(),"task"]),n(new $t({name:"task",type:"task",...f,onComplete:f.noRepeat?f.onComplete??(()=>k("_back")):void 0}))},navStack:i,addStash:A,removeStash:x,onClearState:b};return g(W.Provider,{value:O,get children(){return e.children}})};var xn=m('<div class="flex flex-row mt-auto gap-2"><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Go back</div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Town'),Cn=m('<div class="flex flex-col gap-5 p-2 h-full overflow-y-auto">'),An=m("<div class=text-gray-500>Nothing here..."),En=m('<span class="text-xs text-gray-400">'),Ln=m('<div class="w-full border content-center h-12 text-lg font-bold flex flex-col justify-center">');const Tn=()=>{const e=F(W),t=l=>{if(l.goto)return e==null?void 0:e.onNavigate(l.goto);if(l.action&&e)return l.action(e)},n=L(()=>{const l=e==null?void 0:e.story().options;return Array.isArray(l)?l:(l==null?void 0:l(e))??[]});return(()=>{var l=Cn();return _(l,g(R,{get when(){return n().length},get fallback(){return An()},get children(){return g(J,{get each(){return n()},children:s=>(()=>{var r=Ln();return r.$$click=()=>!s.isDisabled&&t(s),_(r,()=>s.label,null),_(r,g(R,{get when(){return s.subtext},get children(){var o=En();return _(o,()=>s.subtext),o}}),null),U(o=>{var i=!!s.isDisabled,a=!s.isDisabled;return i!==o.e&&r.classList.toggle("text-gray-500",o.e=i),a!==o.t&&r.classList.toggle("cursor-pointer",o.t=a),o},{e:void 0,t:void 0}),r})()})}}),null),_(l,g(R,{get when(){var s;return((s=e==null?void 0:e.story())==null?void 0:s.name)!==Z},get children(){var s=xn(),r=s.firstChild,o=r.nextSibling;return r.$$click=()=>t({label:"Go back",goto:"_back"}),o.$$click=()=>t({label:"Back to town",goto:"_start"}),s}}),null),l})()};le(["click"]);var Mn=m("<button class=m-auto>use"),In=m("<button class=m-auto>equip"),jn=m('<div class="px-2 py-1 bg-blue-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Stash</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All'),On=m('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative mb-3"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="w-full flex flex-row justify-between gp-2 mb-2"></div><div class="px-2 py-1 bg-red-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Drop</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All'),qn=m('<div class="h-full relative"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2">'),Pn=m('<div class="border p-1 cursor-pointer flex flex-row justify-between"><div></div><div>(<!>)'),Rn=m('<div class="border p-1 flex flex-row justify-between border-gray-700 text-gray-700">Empty');const Dn=()=>{const e=F(W),[t,n]=I(),l=u=>{u<0||!(e!=null&&e.player.invent[u])||n(u)},s=L(()=>{const u=t()??-1;if(!(u<0))return e==null?void 0:e.player.invent.at(u)}),r=()=>{var c;const u=s();!u||!e||(c=u==null?void 0:u.use)!=null&&c.call(u,e)&&n(void 0)},o=()=>{const u=s();!(u!=null&&u.equipSlot)||!e||e.onEquip(u)&&n(void 0)},i=u=>{const c=s();c&&(e==null||e.removeInventory(c,u),u>=(c.stack??1)&&n(void 0))},a=u=>{const c=s();if(c&&(u=u===1/0?(e==null?void 0:e.player.invent.reduce((b,y)=>(y==null?void 0:y.name)===c.name?b+(y.stack??0):b,0))??0:u,c)){const b=e==null?void 0:e.addStash(c,u);e==null||e.removeInventory(c,b)}},d=L(()=>e==null?void 0:e.navStack().includes("story_home_1"));return(()=>{var u=qn(),c=u.firstChild;return c.$$click=()=>n(void 0),_(c,g(J,{get each(){return(e==null?void 0:e.player.invent)??[]},children:(b,y)=>g(Nn,{item:b,onSelect:()=>l(y())})})),_(u,g(R,{get when(){return s()},get children(){var b=On(),y=b.firstChild,p=y.firstChild,$=p.firstChild,A=$.nextSibling,C=A.firstChild,x=C.nextSibling;x.nextSibling;var k=p.nextSibling,E=k.firstChild,q=E.nextSibling,V=q.firstChild,K=V.nextSibling,X=K.firstChild,Q=X.nextSibling,O=Q.nextSibling;return $.$$click=()=>n(void 0),_(A,()=>{var f;return(f=s())==null?void 0:f.label},C),_(A,()=>{var f;return(f=s())==null?void 0:f.stack},x),_(E,g(R,{get when(){var f;return(f=s())==null?void 0:f.use},get children(){var f=Mn();return f.$$click=r,f}}),null),_(E,g(R,{get when(){return s().equipSlot},get children(){var f=In();return f.$$click=o,f}}),null),_(k,g(R,{get when(){return d()},get children(){var f=jn(),v=f.firstChild,w=v.nextSibling,S=w.firstChild,h=S.nextSibling,P=h.nextSibling;return S.$$click=()=>a(1),h.$$click=()=>{var Ke;return a(((Ke=s())==null?void 0:Ke.stack)??1)},P.$$click=()=>a(1/0),f}}),q),X.$$click=()=>i(1),Q.$$click=()=>{var f;return i(((f=s())==null?void 0:f.stack)??1)},O.$$click=()=>i(1/0),b}}),null),u})()},Nn=e=>{const t=n=>{n.stopPropagation(),e.onSelect()};return g(R,{get when(){return e.item},get fallback(){return Rn()},get children(){var n=Pn(),l=n.firstChild,s=l.nextSibling,r=s.firstChild,o=r.nextSibling;return o.nextSibling,n.$$click=t,_(l,()=>{var i;return(i=e.item)==null?void 0:i.label}),_(s,()=>{var i;return(i=e.item)==null?void 0:i.stack},o),n}})};le(["click"]);var Hn=m('<div class="w-full h-full border rounded relative text-black bg-gray-500"><div class="ease-linear w-0 h-full rounded"></div><div class="absolute left-1/2 top-1/2 -translate-1/2 whitespace-nowrap">');const St=e=>{const t=F(Me),[n,l]=I(e.ticks),s=()=>{let r=n();r<=0&&(e.onFinish(),r=e.ticks+1),l(r-1)};return ge(()=>t==null?void 0:t.evt.addEventListener(N.type,s)),Le(()=>t==null?void 0:t.evt.removeEventListener(N.type,s)),g(We,{get max(){return e.ticks},get value(){return e.ticks-n()},get type(){return e.type},get showPc(){return e.showPc},get showNumber(){return e.showNumber},get label(){return e.label}})},We=e=>{const t=L(()=>Math.min(e.value/e.max*100,100));return(()=>{var n=Hn(),l=n.firstChild,s=l.nextSibling;return _(s,g(ye,{get children(){return[g(D,{get when(){return e.showPc},get children(){return[ue(()=>e.label)," (",ue(()=>t().toFixed(0)),"%)"]}}),g(D,{get when(){return e.showNumber},get children(){return[ue(()=>e.label)," ",ue(()=>e.value)]}})]}})),U(r=>{var o=t()+"%",i=!e.type,a=e.type==="green",d=e.type==="yellow",u=e.type==="blue",c=e.type==="red";return o!==r.e&&Dt(l,"width",r.e=o),i!==r.t&&l.classList.toggle("bg-white",r.t=i),a!==r.a&&l.classList.toggle("bg-green-500",r.a=a),d!==r.o&&l.classList.toggle("bg-yellow-500",r.o=d),u!==r.i&&l.classList.toggle("bg-blue-500",r.i=u),c!==r.n&&l.classList.toggle("bg-red-500",r.n=c),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),n})()};var Bn=m('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Skills</button><button>Mastery</button><button>Recipes'),Fn=m('<div class="flex flex-row justify-between items-center"><div></div><div class="h-4 w-32">'),Vn=m('<div class="flex flex-row justify-between items-center"><div>');const Un=()=>{const[e,t]=I("mastery"),n=F(W),l=L(()=>Object.entries((n==null?void 0:n.player.mastery)??{}).map(([r,o])=>{const i=Ue[r];return{label:i==null?void 0:i.label,progress:vt(o,Ae)*100,level:Te(o,Ae)}})),s=L(()=>(n==null?void 0:n.player.recipes.map(r=>B[r]))??[]);return(()=>{var r=Bn(),o=r.firstChild,i=o.nextSibling,a=i.firstChild,d=a.nextSibling,u=d.nextSibling;return _(o,g(ye,{get children(){return[g(D,{get when(){return e()==="skills"},children:"TODO"}),g(D,{get when(){return e()==="mastery"},get children(){return g(J,{get each(){return l()},children:c=>(()=>{var b=Fn(),y=b.firstChild,p=y.nextSibling;return _(y,()=>c.label),_(p,g(We,{get label(){return`${c.level}`},type:"yellow",max:100,get value(){return c.progress},showPc:!0})),b})()})}}),g(D,{get when(){return e()==="recipes"},get children(){return g(J,{get each(){return s()},children:c=>(()=>{var b=Vn(),y=b.firstChild;return _(y,()=>c.label),b})()})}})]}})),a.$$click=()=>t("skills"),d.$$click=()=>t("mastery"),u.$$click=()=>t("recipes"),U(c=>{var b=e()==="skills",y=e()==="mastery",p=e()==="recipes";return b!==c.e&&a.classList.toggle("selected",c.e=b),y!==c.t&&d.classList.toggle("selected",c.t=y),p!==c.a&&u.classList.toggle("selected",c.a=p),c},{e:void 0,t:void 0,a:void 0}),r})()};le(["click"]);var Wn=m('<span class="text-red-800 font-bold">'),Kn=m('<span class="text-green-800 font-bold">'),Xn=m('<span class="text-red-800 font-bold m-1">'),Yn=m('<span class="font-bold m-1">'),Gn=m("<div class=text-red-800>"),Ze=m("<div class=h-8>"),zn=m('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>Attacking (<!>)');const Jn=()=>{const e=F(W),t=F(Me),[n,l]=I(25),[s,r]=I(0),[o,i]=I(0),[a,d]=I(),[u,c]=I();ve(()=>{t!=null&&t.pause()?t==null||t.evt.addEventListener(N.type,b):t==null||t.evt.removeEventListener(N.type,b)});const b=()=>{n()<=0&&u()?y():l(n()-1)};ge(()=>{var $;l((e==null?void 0:e.player.attackRate())??25),c(e==null?void 0:e.story().getEncounter()),d(($=u())==null?void 0:$.health)});const y=()=>{var X,Q;const $=!(t!=null&&t.pause()),[A,C]=[e==null?void 0:e.player,e==null?void 0:e.story()],x=u(),k=a();if(!A||!C)return;if(l((e==null?void 0:e.player.attackRate())??25),!x){c(e==null?void 0:e.story().getEncounter()),d((X=u())==null?void 0:X.health);return}if(!k)return;const[E,q]=(e==null?void 0:e.player.attackDamage())??[0,1],V=E+Math.round(Math.random()*(q-E)),K=k-Math.min(V,k);if($&&(e==null||e.onLog(["You hit the ",(()=>{var O=Wn();return _(O,x.label),O})()," for ",(()=>{var O=Kn();return _(O,V),O})()," damage"],"basic")),e==null||e.onAddMastery(e.player.weaponMastery(),V),K<=0){$&&(e==null||e.onLog(["You killed the",(()=>{var f=Xn();return _(f,x.label),f})()],"good")),i(o()+1),c(void 0),x.experience&&(e==null||e.onAddStat("experience",x.experience));const O=(Q=C.getDrops(x))==null?void 0:Q.filter(f=>!(e!=null&&e.state.prohibitedItems.includes(f.name))).filter(f=>!!(e!=null&&e.addInventory(f)));if(O!=null&&O.length&&$&&(e==null||e.onLog(["It dropped:",(()=>{var f=Yn();return _(f,O==null?void 0:O.map(v=>v.label).join(", ")),f})()],"drop")),C.noRepeat)return;r(C.cooldown??0),t==null||t.evt.addEventListener(N.type,p)}d(Math.max(K,0))},p=()=>{if(s()<=0)return t==null||t.evt.removeEventListener(N.type,p),y();r(s()-1)};return Le(()=>{t==null||t.evt.removeEventListener(N.type,p)}),g(R,{get when(){return!(t!=null&&t.pause())},get children(){var $=zn(),A=$.firstChild,C=A.firstChild,x=C.nextSibling;return x.nextSibling,_(A,o,x),_($,g(R,{get when(){return u()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var k=Gn();return _(k,()=>{var E;return(E=u())==null?void 0:E.label}),k})(),(()=>{var k=Ze();return _(k,g(St,{get ticks(){return n()},onFinish:y,label:"Attack",showPc:!0})),k})(),(()=>{var k=Ze();return _(k,g(We,{type:"red",get max(){return u().health},get value(){return a()},label:"Health",showNumber:!0})),k})()]}}),null),$}})};var Qn=m('<span class="text-red-800 font-bold m-1">'),Zn=m('<span class="font-bold m-1">'),el=m("<div class=text-red-800>"),tl=m("<div class=h-8>"),nl=m('<div class="flex flex-col gap-1 p-1 h-full"><div class=bg-black>');const ll=()=>{const e=F(W),t=F(Me),[n,l]=I(!1),[s,r]=I(0),[o,i]=I(0),a=L(()=>{const b=e==null?void 0:e.story().masteryType;if(b){const y=wt(b,e.player.mastery[b]??0);return Math.max(1,((e==null?void 0:e.story().duration)??100)-(y.durationModifier??0))}return(e==null?void 0:e.story().duration)??100});ve(()=>{const[b,y]=[e==null?void 0:e.player,e==null?void 0:e.story()];!b||!y||y.utilityType&&(b.equipment.find(p=>p.utilityType===y.utilityType)||e==null||e.onNavigate("_back"))}),ve(()=>{a()&&(t!=null&&t.pause()?(i(a()),t==null||t.evt.addEventListener(N.type,d)):t==null||t.evt.removeEventListener(N.type,d))});const d=()=>{o()<=0&&n()?u():i(o()-1)};ge(()=>{l(!0)});const u=()=>{var $,A;const[b,y]=[e==null?void 0:e.player,e==null?void 0:e.story()];if(!b||!y)return;if(!n()){i(a()),l(!0);return}l(!1),e==null||e.onLog(["You finished",(()=>{var C=Qn();return _(C,y.description),C})()],"good"),y.masteryType&&(e==null||e.onAddMastery(y.masteryType,y.experience??0));const p=($=y.getItems(void 0,y.masteryType,y.masteryType?b.mastery[y.masteryType]:void 0))==null?void 0:$.filter(C=>!(e!=null&&e.state.prohibitedItems.includes(C.name))).filter(C=>!!(e!=null&&e.addInventory(C)));if(p!=null&&p.length&&(e==null||e.onLog(["You gained:",(()=>{var C=Zn();return _(C,p==null?void 0:p.map(x=>x.label).join(", ")),C})()],"drop")),y.noRepeat)return((A=y.onComplete)==null?void 0:A.call(y))??(e==null?void 0:e.onNavigate("_back"));r(y.cooldown??0),t==null||t.evt.addEventListener(N.type,c)},c=()=>{if(s()<=0)return t==null||t.evt.removeEventListener(N.type,c),u();r(s()-1)};return Le(()=>{t==null||t.evt.removeEventListener(N.type,d),t==null||t.evt.removeEventListener(N.type,c)}),g(R,{get when(){return!(t!=null&&t.pause())},get children(){var b=nl(),y=b.firstChild;return _(y,()=>e==null?void 0:e.story().label),_(b,g(R,{get when(){return n()},fallback:"Waiting.. Searching.. Wondering..",get children(){return[(()=>{var p=el();return _(p,()=>e==null?void 0:e.story().description),p})(),(()=>{var p=tl();return _(p,g(St,{get ticks(){return a()},onFinish:u,label:"Task",showPc:!0})),p})()]}}),null),b}})};var rl=m('<div class="text-lg font-bold mt-5">Weapon'),sl=m('<div class="text-lg font-bold mt-5">Armour'),il=m('<div class="flex flex-col h-full"><div class="h-7/8 p-2"></div><div class="h-1/8 flex flex-row justify-between gap-2 p-2"><button>Equip</button><button>Stats'),ol=m('<div class="flex flex-row justify-between border-gray-700"><div></div><div>'),al=m('<div class="flex flex-row justify-between items-center border-gray-700"><div></div><div class="text-xs text-gray-500">');const cl=()=>{const[e,t]=I("stats"),n=F(W),l=L(()=>{const r=n==null?void 0:n.player.attackDamage(),o=1e3/Ne,i=1/(((n==null?void 0:n.player.attackRate())??se)/o);return[{label:"Health",value:(n==null?void 0:n.player.stats.health)??0},{label:"Max health",value:(n==null?void 0:n.player.stats.maxHealth)??0},{label:"",value:" "},{label:"Att. min",value:(r==null?void 0:r.at(0))??0},{label:"Att. max",value:(r==null?void 0:r.at(1))??0},{label:"Att. rate",value:`${(i==null?void 0:i.toFixed(2))??0} p/s`},{label:"",value:" "},{label:"Phys. res",value:(n==null?void 0:n.player.stats.physRes)??0},{label:"Mag. res",value:(n==null?void 0:n.player.stats.magRes)??0}]}),s=L(()=>{const r=["weapon","offhand"],o=["head","shoulder","chest","hand","leg","foot"];return[{label:rl(),isDisabled:!1,isEmpty:!0},...r.map(i=>{const a=i&&(n==null?void 0:n.player.equipment.find(d=>d.equipSlot===i));return{label:(a==null?void 0:a.label)??i,isDisabled:!a,subtext:Object.entries((a==null?void 0:a.stats)??{}).map(([d,u])=>`[${d}: ${u}]`).join(""),onClick:a?()=>n==null?void 0:n.onUnequip(a):void 0}}),{label:sl(),isDisabled:!1,isEmpty:!0},...o.map(i=>{const a=i&&(n==null?void 0:n.player.equipment.find(d=>d.equipSlot===i));return{label:(a==null?void 0:a.label)??i,isDisabled:!a,subtext:Object.entries((a==null?void 0:a.stats)??{}).map(([d,u])=>`[${d}: ${u}]`).join(""),onClick:a?()=>n==null?void 0:n.onUnequip(a):void 0}})]});return(()=>{var r=il(),o=r.firstChild,i=o.nextSibling,a=i.firstChild,d=a.nextSibling;return _(o,g(ye,{get children(){return[g(D,{get when(){return e()==="stats"},get children(){return g(J,{get each(){return l()},children:u=>(()=>{var c=ol(),b=c.firstChild,y=b.nextSibling;return _(b,()=>u.label),_(y,()=>u.value),U(()=>c.classList.toggle("border-b",!!u.label)),c})()})}}),g(D,{get when(){return e()==="equip"},get children(){return g(J,{get each(){return s()},children:u=>(()=>{var c=al(),b=c.firstChild,y=b.nextSibling;return Ve(c,"click",u.onClick),_(b,()=>u.label),_(y,()=>u.subtext),U(p=>{var $=!u.isEmpty,A=!!u.isDisabled;return $!==p.e&&c.classList.toggle("border-b",p.e=$),A!==p.t&&b.classList.toggle("text-gray-700",p.t=A),p},{e:void 0,t:void 0}),c})()})}})]}})),a.$$click=()=>t("equip"),d.$$click=()=>t("stats"),U(u=>{var c=e()==="equip",b=e()==="stats";return c!==u.e&&a.classList.toggle("selected",u.e=c),b!==u.t&&d.classList.toggle("selected",u.t=b),u},{e:void 0,t:void 0}),r})()};le(["click"]);var ul=m('<div class="absolute bottom-0 left-0 w-full border-t content-center p-2 bg-slate-500"><div class="flex flex-col gap-2"><div class="flex flex-row justify-center relative mb-3"><span class="absolute left-0 top-0 font-bold cursor-pointer border-2 rounded-xl px-2 hover:bg-white hover:text-black">X</span><div class=font-bold> (<!>)</div></div><div class="flex flex-col gap-1 justify-between"><div class="px-2 py-1 bg-blue-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Take</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All</button></div></div><div class="px-2 py-1 bg-red-300 w-full flex flex-col justify-between"><span class="font-bold text-sm text-black">Drop</span><div class="flex flex-row justify-between gap-2 w-full"><button>One</button><button>Stack</button><button>All'),fl=m('<div class="h-full relative pb-2"><div class="flex flex-col gap-2 h-7/8 overflow-auto p-2"></div><div class="w-full border content-center cursor-pointer h-12 text-lg font-bold mt-auto">Leave stash'),dl=m('<div class="border p-1 cursor-pointer flex flex-row justify-between"><div></div><div>(<!>)'),hl=m('<div class="border p-1 flex flex-row justify-between border-gray-700 text-gray-700">Empty');const gl=()=>{const e=F(W),[t,n]=I(),l=L(()=>((e==null?void 0:e.state.stash)??[]).map(a=>a?{...B[a.name],stack:a.stack}:null)),s=a=>{a<0||!(e!=null&&e.state.stash[a])||n(a)},r=L(()=>{const a=t()??-1;if(!(a<0))return l().at(a)}),o=a=>{const d=r();d&&(e==null||e.removeInventory(d,a),a>=(d.stack??1)&&n(void 0))},i=a=>{const d=r();if(!d)return;a=a===1/0?(e==null?void 0:e.state.stash.reduce((c,b)=>(b==null?void 0:b.name)===d.name?c+b.stack:c,0))??0:a;const u=e==null?void 0:e.addInventory(d,a);console.log({item:d,count:a,added:u}),e==null||e.removeStash(d,u)};return(()=>{var a=fl(),d=a.firstChild,u=d.nextSibling;return d.$$click=()=>n(void 0),_(d,g(J,{get each(){return l()},children:(c,b)=>g(bl,{item:c,onSelect:()=>s(b())})})),_(a,g(R,{get when(){return r()},get children(){var c=ul(),b=c.firstChild,y=b.firstChild,p=y.firstChild,$=p.nextSibling,A=$.firstChild,C=A.nextSibling;C.nextSibling;var x=y.nextSibling,k=x.firstChild,E=k.firstChild,q=E.nextSibling,V=q.firstChild,K=V.nextSibling,X=K.nextSibling,Q=k.nextSibling,O=Q.firstChild,f=O.nextSibling,v=f.firstChild,w=v.nextSibling,S=w.nextSibling;return p.$$click=()=>n(void 0),_($,()=>{var h;return(h=r())==null?void 0:h.label},A),_($,()=>{var h;return(h=r())==null?void 0:h.stack},C),V.$$click=()=>i(1),K.$$click=()=>{var h;return i(((h=r())==null?void 0:h.stack)??1)},X.$$click=()=>i(1/0),v.$$click=()=>o(1),w.$$click=()=>{var h;return o(((h=r())==null?void 0:h.stack)??1)},S.$$click=()=>o(1/0),c}}),u),u.$$click=()=>e==null?void 0:e.onNavigate("_back"),a})()},bl=e=>{const t=n=>{n.stopPropagation(),e.onSelect()};return g(R,{get when(){return e.item},get fallback(){return hl()},get children(){var n=dl(),l=n.firstChild,s=l.nextSibling,r=s.firstChild,o=r.nextSibling;return o.nextSibling,n.$$click=t,_(l,()=>{var i;return(i=e.item)==null?void 0:i.label}),_(s,()=>{var i;return(i=e.item)==null?void 0:i.stack},o),n}})};le(["click"]);var yl=m("<div>RESET");const pl=()=>{const e=F(W);return(()=>{var t=yl();return Ve(t,"click",e==null?void 0:e.onClearState),t})()};le(["click"]);var _l=m('<div class="w-dvw h-dvh lg:w-[360px] lg:h-[800px] flex flex-col justify-between"><div class="h-3/10 bg-gray-400"><div class=h-1/10></div><div class=h-9/10></div></div><div class=h-1/10></div><div class="h-5/10 bg-gray-800"></div> - '),ml=m("<div>Unknown view"),vl=m('<div class="h-1/10 w-full flex flex-row justify-between font-bold">'),wl=m('<div class="flex flex-col gap-2 p-1 h-full"><div class="bg-black text-left pl-1"></div><div class="text-black whitespace-pre-wrap text-left overflow-y-auto text-sm">'),$l=m('<div class="h-full bg-white flex flex-row"><div class="text-black bottom-0 left-0 border border-gray-100 p-1 flex flex-col gap-1 bg-white"><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide bad"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide good"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide meta"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide drop"></div><div class="rounded h-4 w-4 cursor-pointer"title="Show/hide basic"></div></div><div class="text-black h-full overflow-y-auto flex flex-col w-full">'),Sl=m('<div class="flex flex-row items-center px-1 transition-colors duration-500 border-t border-gray-200"><div class="text-xs text-blue-400 mr-1">[<!>]</div><div class="text-wrap text-xs text-left">'),kl=m('<div class="flex flex-row bg-black px-1 justify-between"><div class=text-red-500>HP <!>/</div><div class=text-yellow-500>Gold </div><div class=text-green-500>Lvl <!> (<!>%)'),xl=m('<div class="content-center w-1/4 border border-l-0 cursor-pointer last:border-r-0">');function Cl(){return g(kn,{get children(){return g(zt,{get children(){return g(Al,{})}})}})}const Al=()=>{const[e,t]=I("story"),n=F(W),l=L(()=>e()==="story"&&(n==null?void 0:n.story().name)==="story_stash_1"?"stash":e());return(()=>{var s=_l(),r=s.firstChild,o=r.firstChild,i=o.nextSibling,a=r.nextSibling,d=a.nextSibling,u=d.nextSibling;return _(o,g(Ml,{})),_(i,g(Ll,{})),_(a,g(Tl,{})),_(d,g(ye,{get fallback(){return ml()},get children(){return[g(D,{get when(){return l()==="story"},get children(){return g(Tn,{})}}),g(D,{get when(){return l()==="stash"},get children(){return g(gl,{})}}),g(D,{get when(){return l()==="invent"},get children(){return g(Dn,{})}}),g(D,{get when(){return l()==="skills"},get children(){return g(Un,{})}}),g(D,{get when(){return l()==="stats"},get children(){return g(cl,{})}}),g(D,{get when(){return l()==="menu"},get children(){return g(pl,{})}})]}})),_(s,g(El,{onChange:t,get view(){return e()}}),u),_(s,e,u),_(s,l,null),s})()},El=e=>(()=>{var t=vl();return _(t,g(ce,{label:"Story",onClick:()=>e.onChange("story"),get view(){return e.view},type:"story"}),null),_(t,g(ce,{label:"Invent",onClick:()=>e.onChange("invent"),get view(){return e.view},type:"invent"}),null),_(t,g(ce,{label:"Skills",onClick:()=>e.onChange("skills"),get view(){return e.view},type:"skills"}),null),_(t,g(ce,{label:"Stats",onClick:()=>e.onChange("stats"),get view(){return e.view},type:"stats"}),null),_(t,g(ce,{label:"Menu",onClick:()=>e.onChange("menu"),get view(){return e.view},type:"menu"}),null),t})(),Ll=()=>{const e=F(W);return g(ye,{get children(){return[g(D,{get when(){return(e==null?void 0:e.story().type)==="dialogue"},get children(){var t=wl(),n=t.firstChild,l=n.nextSibling;return _(n,()=>(e==null?void 0:e.story().label)??"Story"),_(l,()=>e==null?void 0:e.story().description),t}}),g(D,{get when(){return(e==null?void 0:e.story().type)==="encounter"},get children(){return g(Jn,{})}}),g(D,{get when(){return(e==null?void 0:e.story().type)==="task"},get children(){return g(ll,{})}})]}})},Tl=()=>{const[e,t]=I(),{log:n}=F(W)??{},[l,s]=De({good:!0,bad:!0,meta:!0,drop:!0,basic:!0}),r=L(()=>{const o=e();if(!o)return;const i=o.scrollTop+o.clientHeight>o.scrollHeight-10;return setTimeout(()=>i&&o.scrollTo(0,o.scrollHeight??0)),n==null?void 0:n().filter(a=>l[a.type])});return(()=>{var o=$l(),i=o.firstChild,a=i.firstChild,d=a.nextSibling,u=d.nextSibling,c=u.nextSibling,b=c.nextSibling,y=i.nextSibling;return a.$$click=()=>s("bad",!l.bad),d.$$click=()=>s("good",!l.good),u.$$click=()=>s("meta",!l.meta),c.$$click=()=>s("drop",!l.drop),b.$$click=()=>s("basic",!l.basic),Nt(t,y),_(y,g(J,{get each(){return r()},children:p=>(()=>{var $=Sl(),A=$.firstChild,C=A.firstChild,x=C.nextSibling;x.nextSibling;var k=A.nextSibling;return _(A,()=>p.time,x),_(k,()=>p.msg),U(E=>ft($,{"last:bg-red-500 last:text-white bg-red-200":p.type==="bad","last:bg-green-500 last:text-white bg-green-200":p.type==="good","last:bg-yellow-500 bg-yellow-200":p.type==="meta","last:bg-blue-500 last:text-white bg-blue-200":p.type==="drop"},E)),$})()})),U(p=>{var $=!l.bad,A=!!l.bad,C=!l.good,x=!!l.good,k=!l.meta,E=!!l.meta,q=!l.drop,V=!!l.drop,K=!l.basic,X=!!l.basic;return $!==p.e&&a.classList.toggle("bg-red-100",p.e=$),A!==p.t&&a.classList.toggle("bg-red-500",p.t=A),C!==p.a&&d.classList.toggle("bg-green-100",p.a=C),x!==p.o&&d.classList.toggle("bg-green-500",p.o=x),k!==p.i&&u.classList.toggle("bg-yellow-100",p.i=k),E!==p.n&&u.classList.toggle("bg-yellow-500",p.n=E),q!==p.s&&c.classList.toggle("bg-blue-100",p.s=q),V!==p.h&&c.classList.toggle("bg-blue-500",p.h=V),K!==p.r&&b.classList.toggle("bg-gray-100",p.r=K),X!==p.d&&b.classList.toggle("bg-gray-500",p.d=X),p},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),o})()},Ml=()=>{const e=F(W);return(()=>{var t=kl(),n=t.firstChild,l=n.firstChild,s=l.nextSibling;s.nextSibling;var r=n.nextSibling;r.firstChild;var o=r.nextSibling,i=o.firstChild,a=i.nextSibling,d=a.nextSibling,u=d.nextSibling;return u.nextSibling,_(n,()=>e==null?void 0:e.player.stats.health,s),_(n,()=>e==null?void 0:e.player.stats.maxHealth,null),_(r,()=>e==null?void 0:e.player.stats.gold,null),_(o,()=>Te((e==null?void 0:e.player.stats.experience)??0),a),_(o,()=>(vt((e==null?void 0:e.player.stats.experience)??0)*100).toFixed(0),u),t})()},ce=e=>(()=>{var t=xl();return Ve(t,"click",e.onClick),_(t,()=>e.label),U(n=>ft(t,{"border-t-0 bg-gray-800":e.view===e.type},n)),t})();le(["click"]);const Il=document.getElementById("root");Rt(()=>g(Cl,{}),Il);
